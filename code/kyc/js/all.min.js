"use strict";!function(a){"undefined"==typeof a.fn.each2&&a.extend(a.fn,{each2:function(b){for(var c=a([0]),d=-1,e=this.length;++d<e&&(c.context=c[0]=this[d])&&b.call(c[0],d,c)!==!1;);return this}})}(jQuery),function(a,b){function c(b){var c=a(document.createTextNode(""));b.before(c),c.before(b),c.remove()}function d(a){function b(a){return O[a]||a}return a.replace(/[^\u0000-\u007E]/g,b)}function e(a,b){for(var c=0,d=b.length;d>c;c+=1)if(g(a,b[c]))return c;return-1}function f(){var b=a(N);b.appendTo("body");var c={width:b.width()-b[0].clientWidth,height:b.height()-b[0].clientHeight};return b.remove(),c}function g(a,c){return a===c?!0:a===b||c===b?!1:null===a||null===c?!1:a.constructor===String?a+""==c+"":c.constructor===String?c+""==a+"":!1}function h(b,c){var d,e,f;if(null===b||b.length<1)return[];for(d=b.split(c),e=0,f=d.length;f>e;e+=1)d[e]=a.trim(d[e]);return d}function i(a){return a.outerWidth(!1)-a.width()}function j(c){var d="keyup-change-value";c.on("keydown",function(){a.data(c,d)===b&&a.data(c,d,c.val())}),c.on("keyup",function(){var e=a.data(c,d);e!==b&&c.val()!==e&&(a.removeData(c,d),c.trigger("keyup-change"))})}function k(c){c.on("mousemove",function(c){var d=M;(d===b||d.x!==c.pageX||d.y!==c.pageY)&&a(c.target).trigger("mousemove-filtered",c)})}function l(a,c,d){d=d||b;var e;return function(){var b=arguments;window.clearTimeout(e),e=window.setTimeout(function(){c.apply(d,b)},a)}}function m(a,b){var c=l(a,function(a){b.trigger("scroll-debounced",a)});b.on("scroll",function(a){e(a.target,b.get())>=0&&c(a)})}function n(a){a[0]!==document.activeElement&&window.setTimeout(function(){var b,c=a[0],d=a.val().length;a.focus();var e=c.offsetWidth>0||c.offsetHeight>0;e&&c===document.activeElement&&(c.setSelectionRange?c.setSelectionRange(d,d):c.createTextRange&&(b=c.createTextRange(),b.collapse(!1),b.select()))},0)}function o(b){b=a(b)[0];var c=0,d=0;if("selectionStart"in b)c=b.selectionStart,d=b.selectionEnd-c;else if("selection"in document){b.focus();var e=document.selection.createRange();d=document.selection.createRange().text.length,e.moveStart("character",-b.value.length),c=e.text.length-d}return{offset:c,length:d}}function p(a){a.preventDefault(),a.stopPropagation()}function q(a){a.preventDefault(),a.stopImmediatePropagation()}function r(b){if(!J){var c=b[0].currentStyle||window.getComputedStyle(b[0],null);J=a(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:c.fontSize,fontFamily:c.fontFamily,fontStyle:c.fontStyle,fontWeight:c.fontWeight,letterSpacing:c.letterSpacing,textTransform:c.textTransform,whiteSpace:"nowrap"}),J.attr("class","select2-sizer"),a("body").append(J)}return J.text(b.val()),J.width()}function s(b,c,d){var e,f,g=[];e=a.trim(b.attr("class")),e&&(e=""+e,a(e.split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&g.push(this)})),e=a.trim(c.attr("class")),e&&(e=""+e,a(e.split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(f=d(this),f&&g.push(f))})),b.attr("class",g.join(" "))}function t(a,b,c,e){var f=d(a.toUpperCase()).indexOf(d(b.toUpperCase())),g=b.length;return 0>f?void c.push(e(a)):(c.push(e(a.substring(0,f))),c.push("<span class='select2-match'>"),c.push(e(a.substring(f,f+g))),c.push("</span>"),void c.push(e(a.substring(f+g,a.length))))}function u(a){var b={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(a).replace(/[&<>"'\/\\]/g,function(a){return b[a]})}function v(c){var d,e=null,f=c.quietMillis||100,g=c.url,h=this;return function(i){window.clearTimeout(d),d=window.setTimeout(function(){var d=c.data,f=g,j=c.transport||a.fn.select2.ajaxDefaults.transport,k={type:c.type||"GET",cache:c.cache||!1,jsonpCallback:c.jsonpCallback||b,dataType:c.dataType||"json"},l=a.extend({},a.fn.select2.ajaxDefaults.params,k);d=d?d.call(h,i.term,i.page,i.context):null,f="function"==typeof f?f.call(h,i.term,i.page,i.context):f,e&&"function"==typeof e.abort&&e.abort(),c.params&&(a.isFunction(c.params)?a.extend(l,c.params.call(h)):a.extend(l,c.params)),a.extend(l,{url:f,dataType:c.dataType,data:d,success:function(a){var b=c.results(a,i.page,i);i.callback(b)},error:function(a,b,c){var d={hasError:!0,jqXHR:a,textStatus:b,errorThrown:c};i.callback(d)}}),e=j.call(h,l)},f)}}function w(b){var c,d,e=b,f=function(a){return""+a.text};a.isArray(e)&&(d=e,e={results:d}),a.isFunction(e)===!1&&(d=e,e=function(){return d});var g=e();return g.text&&(f=g.text,a.isFunction(f)||(c=g.text,f=function(a){return a[c]})),function(b){var c,d=b.term,g={results:[]};return""===d?void b.callback(e()):(c=function(e,g){var h,i;if(e=e[0],e.children){h={};for(i in e)e.hasOwnProperty(i)&&(h[i]=e[i]);h.children=[],a(e.children).each2(function(a,b){c(b,h.children)}),(h.children.length||b.matcher(d,f(h),e))&&g.push(h)}else b.matcher(d,f(e),e)&&g.push(e)},a(e().results).each2(function(a,b){c(b,g.results)}),void b.callback(g))}}function x(c){var d=a.isFunction(c);return function(e){var f=e.term,g={results:[]},h=d?c(e):c;a.isArray(h)&&(a(h).each(function(){var a=this.text!==b,c=a?this.text:this;(""===f||e.matcher(f,c))&&g.results.push(a?this:{id:this,text:this})}),e.callback(g))}}function y(b,c){if(a.isFunction(b))return!0;if(!b)return!1;if("string"==typeof b)return!0;throw new Error(c+" must be a string, function, or falsy value")}function z(b,c){if(a.isFunction(b)){var d=Array.prototype.slice.call(arguments,2);return b.apply(c,d)}return b}function A(b){var c=0;return a.each(b,function(a,b){b.children?c+=A(b.children):c++}),c}function B(a,c,d,e){var f,h,i,j,k,l=a,m=!1;if(!e.createSearchChoice||!e.tokenSeparators||e.tokenSeparators.length<1)return b;for(;;){for(h=-1,i=0,j=e.tokenSeparators.length;j>i&&(k=e.tokenSeparators[i],h=a.indexOf(k),!(h>=0));i++);if(0>h)break;if(f=a.substring(0,h),a=a.substring(h+k.length),f.length>0&&(f=e.createSearchChoice.call(this,f,c),f!==b&&null!==f&&e.id(f)!==b&&null!==e.id(f))){for(m=!1,i=0,j=c.length;j>i;i++)if(g(e.id(f),e.id(c[i]))){m=!0;break}m||d(f)}}return l!==a?a:void 0}function C(){var b=this;a.each(arguments,function(a,c){b[c].remove(),b[c]=null})}function D(b,c){var d=function(){};return d.prototype=new b,d.prototype.constructor=d,d.prototype.parent=b.prototype,d.prototype=a.extend(d.prototype,c),d}if(window.Select2===b){var E,F,G,H,I,J,K,L,M={x:0,y:0},E={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(a){switch(a=a.which?a.which:a){case E.LEFT:case E.RIGHT:case E.UP:case E.DOWN:return!0}return!1},isControl:function(a){var b=a.which;switch(b){case E.SHIFT:case E.CTRL:case E.ALT:return!0}return a.metaKey?!0:!1},isFunctionKey:function(a){return a=a.which?a.which:a,a>=112&&123>=a}},N="<div class='select2-measure-scrollbar'></div>",O={"Ⓐ":"A",Ａ:"A",À:"A",Á:"A",Â:"A",Ầ:"A",Ấ:"A",Ẫ:"A",Ẩ:"A",Ã:"A",Ā:"A",Ă:"A",Ằ:"A",Ắ:"A",Ẵ:"A",Ẳ:"A",Ȧ:"A",Ǡ:"A",Ä:"A",Ǟ:"A",Ả:"A",Å:"A",Ǻ:"A",Ǎ:"A",Ȁ:"A",Ȃ:"A",Ạ:"A",Ậ:"A",Ặ:"A",Ḁ:"A",Ą:"A",Ⱥ:"A",Ɐ:"A",Ꜳ:"AA",Æ:"AE",Ǽ:"AE",Ǣ:"AE",Ꜵ:"AO",Ꜷ:"AU",Ꜹ:"AV",Ꜻ:"AV",Ꜽ:"AY","Ⓑ":"B",Ｂ:"B",Ḃ:"B",Ḅ:"B",Ḇ:"B",Ƀ:"B",Ƃ:"B",Ɓ:"B","Ⓒ":"C",Ｃ:"C",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",Ç:"C",Ḉ:"C",Ƈ:"C",Ȼ:"C",Ꜿ:"C","Ⓓ":"D",Ｄ:"D",Ḋ:"D",Ď:"D",Ḍ:"D",Ḑ:"D",Ḓ:"D",Ḏ:"D",Đ:"D",Ƌ:"D",Ɗ:"D",Ɖ:"D",Ꝺ:"D",Ǳ:"DZ",Ǆ:"DZ",ǲ:"Dz",ǅ:"Dz","Ⓔ":"E",Ｅ:"E",È:"E",É:"E",Ê:"E",Ề:"E",Ế:"E",Ễ:"E",Ể:"E",Ẽ:"E",Ē:"E",Ḕ:"E",Ḗ:"E",Ĕ:"E",Ė:"E",Ë:"E",Ẻ:"E",Ě:"E",Ȅ:"E",Ȇ:"E",Ẹ:"E",Ệ:"E",Ȩ:"E",Ḝ:"E",Ę:"E",Ḙ:"E",Ḛ:"E",Ɛ:"E",Ǝ:"E","Ⓕ":"F",Ｆ:"F",Ḟ:"F",Ƒ:"F",Ꝼ:"F","Ⓖ":"G",Ｇ:"G",Ǵ:"G",Ĝ:"G",Ḡ:"G",Ğ:"G",Ġ:"G",Ǧ:"G",Ģ:"G",Ǥ:"G",Ɠ:"G","Ꞡ":"G",Ᵹ:"G",Ꝿ:"G","Ⓗ":"H",Ｈ:"H",Ĥ:"H",Ḣ:"H",Ḧ:"H",Ȟ:"H",Ḥ:"H",Ḩ:"H",Ḫ:"H",Ħ:"H",Ⱨ:"H",Ⱶ:"H","Ɥ":"H","Ⓘ":"I",Ｉ:"I",Ì:"I",Í:"I",Î:"I",Ĩ:"I",Ī:"I",Ĭ:"I",İ:"I",Ï:"I",Ḯ:"I",Ỉ:"I",Ǐ:"I",Ȉ:"I",Ȋ:"I",Ị:"I",Į:"I",Ḭ:"I",Ɨ:"I","Ⓙ":"J",Ｊ:"J",Ĵ:"J",Ɉ:"J","Ⓚ":"K",Ｋ:"K",Ḱ:"K",Ǩ:"K",Ḳ:"K",Ķ:"K",Ḵ:"K",Ƙ:"K",Ⱪ:"K",Ꝁ:"K",Ꝃ:"K",Ꝅ:"K","Ꞣ":"K","Ⓛ":"L",Ｌ:"L",Ŀ:"L",Ĺ:"L",Ľ:"L",Ḷ:"L",Ḹ:"L",Ļ:"L",Ḽ:"L",Ḻ:"L",Ł:"L",Ƚ:"L",Ɫ:"L",Ⱡ:"L",Ꝉ:"L",Ꝇ:"L",Ꞁ:"L",Ǉ:"LJ",ǈ:"Lj","Ⓜ":"M",Ｍ:"M",Ḿ:"M",Ṁ:"M",Ṃ:"M",Ɱ:"M",Ɯ:"M","Ⓝ":"N",Ｎ:"N",Ǹ:"N",Ń:"N",Ñ:"N",Ṅ:"N",Ň:"N",Ṇ:"N",Ņ:"N",Ṋ:"N",Ṉ:"N",Ƞ:"N",Ɲ:"N","Ꞑ":"N","Ꞥ":"N",Ǌ:"NJ",ǋ:"Nj","Ⓞ":"O",Ｏ:"O",Ò:"O",Ó:"O",Ô:"O",Ồ:"O",Ố:"O",Ỗ:"O",Ổ:"O",Õ:"O",Ṍ:"O",Ȭ:"O",Ṏ:"O",Ō:"O",Ṑ:"O",Ṓ:"O",Ŏ:"O",Ȯ:"O",Ȱ:"O",Ö:"O",Ȫ:"O",Ỏ:"O",Ő:"O",Ǒ:"O",Ȍ:"O",Ȏ:"O",Ơ:"O",Ờ:"O",Ớ:"O",Ỡ:"O",Ở:"O",Ợ:"O",Ọ:"O",Ộ:"O",Ǫ:"O",Ǭ:"O",Ø:"O",Ǿ:"O",Ɔ:"O",Ɵ:"O",Ꝋ:"O",Ꝍ:"O",Ƣ:"OI",Ꝏ:"OO",Ȣ:"OU","Ⓟ":"P",Ｐ:"P",Ṕ:"P",Ṗ:"P",Ƥ:"P",Ᵽ:"P",Ꝑ:"P",Ꝓ:"P",Ꝕ:"P","Ⓠ":"Q",Ｑ:"Q",Ꝗ:"Q",Ꝙ:"Q",Ɋ:"Q","Ⓡ":"R",Ｒ:"R",Ŕ:"R",Ṙ:"R",Ř:"R",Ȑ:"R",Ȓ:"R",Ṛ:"R",Ṝ:"R",Ŗ:"R",Ṟ:"R",Ɍ:"R",Ɽ:"R",Ꝛ:"R","Ꞧ":"R",Ꞃ:"R","Ⓢ":"S",Ｓ:"S",ẞ:"S",Ś:"S",Ṥ:"S",Ŝ:"S",Ṡ:"S",Š:"S",Ṧ:"S",Ṣ:"S",Ṩ:"S",Ș:"S",Ş:"S","Ȿ":"S","Ꞩ":"S",Ꞅ:"S","Ⓣ":"T",Ｔ:"T",Ṫ:"T",Ť:"T",Ṭ:"T",Ț:"T",Ţ:"T",Ṱ:"T",Ṯ:"T",Ŧ:"T",Ƭ:"T",Ʈ:"T",Ⱦ:"T",Ꞇ:"T",Ꜩ:"TZ","Ⓤ":"U",Ｕ:"U",Ù:"U",Ú:"U",Û:"U",Ũ:"U",Ṹ:"U",Ū:"U",Ṻ:"U",Ŭ:"U",Ü:"U",Ǜ:"U",Ǘ:"U",Ǖ:"U",Ǚ:"U",Ủ:"U",Ů:"U",Ű:"U",Ǔ:"U",Ȕ:"U",Ȗ:"U",Ư:"U",Ừ:"U",Ứ:"U",Ữ:"U",Ử:"U",Ự:"U",Ụ:"U",Ṳ:"U",Ų:"U",Ṷ:"U",Ṵ:"U",Ʉ:"U","Ⓥ":"V",Ｖ:"V",Ṽ:"V",Ṿ:"V",Ʋ:"V",Ꝟ:"V",Ʌ:"V",Ꝡ:"VY","Ⓦ":"W",Ｗ:"W",Ẁ:"W",Ẃ:"W",Ŵ:"W",Ẇ:"W",Ẅ:"W",Ẉ:"W",Ⱳ:"W","Ⓧ":"X",Ｘ:"X",Ẋ:"X",Ẍ:"X","Ⓨ":"Y",Ｙ:"Y",Ỳ:"Y",Ý:"Y",Ŷ:"Y",Ỹ:"Y",Ȳ:"Y",Ẏ:"Y",Ÿ:"Y",Ỷ:"Y",Ỵ:"Y",Ƴ:"Y",Ɏ:"Y",Ỿ:"Y","Ⓩ":"Z",Ｚ:"Z",Ź:"Z",Ẑ:"Z",Ż:"Z",Ž:"Z",Ẓ:"Z",Ẕ:"Z",Ƶ:"Z",Ȥ:"Z","Ɀ":"Z",Ⱬ:"Z",Ꝣ:"Z","ⓐ":"a",ａ:"a",ẚ:"a",à:"a",á:"a",â:"a",ầ:"a",ấ:"a",ẫ:"a",ẩ:"a",ã:"a",ā:"a",ă:"a",ằ:"a",ắ:"a",ẵ:"a",ẳ:"a",ȧ:"a",ǡ:"a",ä:"a",ǟ:"a",ả:"a",å:"a",ǻ:"a",ǎ:"a",ȁ:"a",ȃ:"a",ạ:"a",ậ:"a",ặ:"a",ḁ:"a",ą:"a",ⱥ:"a",ɐ:"a",ꜳ:"aa",æ:"ae",ǽ:"ae",ǣ:"ae",ꜵ:"ao",ꜷ:"au",ꜹ:"av",ꜻ:"av",ꜽ:"ay","ⓑ":"b",ｂ:"b",ḃ:"b",ḅ:"b",ḇ:"b",ƀ:"b",ƃ:"b",ɓ:"b","ⓒ":"c",ｃ:"c",ć:"c",ĉ:"c",ċ:"c",č:"c",ç:"c",ḉ:"c",ƈ:"c",ȼ:"c",ꜿ:"c",ↄ:"c","ⓓ":"d",ｄ:"d",ḋ:"d",ď:"d",ḍ:"d",ḑ:"d",ḓ:"d",ḏ:"d",đ:"d",ƌ:"d",ɖ:"d",ɗ:"d",ꝺ:"d",ǳ:"dz",ǆ:"dz","ⓔ":"e",ｅ:"e",è:"e",é:"e",ê:"e",ề:"e",ế:"e",ễ:"e",ể:"e",ẽ:"e",ē:"e",ḕ:"e",ḗ:"e",ĕ:"e",ė:"e",ë:"e",ẻ:"e",ě:"e",ȅ:"e",ȇ:"e",ẹ:"e",ệ:"e",ȩ:"e",ḝ:"e",ę:"e",ḙ:"e",ḛ:"e",ɇ:"e",ɛ:"e",ǝ:"e","ⓕ":"f",ｆ:"f",ḟ:"f",ƒ:"f",ꝼ:"f","ⓖ":"g",ｇ:"g",ǵ:"g",ĝ:"g",ḡ:"g",ğ:"g",ġ:"g",ǧ:"g",ģ:"g",ǥ:"g",ɠ:"g","ꞡ":"g",ᵹ:"g",ꝿ:"g","ⓗ":"h",ｈ:"h",ĥ:"h",ḣ:"h",ḧ:"h",ȟ:"h",ḥ:"h",ḩ:"h",ḫ:"h",ẖ:"h",ħ:"h",ⱨ:"h",ⱶ:"h",ɥ:"h",ƕ:"hv","ⓘ":"i",ｉ:"i",ì:"i",í:"i",î:"i",ĩ:"i",ī:"i",ĭ:"i",ï:"i",ḯ:"i",ỉ:"i",ǐ:"i",ȉ:"i",ȋ:"i",ị:"i",į:"i",ḭ:"i",ɨ:"i",ı:"i","ⓙ":"j",ｊ:"j",ĵ:"j",ǰ:"j",ɉ:"j","ⓚ":"k",ｋ:"k",ḱ:"k",ǩ:"k",ḳ:"k",ķ:"k",ḵ:"k",ƙ:"k",ⱪ:"k",ꝁ:"k",ꝃ:"k",ꝅ:"k","ꞣ":"k","ⓛ":"l",ｌ:"l",ŀ:"l",ĺ:"l",ľ:"l",ḷ:"l",ḹ:"l",ļ:"l",ḽ:"l",ḻ:"l",ſ:"l",ł:"l",ƚ:"l",ɫ:"l",ⱡ:"l",ꝉ:"l",ꞁ:"l",ꝇ:"l",ǉ:"lj","ⓜ":"m",ｍ:"m",ḿ:"m",ṁ:"m",ṃ:"m",ɱ:"m",ɯ:"m","ⓝ":"n",ｎ:"n",ǹ:"n",ń:"n",ñ:"n",ṅ:"n",ň:"n",ṇ:"n",ņ:"n",ṋ:"n",ṉ:"n",ƞ:"n",ɲ:"n",ŉ:"n","ꞑ":"n","ꞥ":"n",ǌ:"nj","ⓞ":"o",ｏ:"o",ò:"o",ó:"o",ô:"o",ồ:"o",ố:"o",ỗ:"o",ổ:"o",õ:"o",ṍ:"o",ȭ:"o",ṏ:"o",ō:"o",ṑ:"o",ṓ:"o",ŏ:"o",ȯ:"o",ȱ:"o",ö:"o",ȫ:"o",ỏ:"o",ő:"o",ǒ:"o",ȍ:"o",ȏ:"o",ơ:"o",ờ:"o",ớ:"o",ỡ:"o",ở:"o",ợ:"o",ọ:"o",ộ:"o",ǫ:"o",ǭ:"o",ø:"o",ǿ:"o",ɔ:"o",ꝋ:"o",ꝍ:"o",ɵ:"o",ƣ:"oi",ȣ:"ou",ꝏ:"oo","ⓟ":"p",ｐ:"p",ṕ:"p",ṗ:"p",ƥ:"p",ᵽ:"p",ꝑ:"p",ꝓ:"p",ꝕ:"p","ⓠ":"q",ｑ:"q",ɋ:"q",ꝗ:"q",ꝙ:"q","ⓡ":"r",ｒ:"r",ŕ:"r",ṙ:"r",ř:"r",ȑ:"r",ȓ:"r",ṛ:"r",ṝ:"r",ŗ:"r",ṟ:"r",ɍ:"r",ɽ:"r",ꝛ:"r","ꞧ":"r",ꞃ:"r","ⓢ":"s",ｓ:"s",ß:"s",ś:"s",ṥ:"s",ŝ:"s",ṡ:"s",š:"s",ṧ:"s",ṣ:"s",ṩ:"s",ș:"s",ş:"s",ȿ:"s","ꞩ":"s",ꞅ:"s",ẛ:"s","ⓣ":"t",ｔ:"t",ṫ:"t",ẗ:"t",ť:"t",ṭ:"t",ț:"t",ţ:"t",ṱ:"t",ṯ:"t",ŧ:"t",ƭ:"t",ʈ:"t",ⱦ:"t",ꞇ:"t",ꜩ:"tz","ⓤ":"u",ｕ:"u",ù:"u",ú:"u",û:"u",ũ:"u",ṹ:"u",ū:"u",ṻ:"u",ŭ:"u",ü:"u",ǜ:"u",ǘ:"u",ǖ:"u",ǚ:"u",ủ:"u",ů:"u",ű:"u",ǔ:"u",ȕ:"u",ȗ:"u",ư:"u",ừ:"u",ứ:"u",ữ:"u",ử:"u",ự:"u",ụ:"u",ṳ:"u",ų:"u",ṷ:"u",ṵ:"u",ʉ:"u","ⓥ":"v",ｖ:"v",ṽ:"v",ṿ:"v",ʋ:"v",ꝟ:"v",ʌ:"v",ꝡ:"vy","ⓦ":"w",ｗ:"w",ẁ:"w",ẃ:"w",ŵ:"w",ẇ:"w",ẅ:"w",ẘ:"w",ẉ:"w",ⱳ:"w","ⓧ":"x",ｘ:"x",ẋ:"x",ẍ:"x","ⓨ":"y",ｙ:"y",ỳ:"y",ý:"y",ŷ:"y",ỹ:"y",ȳ:"y",ẏ:"y",ÿ:"y",ỷ:"y",ẙ:"y",ỵ:"y",ƴ:"y",ɏ:"y",ỿ:"y","ⓩ":"z",ｚ:"z",ź:"z",ẑ:"z",ż:"z",ž:"z",ẓ:"z",ẕ:"z",ƶ:"z",ȥ:"z",ɀ:"z",ⱬ:"z",ꝣ:"z",Ά:"Α",Έ:"Ε",Ή:"Η",Ί:"Ι",Ϊ:"Ι",Ό:"Ο",Ύ:"Υ",Ϋ:"Υ",Ώ:"Ω",ά:"α",έ:"ε",ή:"η",ί:"ι",ϊ:"ι",ΐ:"ι",ό:"ο",ύ:"υ",ϋ:"υ",ΰ:"υ",ω:"ω",ς:"σ"};K=a(document),I=function(){var a=1;return function(){return a++}}(),F=D(Object,{bind:function(a){var b=this;return function(){a.apply(b,arguments)}},init:function(c){var d,e,g=".select2-results";this.opts=c=this.prepareOpts(c),this.id=c.id,c.element.data("select2")!==b&&null!==c.element.data("select2")&&c.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=a("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body),this.containerId="s2id_"+(c.element.attr("id")||"autogen"+I()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",c.element.attr("title")),this.body=a("body"),s(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",c.element.attr("style")),this.container.css(z(c.containerCss,this.opts.element)),this.container.addClass(z(c.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",p),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),s(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(z(c.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",p),this.results=d=this.container.find(g),this.search=e=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",p),k(this.results),this.dropdown.on("mousemove-filtered",g,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",g,this.bind(function(a){this._touchEvent=!0,this.highlightUnderEvent(a)})),this.dropdown.on("touchmove",g,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",g,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),m(80,this.results),this.dropdown.on("scroll-debounced",g,this.bind(this.loadMoreIfNeeded)),a(this.container).on("change",".select2-input",function(a){a.stopPropagation()}),a(this.dropdown).on("change",".select2-input",function(a){a.stopPropagation()}),a.fn.mousewheel&&d.mousewheel(function(a,b,c,e){var f=d.scrollTop();e>0&&0>=f-e?(d.scrollTop(0),p(a)):0>e&&d.get(0).scrollHeight-d.scrollTop()+e<=d.height()&&(d.scrollTop(d.get(0).scrollHeight-d.height()),p(a))}),j(e),e.on("keyup-change input paste",this.bind(this.updateResults)),e.on("focus",function(){e.addClass("select2-focused")}),e.on("blur",function(){e.removeClass("select2-focused")}),this.dropdown.on("mouseup",g,this.bind(function(b){a(b.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(b),this.selectHighlighted(b))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(a){a.stopPropagation()}),this.nextSearchTerm=b,a.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==c.maximumInputLength&&this.search.attr("maxlength",c.maximumInputLength);var h=c.element.prop("disabled");h===b&&(h=!1),this.enable(!h);var i=c.element.prop("readonly");i===b&&(i=!1),this.readonly(i),L=L||f(),this.autofocus=c.element.prop("autofocus"),c.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",c.searchInputPlaceholder)},destroy:function(){var a=this.opts.element,c=a.data("select2"),d=this;this.close(),a.length&&a[0].detachEvent&&a.each(function(){this.detachEvent("onpropertychange",d._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,c!==b&&(c.container.remove(),c.liveRegion.remove(),c.dropdown.remove(),a.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?a.attr({tabindex:this.elementTabIndex}):a.removeAttr("tabindex"),a.show()),C.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(a){return a.is("option")?{id:a.prop("value"),text:a.text(),element:a.get(),css:a.attr("class"),disabled:a.prop("disabled"),locked:g(a.attr("locked"),"locked")||g(a.data("locked"),!0)}:a.is("optgroup")?{text:a.attr("label"),children:[],element:a.get(),css:a.attr("class")}:void 0},prepareOpts:function(c){var d,e,f,i,j=this;if(d=c.element,"select"===d.get(0).tagName.toLowerCase()&&(this.select=e=c.element),e&&a.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in c)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),c=a.extend({},{populateResults:function(d,e,f){var g,h=this.opts.id,i=this.liveRegion;(g=function(d,e,k){var l,m,n,o,p,q,r,s,t,u;d=c.sortResults(d,e,f);var v=[];for(l=0,m=d.length;m>l;l+=1)n=d[l],p=n.disabled===!0,o=!p&&h(n)!==b,q=n.children&&n.children.length>0,r=a("<li></li>"),r.addClass("select2-results-dept-"+k),r.addClass("select2-result"),r.addClass(o?"select2-result-selectable":"select2-result-unselectable"),p&&r.addClass("select2-disabled"),q&&r.addClass("select2-result-with-children"),r.addClass(j.opts.formatResultCssClass(n)),r.attr("role","presentation"),s=a(document.createElement("div")),s.addClass("select2-result-label"),s.attr("id","select2-result-label-"+I()),s.attr("role","option"),u=c.formatResult(n,s,f,j.opts.escapeMarkup),u!==b&&(s.html(u),r.append(s)),q&&(t=a("<ul></ul>"),t.addClass("select2-result-sub"),g(n.children,t,k+1),r.append(t)),r.data("select2-data",n),v.push(r[0]);e.append(v),i.text(c.formatMatches(d.length))})(e,d,0)}},a.fn.select2.defaults,c),"function"!=typeof c.id&&(f=c.id,c.id=function(a){return a[f]}),a.isArray(c.element.data("select2Tags"))){if("tags"in c)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+c.element.attr("id");c.tags=c.element.data("select2Tags")}if(e?(c.query=this.bind(function(a){var c,e,f,g={results:[],more:!1},h=a.term;f=function(b,c){var d;b.is("option")?a.matcher(h,b.text(),b)&&c.push(j.optionToData(b)):b.is("optgroup")&&(d=j.optionToData(b),b.children().each2(function(a,b){f(b,d.children)}),d.children.length>0&&c.push(d))},c=d.children(),this.getPlaceholder()!==b&&c.length>0&&(e=this.getPlaceholderOption(),e&&(c=c.not(e))),c.each2(function(a,b){f(b,g.results)}),a.callback(g)}),c.id=function(a){return a.id}):"query"in c||("ajax"in c?(i=c.element.data("ajax-url"),i&&i.length>0&&(c.ajax.url=i),c.query=v.call(c.element,c.ajax)):"data"in c?c.query=w(c.data):"tags"in c&&(c.query=x(c.tags),c.createSearchChoice===b&&(c.createSearchChoice=function(b){return{id:a.trim(b),text:a.trim(b)}}),c.initSelection===b&&(c.initSelection=function(b,d){var e=[];a(h(b.val(),c.separator)).each(function(){var b={id:this,text:this},d=c.tags;a.isFunction(d)&&(d=d()),a(d).each(function(){return g(this.id,b.id)?(b=this,!1):void 0}),e.push(b)}),d(e)}))),"function"!=typeof c.query)throw"query function not defined for Select2 "+c.element.attr("id");if("top"===c.createSearchChoicePosition)c.createSearchChoicePosition=function(a,b){a.unshift(b)};else if("bottom"===c.createSearchChoicePosition)c.createSearchChoicePosition=function(a,b){a.push(b)};else if("function"!=typeof c.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return c},monitorSource:function(){var c,d=this.opts.element,e=this;d.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),this._sync=this.bind(function(){var a=d.prop("disabled");a===b&&(a=!1),this.enable(!a);var c=d.prop("readonly");c===b&&(c=!1),this.readonly(c),s(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(z(this.opts.containerCssClass,this.opts.element)),s(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(z(this.opts.dropdownCssClass,this.opts.element))}),d.length&&d[0].attachEvent&&d.each(function(){this.attachEvent("onpropertychange",e._sync)}),c=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,c!==b&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new c(function(b){a.each(b,e._sync)}),this.propertyObserver.observe(d.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(b){var c=a.Event("select2-selecting",{val:this.id(b),object:b,choice:b});return this.opts.element.trigger(c),!c.isDefaultPrevented()},triggerChange:function(b){b=b||{},b=a.extend({},b,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(b),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var a=this._enabled&&!this._readonly,b=!a;return a===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",b),this.close(),this.enabledInterface=a,!0)},enable:function(a){a===b&&(a=!0),this._enabled!==a&&(this._enabled=a,this.opts.element.prop("disabled",!a),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(a){a===b&&(a=!1),this._readonly!==a&&(this._readonly=a,this.opts.element.prop("readonly",a),this.enableInterface())},opened:function(){return this.container?this.container.hasClass("select2-dropdown-open"):!1},positionDropdown:function(){var b,c,d,e,f,g=this.dropdown,h=this.container.offset(),i=this.container.outerHeight(!1),j=this.container.outerWidth(!1),k=g.outerHeight(!1),l=a(window),m=l.width(),n=l.height(),o=l.scrollLeft()+m,p=l.scrollTop()+n,q=h.top+i,r=h.left,s=p>=q+k,t=h.top-k>=l.scrollTop(),u=g.outerWidth(!1),v=o>=r+u,w=g.hasClass("select2-drop-above");w?(c=!0,!t&&s&&(d=!0,c=!1)):(c=!1,!s&&t&&(d=!0,c=!0)),d&&(g.hide(),h=this.container.offset(),i=this.container.outerHeight(!1),j=this.container.outerWidth(!1),k=g.outerHeight(!1),o=l.scrollLeft()+m,p=l.scrollTop()+n,q=h.top+i,r=h.left,u=g.outerWidth(!1),v=o>=r+u,g.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(f=a(".select2-results",g)[0],g.addClass("select2-drop-auto-width"),g.css("width",""),u=g.outerWidth(!1)+(f.scrollHeight===f.clientHeight?0:L.width),u>j?j=u:u=j,k=g.outerHeight(!1),v=o>=r+u):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(b=this.body.offset(),q-=b.top,r-=b.left),v||(r=h.left+this.container.outerWidth(!1)-u),e={left:r,width:j},c?(e.top=h.top-k,e.bottom="auto",this.container.addClass("select2-drop-above"),g.addClass("select2-drop-above")):(e.top=q,e.bottom="auto",this.container.removeClass("select2-drop-above"),g.removeClass("select2-drop-above")),e=a.extend(e,z(this.opts.dropdownCss,this.opts.element)),g.css(e)},shouldOpen:function(){var b;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(b=a.Event("select2-opening"),this.opts.element.trigger(b),!b.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),K.on("mousemove.select2Event",function(a){M.x=a.pageX,M.y=a.pageY}),!0):!1},opening:function(){var b,d=this.containerEventName,e="scroll."+d,f="resize."+d,g="orientationchange."+d;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),b=a("#select2-drop-mask"),0==b.length&&(b=a(document.createElement("div")),b.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),b.hide(),b.appendTo(this.body),b.on("mousedown touchstart click",function(d){c(b);var e,f=a("#select2-drop");f.length>0&&(e=f.data("select2"),e.opts.selectOnBlur&&e.selectHighlighted({noFocus:!0}),e.close(),d.preventDefault(),d.stopPropagation())})),this.dropdown.prev()[0]!==b[0]&&this.dropdown.before(b),a("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),b.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var h=this;this.container.parents().add(window).each(function(){a(this).on(f+" "+e+" "+g,function(){h.opened()&&h.positionDropdown()})})},close:function(){if(this.opened()){var b=this.containerEventName,c="scroll."+b,d="resize."+b,e="orientationchange."+b;this.container.parents().add(window).each(function(){a(this).off(c).off(d).off(e)}),this.clearDropdownAlignmentPreference(),a("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),K.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(a.Event("select2-close"))}},externalSearch:function(a){this.open(),this.search.val(a),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return z(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var b,c,d,e,f,g,h,i,j=this.results;if(c=this.highlight(),!(0>c)){if(0==c)return void j.scrollTop(0);b=this.findHighlightableChoices().find(".select2-result-label"),d=a(b[c]),i=(d.offset()||{}).top||0,e=i+d.outerHeight(!0),c===b.length-1&&(h=j.find("li.select2-more-results"),h.length>0&&(e=h.offset().top+h.outerHeight(!0))),f=j.offset().top+j.outerHeight(!0),e>f&&j.scrollTop(j.scrollTop()+(e-f)),g=i-j.offset().top,0>g&&"none"!=d.css("display")&&j.scrollTop(j.scrollTop()+g)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(b){for(var c=this.findHighlightableChoices(),d=this.highlight();d>-1&&d<c.length;){d+=b;var e=a(c[d]);if(e.hasClass("select2-result-selectable")&&!e.hasClass("select2-disabled")&&!e.hasClass("select2-selected")){this.highlight(d);break}}},highlight:function(b){var c,d,f=this.findHighlightableChoices();return 0===arguments.length?e(f.filter(".select2-highlighted")[0],f.get()):(b>=f.length&&(b=f.length-1),0>b&&(b=0),this.removeHighlight(),c=a(f[b]),c.addClass("select2-highlighted"),this.search.attr("aria-activedescendant",c.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(c.text()),d=c.data("select2-data"),void(d&&this.opts.element.trigger({type:"select2-highlight",val:this.id(d),choice:d})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(b){var c=a(b.target).closest(".select2-result-selectable");if(c.length>0&&!c.is(".select2-highlighted")){var d=this.findHighlightableChoices();this.highlight(d.index(c))}else 0==c.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var a,b=this.results,c=b.find("li.select2-more-results"),d=this.resultsPage+1,e=this,f=this.search.val(),g=this.context;0!==c.length&&(a=c.offset().top-b.offset().top-b.height(),a<=this.opts.loadMorePadding&&(c.addClass("select2-active"),this.opts.query({element:this.opts.element,term:f,page:d,context:g,matcher:this.opts.matcher,callback:this.bind(function(a){e.opened()&&(e.opts.populateResults.call(this,b,a.results,{term:f,page:d,context:g}),e.postprocessResults(a,!1,!1),a.more===!0?(c.detach().appendTo(b).text(z(e.opts.formatLoadMore,e.opts.element,d+1)),window.setTimeout(function(){e.loadMoreIfNeeded()},10)):c.remove(),e.positionDropdown(),e.resultsPage=d,e.context=a.context,this.opts.element.trigger({type:"select2-loaded",items:a}))})})))},tokenize:function(){},updateResults:function(c){function d(){j.removeClass("select2-active"),m.positionDropdown(),m.liveRegion.text(k.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?k.text():m.opts.formatMatches(k.find(".select2-result-selectable").length))}function e(a){k.html(a),d()}var f,h,i,j=this.search,k=this.results,l=this.opts,m=this,n=j.val(),o=a.data(this.container,"select2-last-term");if((c===!0||!o||!g(n,o))&&(a.data(this.container,"select2-last-term",n),c===!0||this.showSearchInput!==!1&&this.opened())){i=++this.queryCount;var p=this.getMaximumSelectionSize();if(p>=1&&(f=this.data(),a.isArray(f)&&f.length>=p&&y(l.formatSelectionTooBig,"formatSelectionTooBig")))return void e("<li class='select2-selection-limit'>"+z(l.formatSelectionTooBig,l.element,p)+"</li>");if(j.val().length<l.minimumInputLength)return e(y(l.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+z(l.formatInputTooShort,l.element,j.val(),l.minimumInputLength)+"</li>":""),void(c&&this.showSearch&&this.showSearch(!0));if(l.maximumInputLength&&j.val().length>l.maximumInputLength)return void e(y(l.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+z(l.formatInputTooLong,l.element,j.val(),l.maximumInputLength)+"</li>":"");l.formatSearching&&0===this.findHighlightableChoices().length&&e("<li class='select2-searching'>"+z(l.formatSearching,l.element)+"</li>"),j.addClass("select2-active"),this.removeHighlight(),h=this.tokenize(),h!=b&&null!=h&&j.val(h),this.resultsPage=1,l.query({element:l.element,term:j.val(),page:this.resultsPage,context:null,matcher:l.matcher,callback:this.bind(function(f){var h;if(i==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(f.hasError!==b&&y(l.formatAjaxError,"formatAjaxError"))return void e("<li class='select2-ajax-error'>"+z(l.formatAjaxError,l.element,f.jqXHR,f.textStatus,f.errorThrown)+"</li>");if(this.context=f.context===b?null:f.context,this.opts.createSearchChoice&&""!==j.val()&&(h=this.opts.createSearchChoice.call(m,j.val(),f.results),h!==b&&null!==h&&m.id(h)!==b&&null!==m.id(h)&&0===a(f.results).filter(function(){return g(m.id(this),m.id(h))}).length&&this.opts.createSearchChoicePosition(f.results,h)),0===f.results.length&&y(l.formatNoMatches,"formatNoMatches"))return void e("<li class='select2-no-results'>"+z(l.formatNoMatches,l.element,j.val())+"</li>");k.empty(),m.opts.populateResults.call(this,k,f.results,{term:j.val(),page:this.resultsPage,context:null}),f.more===!0&&y(l.formatLoadMore,"formatLoadMore")&&(k.append("<li class='select2-more-results'>"+l.escapeMarkup(z(l.formatLoadMore,l.element,this.resultsPage))+"</li>"),window.setTimeout(function(){m.loadMoreIfNeeded()},10)),this.postprocessResults(f,c),d(),this.opts.element.trigger({type:"select2-loaded",items:f})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){n(this.search)},selectHighlighted:function(a){if(this._touchMoved)return void this.clearTouchMoved();var b=this.highlight(),c=this.results.find(".select2-highlighted"),d=c.closest(".select2-result").data("select2-data");d?(this.highlight(b),this.onSelect(d,a)):a&&a.noFocus&&this.close()},getPlaceholder:function(){var a;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((a=this.getPlaceholderOption())!==b?a.text():b)},getPlaceholderOption:function(){if(this.select){var c=this.select.children("option").first();if(this.opts.placeholderOption!==b)return"first"===this.opts.placeholderOption&&c||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);
if(""===a.trim(c.text())&&""===c.val())return c}},initContainerWidth:function(){function c(){var c,d,e,f,g,h;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(c=this.opts.element.attr("style"),c!==b)for(d=c.split(";"),f=0,g=d.length;g>f;f+=1)if(h=d[f].replace(/\s/g,""),e=h.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==e&&e.length>=1)return e[1];return"resolve"===this.opts.width?(c=this.opts.element.css("width"),c.indexOf("%")>0?c:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return a.isFunction(this.opts.width)?this.opts.width():this.opts.width}var d=c.call(this);null!==d&&this.container.css("width",d)}}),G=D(F,{createContainer:function(){var b=a(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return b},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var c,d,e;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),c=this.search.get(0),c.createTextRange?(d=c.createTextRange(),d.collapse(!1),d.select()):c.setSelectionRange&&(e=this.search.val().length,c.setSelectionRange(e,e))),""===this.search.val()&&this.nextSearchTerm!=b&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(a.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){a("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),C.call(this,"selection","focusser")},initContainer:function(){var b,d,e=this.container,f=this.dropdown,g=I();this.showSearch(this.opts.minimumResultsForSearch<0?!1:!0),this.selection=b=e.find(".select2-choice"),this.focusser=e.find(".select2-focusser"),b.find(".select2-chosen").attr("id","select2-chosen-"+g),this.focusser.attr("aria-labelledby","select2-chosen-"+g),this.results.attr("id","select2-results-"+g),this.search.attr("aria-owns","select2-results-"+g),this.focusser.attr("id","s2id_autogen"+g),d=a("label[for='"+this.opts.element.attr("id")+"']"),this.focusser.prev().text(d.text()).attr("for",this.focusser.attr("id"));var h=this.opts.element.attr("title");this.opts.element.attr("title",h||d.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(a("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(a){if(this.isInterfaceEnabled()&&229!=a.keyCode){if(a.which===E.PAGE_UP||a.which===E.PAGE_DOWN)return void p(a);switch(a.which){case E.UP:case E.DOWN:return this.moveHighlight(a.which===E.UP?-1:1),void p(a);case E.ENTER:return this.selectHighlighted(),void p(a);case E.TAB:return void this.selectHighlighted({noFocus:!0});case E.ESC:return this.cancel(a),void p(a)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(a){if(this.isInterfaceEnabled()&&a.which!==E.TAB&&!E.isControl(a)&&!E.isFunctionKey(a)&&a.which!==E.ESC){if(this.opts.openOnEnter===!1&&a.which===E.ENTER)return void p(a);if(a.which==E.DOWN||a.which==E.UP||a.which==E.ENTER&&this.opts.openOnEnter){if(a.altKey||a.ctrlKey||a.shiftKey||a.metaKey)return;return this.open(),void p(a)}return a.which==E.DELETE||a.which==E.BACKSPACE?(this.opts.allowClear&&this.clear(),void p(a)):void 0}})),j(this.focusser),this.focusser.on("keyup-change input",this.bind(function(a){if(this.opts.minimumResultsForSearch>=0){if(a.stopPropagation(),this.opened())return;this.open()}})),b.on("mousedown touchstart","abbr",this.bind(function(a){this.isInterfaceEnabled()&&(this.clear(),q(a),this.close(),this.selection.focus())})),b.on("mousedown touchstart",this.bind(function(d){c(b),this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),p(d)})),f.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),b.on("focus",this.bind(function(a){p(a)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(a.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(b){var c=this.selection.data("select2-data");if(c){var d=a.Event("select2-clearing");if(this.opts.element.trigger(d),d.isDefaultPrevented())return;var e=this.getPlaceholderOption();this.opts.element.val(e?e.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),b!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(c),choice:c}),this.triggerChange({removed:c}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var a=this;this.opts.initSelection.call(null,this.opts.element,function(c){c!==b&&null!==c&&(a.updateSelection(c),a.close(),a.setPlaceholder(),a.nextSearchTerm=a.opts.nextSearchTerm(c,a.search.val()))})}},isPlaceholderOptionSelected:function(){var a;return this.getPlaceholder()===b?!1:(a=this.getPlaceholderOption())!==b&&a.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===b||null===this.opts.element.val()},prepareOpts:function(){var b=this.parent.prepareOpts.apply(this,arguments),c=this;return"select"===b.element.get(0).tagName.toLowerCase()?b.initSelection=function(a,b){var d=a.find("option").filter(function(){return this.selected&&!this.disabled});b(c.optionToData(d))}:"data"in b&&(b.initSelection=b.initSelection||function(c,d){var e=c.val(),f=null;b.query({matcher:function(a,c,d){var h=g(e,b.id(d));return h&&(f=d),h},callback:a.isFunction(d)?function(){d(f)}:a.noop})}),b},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===b?b:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var a=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&a!==b){if(this.select&&this.getPlaceholderOption()===b)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(a)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(a,b,c){var d=0,e=this;if(this.findHighlightableChoices().each2(function(a,b){return g(e.id(b.data("select2-data")),e.opts.element.val())?(d=a,!1):void 0}),c!==!1&&this.highlight(b===!0&&d>=0?d:0),b===!0){var f=this.opts.minimumResultsForSearch;f>=0&&this.showSearch(A(a.results)>=f)}},showSearch:function(b){this.showSearchInput!==b&&(this.showSearchInput=b,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!b),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!b),a(this.dropdown,this.container).toggleClass("select2-with-searchbox",b))},onSelect:function(a,b){if(this.triggerSelect(a)){var c=this.opts.element.val(),d=this.data();this.opts.element.val(this.id(a)),this.updateSelection(a),this.opts.element.trigger({type:"select2-selected",val:this.id(a),choice:a}),this.nextSearchTerm=this.opts.nextSearchTerm(a,this.search.val()),this.close(),b&&b.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),g(c,this.id(a))||this.triggerChange({added:a,removed:d})}},updateSelection:function(a){var c,d,e=this.selection.find(".select2-chosen");this.selection.data("select2-data",a),e.empty(),null!==a&&(c=this.opts.formatSelection(a,e,this.opts.escapeMarkup)),c!==b&&e.append(c),d=this.opts.formatSelectionCssClass(a,e),d!==b&&e.addClass(d),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==b&&this.container.addClass("select2-allowclear")},val:function(){var a,c=!1,d=null,e=this,f=this.data();if(0===arguments.length)return this.opts.element.val();if(a=arguments[0],arguments.length>1&&(c=arguments[1]),this.select)this.select.val(a).find("option").filter(function(){return this.selected}).each2(function(a,b){return d=e.optionToData(b),!1}),this.updateSelection(d),this.setPlaceholder(),c&&this.triggerChange({added:d,removed:f});else{if(!a&&0!==a)return void this.clear(c);if(this.opts.initSelection===b)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(a),this.opts.initSelection(this.opts.element,function(a){e.opts.element.val(a?e.id(a):""),e.updateSelection(a),e.setPlaceholder(),c&&e.triggerChange({added:a,removed:f})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(a){var c,d=!1;return 0===arguments.length?(c=this.selection.data("select2-data"),c==b&&(c=null),c):(arguments.length>1&&(d=arguments[1]),void(a?(c=this.data(),this.opts.element.val(a?this.id(a):""),this.updateSelection(a),d&&this.triggerChange({added:a,removed:c})):this.clear(d)))}}),H=D(F,{createContainer:function(){var b=a(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return b},prepareOpts:function(){var b=this.parent.prepareOpts.apply(this,arguments),c=this;return"select"===b.element.get(0).tagName.toLowerCase()?b.initSelection=function(a,b){var d=[];a.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(a,b){d.push(c.optionToData(b))}),b(d)}:"data"in b&&(b.initSelection=b.initSelection||function(c,d){var e=h(c.val(),b.separator),f=[];b.query({matcher:function(c,d,h){var i=a.grep(e,function(a){return g(a,b.id(h))}).length;return i&&f.push(h),i},callback:a.isFunction(d)?function(){for(var a=[],c=0;c<e.length;c++)for(var h=e[c],i=0;i<f.length;i++){var j=f[i];if(g(h,b.id(j))){a.push(j),f.splice(i,1);break}}d(a)}:a.noop})}),b},selectChoice:function(a){var b=this.container.find(".select2-search-choice-focus");b.length&&a&&a[0]==b[0]||(b.length&&this.opts.element.trigger("choice-deselected",b),b.removeClass("select2-search-choice-focus"),a&&a.length&&(this.close(),a.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",a)))},destroy:function(){a("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),C.call(this,"searchContainer","selection")},initContainer:function(){var b,c=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=b=this.container.find(c);var d=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(){d.search[0].focus(),d.selectChoice(a(this))}),this.search.attr("id","s2id_autogen"+I()),this.search.prev().text(a("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(a){if(this.isInterfaceEnabled()){++this.keydowns;var c=b.find(".select2-search-choice-focus"),d=c.prev(".select2-search-choice:not(.select2-locked)"),e=c.next(".select2-search-choice:not(.select2-locked)"),f=o(this.search);if(c.length&&(a.which==E.LEFT||a.which==E.RIGHT||a.which==E.BACKSPACE||a.which==E.DELETE||a.which==E.ENTER)){var g=c;return a.which==E.LEFT&&d.length?g=d:a.which==E.RIGHT?g=e.length?e:null:a.which===E.BACKSPACE?this.unselect(c.first())&&(this.search.width(10),g=d.length?d:e):a.which==E.DELETE?this.unselect(c.first())&&(this.search.width(10),g=e.length?e:null):a.which==E.ENTER&&(g=null),this.selectChoice(g),p(a),void(g&&g.length||this.open())}if((a.which===E.BACKSPACE&&1==this.keydowns||a.which==E.LEFT)&&0==f.offset&&!f.length)return this.selectChoice(b.find(".select2-search-choice:not(.select2-locked)").last()),void p(a);if(this.selectChoice(null),this.opened())switch(a.which){case E.UP:case E.DOWN:return this.moveHighlight(a.which===E.UP?-1:1),void p(a);case E.ENTER:return this.selectHighlighted(),void p(a);case E.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case E.ESC:return this.cancel(a),void p(a)}if(a.which!==E.TAB&&!E.isControl(a)&&!E.isFunctionKey(a)&&a.which!==E.BACKSPACE&&a.which!==E.ESC){if(a.which===E.ENTER){if(this.opts.openOnEnter===!1)return;if(a.altKey||a.ctrlKey||a.shiftKey||a.metaKey)return}this.open(),(a.which===E.PAGE_UP||a.which===E.PAGE_DOWN)&&p(a),a.which===E.ENTER&&p(a)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(b){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),b.stopImmediatePropagation(),this.opts.element.trigger(a.Event("select2-blur"))})),this.container.on("click",c,this.bind(function(b){this.isInterfaceEnabled()&&(a(b.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.open(),this.focusSearch(),b.preventDefault()))})),this.container.on("focus",c,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var a=this;this.opts.initSelection.call(null,this.opts.element,function(c){c!==b&&null!==c&&(a.updateSelection(c),a.close(),a.clearSearch())})}},clearSearch:function(){var a=this.getPlaceholder(),c=this.getMaxSearchWidth();a!==b&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(a).addClass("select2-default"),this.search.width(c>0?c:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),""===this.search.val()&&this.nextSearchTerm!=b&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(a.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(b){var c=[],d=[],f=this;a(b).each(function(){e(f.id(this),c)<0&&(c.push(f.id(this)),d.push(this))}),b=d,this.selection.find(".select2-search-choice").remove(),a(b).each(function(){f.addSelectedChoice(this)}),f.postprocessResults()},tokenize:function(){var a=this.search.val();a=this.opts.tokenizer.call(this,a,this.data(),this.bind(this.onSelect),this.opts),null!=a&&a!=b&&(this.search.val(a),a.length>0&&this.open())},onSelect:function(a,c){this.triggerSelect(a)&&""!==a.text&&(this.addSelectedChoice(a),this.opts.element.trigger({type:"selected",val:this.id(a),choice:a}),this.nextSearchTerm=this.opts.nextSearchTerm(a,this.search.val()),this.clearSearch(),this.updateResults(),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(a,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.nextSearchTerm!=b&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:a}),c&&c.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(c){var d,e,f=!c.locked,g=a("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),h=a("<li class='select2-search-choice select2-locked'><div></div></li>"),i=f?g:h,j=this.id(c),k=this.getVal();d=this.opts.formatSelection(c,i.find("div"),this.opts.escapeMarkup),d!=b&&i.find("div").replaceWith("<div>"+d+"</div>"),e=this.opts.formatSelectionCssClass(c,i.find("div")),e!=b&&i.addClass(e),f&&i.find(".select2-search-choice-close").on("mousedown",p).on("click dblclick",this.bind(function(b){this.isInterfaceEnabled()&&(this.unselect(a(b.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),p(b),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),i.data("select2-data",c),i.insertBefore(this.searchContainer),k.push(j),this.setVal(k)},unselect:function(b){var c,d,f=this.getVal();if(b=b.closest(".select2-search-choice"),0===b.length)throw"Invalid argument: "+b+". Must be .select2-search-choice";if(c=b.data("select2-data")){var g=a.Event("select2-removing");if(g.val=this.id(c),g.choice=c,this.opts.element.trigger(g),g.isDefaultPrevented())return!1;for(;(d=e(this.id(c),f))>=0;)f.splice(d,1),this.setVal(f),this.select&&this.postprocessResults();return b.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(c),choice:c}),this.triggerChange({removed:c}),!0}},postprocessResults:function(a,b,c){var d=this.getVal(),f=this.results.find(".select2-result"),g=this.results.find(".select2-result-with-children"),h=this;f.each2(function(a,b){var c=h.id(b.data("select2-data"));e(c,d)>=0&&(b.addClass("select2-selected"),b.find(".select2-result-selectable").addClass("select2-selected"))}),g.each2(function(a,b){b.is(".select2-result-selectable")||0!==b.find(".select2-result-selectable:not(.select2-selected)").length||b.addClass("select2-selected")}),-1==this.highlight()&&c!==!1&&h.highlight(0),!this.opts.createSearchChoice&&!f.filter(".select2-result:not(.select2-selected)").length>0&&(!a||a&&!a.more&&0===this.results.find(".select2-no-results").length)&&y(h.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+z(h.opts.formatNoMatches,h.opts.element,h.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-i(this.search)},resizeSearch:function(){var a,b,c,d,e,f=i(this.search);a=r(this.search)+10,b=this.search.offset().left,c=this.selection.width(),d=this.selection.offset().left,e=c-(b-d)-f,a>e&&(e=c-f),40>e&&(e=c-f),0>=e&&(e=a),this.search.width(Math.floor(e))},getVal:function(){var a;return this.select?(a=this.select.val(),null===a?[]:a):(a=this.opts.element.val(),h(a,this.opts.separator))},setVal:function(b){var c;this.select?this.select.val(b):(c=[],a(b).each(function(){e(this,c)<0&&c.push(this)}),this.opts.element.val(0===c.length?"":c.join(this.opts.separator)))},buildChangeDetails:function(a,b){for(var b=b.slice(0),a=a.slice(0),c=0;c<b.length;c++)for(var d=0;d<a.length;d++)g(this.opts.id(b[c]),this.opts.id(a[d]))&&(b.splice(c,1),c>0&&c--,a.splice(d,1),d--);return{added:b,removed:a}},val:function(c,d){var e,f=this;if(0===arguments.length)return this.getVal();if(e=this.data(),e.length||(e=[]),!c&&0!==c)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(d&&this.triggerChange({added:this.data(),removed:e}));if(this.setVal(c),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),d&&this.triggerChange(this.buildChangeDetails(e,this.data()));else{if(this.opts.initSelection===b)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(b){var c=a.map(b,f.id);f.setVal(c),f.updateSelection(b),f.clearSearch(),d&&f.triggerChange(f.buildChangeDetails(e,f.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var b=[],c=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){b.push(c.opts.id(a(this).data("select2-data")))}),this.setVal(b),this.triggerChange()},data:function(b,c){var d,e,f=this;return 0===arguments.length?this.selection.children(".select2-search-choice").map(function(){return a(this).data("select2-data")}).get():(e=this.data(),b||(b=[]),d=a.map(b,function(a){return f.opts.id(a)}),this.setVal(d),this.updateSelection(b),this.clearSearch(),c&&this.triggerChange(this.buildChangeDetails(e,this.data())),void 0)}}),a.fn.select2=function(){var c,d,f,g,h,i=Array.prototype.slice.call(arguments,0),j=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],k=["opened","isFocused","container","dropdown"],l=["val","data"],m={search:"externalSearch"};return this.each(function(){if(0===i.length||"object"==typeof i[0])c=0===i.length?{}:a.extend({},i[0]),c.element=a(this),"select"===c.element.get(0).tagName.toLowerCase()?h=c.element.prop("multiple"):(h=c.multiple||!1,"tags"in c&&(c.multiple=h=!0)),d=h?new window.Select2["class"].multi:new window.Select2["class"].single,d.init(c);else{if("string"!=typeof i[0])throw"Invalid arguments to select2 plugin: "+i;if(e(i[0],j)<0)throw"Unknown method: "+i[0];if(g=b,d=a(this).data("select2"),d===b)return;if(f=i[0],"container"===f?g=d.container:"dropdown"===f?g=d.dropdown:(m[f]&&(f=m[f]),g=d[f].apply(d,i.slice(1))),e(i[0],k)>=0||e(i[0],l)>=0&&1==i.length)return!1}}),g===b?this:g},a.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(a,b,c,d){var e=[];return t(a.text,c.term,e,d),e.join("")},formatSelection:function(a,c,d){return a?d(a.text):b},sortResults:function(a){return a},formatResultCssClass:function(a){return a.css},formatSelectionCssClass:function(){return b},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(a){return a==b?null:a.id},matcher:function(a,b){return d(""+b).toUpperCase().indexOf(d(""+a).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:B,escapeMarkup:u,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(a){return a},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return b},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(a){var b="ontouchstart"in window||navigator.msMaxTouchPoints>0;return b&&a.opts.minimumResultsForSearch<0?!1:!0}},a.fn.select2.locales=[],a.fn.select2.locales.en={formatMatches:function(a){return 1===a?"One result is available, press enter to select it.":a+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(){return"Loading failed"},formatInputTooShort:function(a,b){var c=b-a.length;return"Please enter "+c+" or more character"+(1==c?"":"s")},formatInputTooLong:function(a,b){var c=a.length-b;return"Please delete "+c+" character"+(1==c?"":"s")},formatSelectionTooBig:function(a){return"You can only select "+a+" item"+(1==a?"":"s")},formatLoadMore:function(){return"Loading more results…"},formatSearching:function(){return"Searching…"}},a.extend(a.fn.select2.defaults,a.fn.select2.locales.en),a.fn.select2.ajaxDefaults={transport:a.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:v,local:w,tags:x},util:{debounce:l,markMatch:t,escapeMarkup:u,stripDiacritics:d},"class":{"abstract":F,single:G,multi:H}}}}(jQuery),angular.module("ui.select2",[]).value("uiSelect2Config",{}).directive("uiSelect2",["uiSelect2Config","$timeout",function(a,b){var c={};return a&&angular.extend(c,a),{require:"ngModel",priority:1,compile:function(a,d){var e,f,g,h=a.is("select"),i=angular.isDefined(d.multiple);return a.is("select")&&(f=a.find("option[ng-repeat], option[data-ng-repeat]"),f.length&&(g=f.attr("ng-repeat")||f.attr("data-ng-repeat"),e=jQuery.trim(g.split("|")[0]).split(" ").pop())),function(a,f,g,j){var k=angular.extend({},c,a.$eval(g.uiSelect2)),l=function(a){var b;return k.simple_tags?(b=[],angular.forEach(a,function(a){b.push(a.id)})):b=a,b},m=function(a){var b=[];return a?(k.simple_tags?(b=[],angular.forEach(a,function(a){b.push({id:a,text:a})})):b=a,b):b};if(h?(delete k.multiple,delete k.initSelection):i&&(k.multiple=!0),j&&(a.$watch(d.ngModel,function(a,b){a&&a!==b&&j.$render()},!0),j.$render=function(){if(h)f.select2("val",j.$viewValue);else if(k.multiple){var a=j.$viewValue;angular.isString(a)&&(a=a.split(",")),f.select2("data",m(a))}else angular.isObject(j.$viewValue)?f.select2("data",j.$viewValue):j.$viewValue?f.select2("val",j.$viewValue):f.select2("data",null)},e&&a.$watch(e,function(a,c){angular.equals(a,c)||b(function(){f.select2("val",j.$viewValue),f.trigger("change"),a&&!c&&j.$setPristine&&j.$setPristine(!0)})}),j.$parsers.push(function(a){var b=f.prev();return b.toggleClass("ng-invalid",!j.$valid).toggleClass("ng-valid",j.$valid).toggleClass("ng-invalid-required",!j.$valid).toggleClass("ng-valid-required",j.$valid).toggleClass("ng-dirty",j.$dirty).toggleClass("ng-pristine",j.$pristine),a}),!h&&(f.bind("change",function(b){b.stopImmediatePropagation(),a.$$phase||a.$root.$$phase||a.$apply(function(){j.$setViewValue(l(f.select2("data")))})}),k.initSelection))){var n=k.initSelection;k.initSelection=function(a,b){n(a,function(a){j.$setViewValue(l(a)),b(a)})}}f.bind("$destroy",function(){f.select2("destroy")}),g.$observe("disabled",function(a){f.select2("enable",!a)}),g.$observe("readonly",function(a){f.select2("readonly",!!a)}),g.ngMultiple&&a.$watch(g.ngMultiple,function(a){g.$set("multiple",!!a),f.select2(k)}),b(function(){f.select2(k),f.val(j.$viewValue),j.$render(),k.initSelection||h||j.$setViewValue(l(f.select2("data")))})}}}}]),function(a,b){var c=6,d=4,e="asc",f="desc",g="_ng_field_",h="_ng_depth_",i="_ng_hidden_",j="_ng_column_",k=/CUSTOM_FILTERS/g,l=/COL_FIELD/g,m=/DISPLAY_CELL_TEMPLATE/g,n=/EDITABLE_CELL_TEMPLATE/g,o=/CELL_EDITABLE_CONDITION/g,p=/<.+>/;a.ngGrid={},a.ngGrid.i18n={},angular.module("ngGrid.services",[]);var q=angular.module("ngGrid.directives",[]),r=angular.module("ngGrid.filters",[]);angular.module("ngGrid",["ngGrid.services","ngGrid.directives","ngGrid.filters"]);var s=function(a,b,d,e){if(void 0===a.selectionProvider.selectedItems)return!0;var f,g=d.which||d.keyCode,h=!1,i=!1,j=void 0===a.selectionProvider.lastClickedRow?1:a.selectionProvider.lastClickedRow.rowIndex,k=a.columns.filter(function(a){return a.visible&&a.width>0}),l=a.columns.filter(function(a){return a.pinned});if(a.col&&(f=k.indexOf(a.col)),37!==g&&38!==g&&39!==g&&40!==g&&(e.config.noTabInterference||9!==g)&&13!==g)return!0;if(a.enableCellSelection){9===g&&d.preventDefault();var m=a.showSelectionCheckbox?1===f:0===f,n=1===f||0===f,o=f===k.length-1||f===k.length-2,p=k.indexOf(a.col)===k.length-1,q=l.indexOf(a.col)===l.length-1;if(37===g||9===g&&d.shiftKey){var r=0;m||(f-=1),n?m&&9===g&&d.shiftKey?(r=e.$canvas.width(),f=k.length-1,i=!0):r=e.$viewport.scrollLeft()-a.col.width:l.length>0&&(r=e.$viewport.scrollLeft()-k[f].width),e.$viewport.scrollLeft(r)}else(39===g||9===g&&!d.shiftKey)&&(o?p&&9===g&&!d.shiftKey?(e.$viewport.scrollLeft(0),f=a.showSelectionCheckbox?1:0,h=!0):e.$viewport.scrollLeft(e.$viewport.scrollLeft()+a.col.width):q&&e.$viewport.scrollLeft(0),p||(f+=1))}var s;s=a.configGroups.length>0?e.rowFactory.parsedData.filter(function(a){return!a.isAggRow}):e.filteredRows;var t=0;if(0!==j&&(38===g||13===g&&d.shiftKey||9===g&&d.shiftKey&&i)?t=-1:j!==s.length-1&&(40===g||13===g&&!d.shiftKey||9===g&&h)&&(t=1),t){var u=s[j+t];u.beforeSelectionChange(u,d)&&(u.continueSelection(d),a.$emit("ngGridEventDigestGridParent"),a.selectionProvider.lastClickedRow.renderedRowIndex>=a.renderedRows.length-c-2?e.$viewport.scrollTop(e.$viewport.scrollTop()+a.rowHeight):c+2>=a.selectionProvider.lastClickedRow.renderedRowIndex&&e.$viewport.scrollTop(e.$viewport.scrollTop()-a.rowHeight))}return a.enableCellSelection&&setTimeout(function(){a.domAccessProvider.focusCellElement(a,a.renderedColumns.indexOf(k[f]))},3),!1};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1}),Array.prototype.filter||(Array.prototype.filter=function(a){var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;
for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),r.filter("checkmark",function(){return function(a){return a?"✔":"✘"}}),r.filter("ngColumns",function(){return function(a){return a.filter(function(a){return!a.isAggCol})}}),angular.module("ngGrid.services").factory("$domUtilityService",["$utilityService","$window",function(a,c){var d={},e={},f=function(){var a=b("<div></div>");a.appendTo("body"),a.height(100).width(100).css("position","absolute").css("overflow","scroll"),a.append('<div style="height: 400px; width: 400px;"></div>'),d.ScrollH=a.height()-a[0].clientHeight,d.ScrollW=a.width()-a[0].clientWidth,a.empty(),a.attr("style",""),a.append('<span style="font-family: Verdana, Helvetica, Sans-Serif; font-size: 14px;"><strong>M</strong></span>'),d.LetterW=a.children().first().width(),a.remove()};return d.eventStorage={},d.AssignGridContainers=function(a,c,e){e.$root=b(c),e.$topPanel=e.$root.find(".ngTopPanel"),e.$groupPanel=e.$root.find(".ngGroupPanel"),e.$headerContainer=e.$topPanel.find(".ngHeaderContainer"),a.$headerContainer=e.$headerContainer,e.$headerScroller=e.$topPanel.find(".ngHeaderScroller"),e.$headers=e.$headerScroller.children(),e.$viewport=e.$root.find(".ngViewport"),e.$canvas=e.$viewport.find(".ngCanvas"),e.$footerPanel=e.$root.find(".ngFooterPanel");var f=a.$watch(function(){return e.$viewport.scrollLeft()},function(a){return e.$headerContainer.scrollLeft(a)});a.$on("$destroy",function(){e.$root&&(b(e.$root.parent()).off("resize.nggrid"),e.$root=null,e.$topPanel=null,e.$headerContainer=null,e.$headers=null,e.$canvas=null,e.$footerPanel=null),f()}),d.UpdateGridLayout(a,e)},d.getRealWidth=function(a){var c=0,d={visibility:"hidden",display:"block"},e=a.parents().andSelf().not(":visible");return b.swap(e[0],d,function(){c=a.outerWidth()}),c},d.UpdateGridLayout=function(a,b){if(b.$root){var c=b.$viewport.scrollTop();b.elementDims.rootMaxW=b.$root.width(),b.$root.is(":hidden")&&(b.elementDims.rootMaxW=d.getRealWidth(b.$root)),b.elementDims.rootMaxH=b.$root.height(),b.refreshDomSizes(),a.adjustScrollTop(c,!0)}},d.numberOfGrids=0,d.setStyleText=function(a,b){var d=a.styleSheet,e=a.gridId,f=c.document;d||(d=f.getElementById(e)),d||(d=f.createElement("style"),d.type="text/css",d.id=e,(f.head||f.getElementsByTagName("head")[0]).appendChild(d)),d.styleSheet&&!d.sheet?d.styleSheet.cssText=b:d.innerHTML=b,a.styleSheet=d,a.styleText=b},d.BuildStyles=function(a,b,c){var e,f=b.config.rowHeight,g=b.gridId,h=a.columns,i=0,j=a.totalRowWidth();e="."+g+" .ngCanvas { width: "+j+"px; }."+g+" .ngRow { width: "+j+"px; }."+g+" .ngCanvas { width: "+j+"px; }."+g+" .ngHeaderScroller { width: "+(j+d.ScrollH)+"px}";for(var k=0;h.length>k;k++){var l=h[k];l.visible!==!1&&(e+="."+g+" .col"+k+" { width: "+l.width+"px; left: "+i+"px; height: "+f+"px }."+g+" .colt"+k+" { width: "+l.width+"px; }",i+=l.width)}d.setStyleText(b,e),a.adjustScrollLeft(b.$viewport.scrollLeft()),c&&d.digest(a)},d.setColLeft=function(a,b,c){if(c.styleText){var f=e[a.index];f||(f=e[a.index]=RegExp(".col"+a.index+" { width: [0-9]+px; left: [0-9]+px"));var g=c.styleText.replace(f,".col"+a.index+" { width: "+a.width+"px; left: "+b+"px");d.setStyleText(c,g)}},d.setColLeft.immediate=1,d.RebuildGrid=function(a,b){d.UpdateGridLayout(a,b),(null==b.config.maintainColumnRatios||b.config.maintainColumnRatios)&&b.configureColumnWidths(),a.adjustScrollLeft(b.$viewport.scrollLeft()),d.BuildStyles(a,b,!0)},d.digest=function(a){a.$root.$$phase||a.$digest()},d.ScrollH=17,d.ScrollW=17,d.LetterW=10,f(),d}]),angular.module("ngGrid.services").factory("$sortService",["$parse",function(a){var b={};return b.colSortFnCache={},b.isCustomSort=!1,b.guessSortFn=function(a){var c=typeof a;switch(c){case"number":return b.sortNumber;case"boolean":return b.sortBool;case"string":return a.match(/^[-+]?[£$¤]?[\d,.]+%?$/)?b.sortNumberStr:b.sortAlpha;default:return"[object Date]"===Object.prototype.toString.call(a)?b.sortDate:b.basicSort}},b.basicSort=function(a,b){return a===b?0:b>a?-1:1},b.sortNumber=function(a,b){return a-b},b.sortNumberStr=function(a,b){var c,d,e=!1,f=!1;return c=parseFloat(a.replace(/[^0-9.-]/g,"")),isNaN(c)&&(e=!0),d=parseFloat(b.replace(/[^0-9.-]/g,"")),isNaN(d)&&(f=!0),e&&f?0:e?1:f?-1:c-d},b.sortAlpha=function(a,b){var c=a.toLowerCase(),d=b.toLowerCase();return c===d?0:d>c?-1:1},b.sortDate=function(a,b){var c=a.getTime(),d=b.getTime();return c===d?0:d>c?-1:1},b.sortBool=function(a,b){return a&&b?0:a||b?a?1:-1:0},b.sortData=function(c,d){if(d&&c){var f,g,h=c.fields.length,i=c.fields,j=d.slice(0);d.sort(function(d,k){for(var l,m,n=0,o=0;0===n&&h>o;){f=c.columns[o],g=c.directions[o],m=b.getSortFn(f,j);var p=a(i[o])(d),q=a(i[o])(k);b.isCustomSort?(l=m(p,q),n=g===e?l:0-l):null==p||null==q?null==q&&null==p?n=0:null==p?n=1:null==q&&(n=-1):(l=m(p,q),n=g===e?l:0-l),o++}return n})}},b.Sort=function(a,c){b.isSorting||(b.isSorting=!0,b.sortData(a,c),b.isSorting=!1)},b.getSortFn=function(c,d){var e,f;if(b.colSortFnCache[c.field])e=b.colSortFnCache[c.field];else if(void 0!==c.sortingAlgorithm)e=c.sortingAlgorithm,b.colSortFnCache[c.field]=c.sortingAlgorithm,b.isCustomSort=!0;else{if(f=d[0],!f)return e;e=b.guessSortFn(a(c.field)(f)),e?b.colSortFnCache[c.field]=e:e=b.sortAlpha}return e},b}]),angular.module("ngGrid.services").factory("$utilityService",["$parse",function(c){var d=/function (.{1,})\(/,e={visualLength:function(a){var c=document.getElementById("testDataLength");c||(c=document.createElement("SPAN"),c.id="testDataLength",c.style.visibility="hidden",document.body.appendChild(c));var d=b(a);b(c).css({font:d.css("font"),"font-size":d.css("font-size"),"font-family":d.css("font-family")}),c.innerHTML=d.text();var e=c.offsetWidth;return document.body.removeChild(c),e},forIn:function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c)},evalProperty:function(a,b){return c("entity."+b)({entity:a})},endsWith:function(a,b){return a&&b&&"string"==typeof a?-1!==a.indexOf(b,a.length-b.length):!1},isNullOrUndefined:function(a){return void 0===a||null===a?!0:!1},getElementsByClassName:function(a){if(document.getElementsByClassName)return document.getElementsByClassName(a);for(var b=[],c=RegExp("\\b"+a+"\\b"),d=document.getElementsByTagName("*"),e=0;d.length>e;e++){var f=d[e].className;c.test(f)&&b.push(d[e])}return b},newId:function(){var a=(new Date).getTime();return function(){return a+=1}}(),seti18n:function(b,c){var d=a.ngGrid.i18n[c];for(var e in d)b.i18n[e]=d[e]},getInstanceType:function(a){var b=d.exec(""+a.constructor);if(b&&b.length>1){var c=b[1].replace(/^\s+|\s+$/g,"");return c}return""}};return e}]);var t=function(a,b,c,d){this.rowIndex=0,this.offsetTop=this.rowIndex*c,this.entity=a,this.label=a.gLabel,this.field=a.gField,this.depth=a.gDepth,this.parent=a.parent,this.children=a.children,this.aggChildren=a.aggChildren,this.aggIndex=a.aggIndex,this.collapsed=d,this.groupInitState=d,this.rowFactory=b,this.rowHeight=c,this.isAggRow=!0,this.offsetLeft=25*a.gDepth,this.aggLabelFilter=a.aggLabelFilter};t.prototype.toggleExpand=function(){this.collapsed=this.collapsed?!1:!0,this.orig&&(this.orig.collapsed=this.collapsed),this.notifyChildren()},t.prototype.setExpand=function(a){this.collapsed=a,this.orig&&(this.orig.collapsed=a),this.notifyChildren()},t.prototype.notifyChildren=function(){for(var a=Math.max(this.rowFactory.aggCache.length,this.children.length),b=0;a>b;b++)if(this.aggChildren[b]&&(this.aggChildren[b].entity[i]=this.collapsed,this.collapsed&&this.aggChildren[b].setExpand(this.collapsed)),this.children[b]&&(this.children[b][i]=this.collapsed),b>this.aggIndex&&this.rowFactory.aggCache[b]){var c=this.rowFactory.aggCache[b],d=30*this.children.length;c.offsetTop=this.collapsed?c.offsetTop-d:c.offsetTop+d}this.rowFactory.renderedChange()},t.prototype.aggClass=function(){return this.collapsed?"ngAggArrowCollapsed":"ngAggArrowExpanded"},t.prototype.totalChildren=function(){if(this.aggChildren.length>0){var a=0,b=function(c){c.aggChildren.length>0?angular.forEach(c.aggChildren,function(a){b(a)}):a+=c.children.length};return b(this),a}return this.children.length},t.prototype.copy=function(){var a=new t(this.entity,this.rowFactory,this.rowHeight,this.groupInitState);return a.orig=this,a};var u=function(a,c,d,g,h,i){var j=this,l=a.colDef,m=500,n=0,o=null;j.colDef=a.colDef,j.width=l.width,j.groupIndex=0,j.isGroupedBy=!1,j.minWidth=l.minWidth?l.minWidth:50,j.maxWidth=l.maxWidth?l.maxWidth:9e3,j.enableCellEdit=void 0!==l.enableCellEdit?l.enableCellEdit:a.enableCellEdit||a.enableCellEditOnFocus,j.cellEditableCondition=l.cellEditableCondition||a.cellEditableCondition||"true",j.headerRowHeight=a.headerRowHeight,j.displayName=void 0===l.displayName?l.field:l.displayName,j.index=a.index,j.isAggCol=a.isAggCol,j.cellClass=l.cellClass,j.sortPriority=void 0,j.cellFilter=l.cellFilter?l.cellFilter:"",j.field=l.field,j.aggLabelFilter=l.aggLabelFilter||l.cellFilter,j.visible=i.isNullOrUndefined(l.visible)||l.visible,j.sortable=!1,j.resizable=!1,j.pinnable=!1,j.pinned=a.enablePinning&&l.pinned,j.originalIndex=null==a.originalIndex?j.index:a.originalIndex,j.groupable=i.isNullOrUndefined(l.groupable)||l.groupable,a.enableSort&&(j.sortable=i.isNullOrUndefined(l.sortable)||l.sortable),a.enableResize&&(j.resizable=i.isNullOrUndefined(l.resizable)||l.resizable),a.enablePinning&&(j.pinnable=i.isNullOrUndefined(l.pinnable)||l.pinnable),j.sortDirection=void 0,j.sortingAlgorithm=l.sortFn,j.headerClass=l.headerClass,j.cursor=j.sortable?"pointer":"default",j.headerCellTemplate=l.headerCellTemplate||h.get("headerCellTemplate.html"),j.cellTemplate=l.cellTemplate||h.get("cellTemplate.html").replace(k,j.cellFilter?"|"+j.cellFilter:""),j.enableCellEdit&&(j.cellEditTemplate=l.cellEditTemplate||h.get("cellEditTemplate.html"),j.editableCellTemplate=l.editableCellTemplate||h.get("editableCellTemplate.html")),l.cellTemplate&&!p.test(l.cellTemplate)&&(j.cellTemplate=h.get(l.cellTemplate)||b.ajax({type:"GET",url:l.cellTemplate,async:!1}).responseText),j.enableCellEdit&&l.editableCellTemplate&&!p.test(l.editableCellTemplate)&&(j.editableCellTemplate=h.get(l.editableCellTemplate)||b.ajax({type:"GET",url:l.editableCellTemplate,async:!1}).responseText),l.headerCellTemplate&&!p.test(l.headerCellTemplate)&&(j.headerCellTemplate=h.get(l.headerCellTemplate)||b.ajax({type:"GET",url:l.headerCellTemplate,async:!1}).responseText),j.colIndex=function(){var a=j.pinned?"pinned ":"";return a+="col"+j.index+" colt"+j.index,j.cellClass&&(a+=" "+j.cellClass),a},j.groupedByClass=function(){return j.isGroupedBy?"ngGroupedByIcon":"ngGroupIcon"},j.toggleVisible=function(){j.visible=!j.visible},j.showSortButtonUp=function(){return j.sortable?j.sortDirection===f:j.sortable},j.showSortButtonDown=function(){return j.sortable?j.sortDirection===e:j.sortable},j.noSortVisible=function(){return!j.sortDirection},j.sort=function(b){if(!j.sortable)return!0;var c=j.sortDirection===e?f:e;return j.sortDirection=c,a.sortCallback(j,b),!1},j.gripClick=function(){n++,1===n?o=setTimeout(function(){n=0},m):(clearTimeout(o),a.resizeOnDataCallback(j),n=0)},j.gripOnMouseDown=function(a){return c.isColumnResizing=!0,a.ctrlKey&&!j.pinned?(j.toggleVisible(),g.BuildStyles(c,d),!0):(a.target.parentElement.style.cursor="col-resize",j.startMousePosition=a.clientX,j.origWidth=j.width,b(document).mousemove(j.onMouseMove),b(document).mouseup(j.gripOnMouseUp),!1)},j.onMouseMove=function(a){var b=a.clientX-j.startMousePosition,e=b+j.origWidth;return j.width=j.minWidth>e?j.minWidth:e>j.maxWidth?j.maxWidth:e,c.hasUserChangedGridColumnWidths=!0,g.BuildStyles(c,d),!1},j.gripOnMouseUp=function(a){return b(document).off("mousemove",j.onMouseMove),b(document).off("mouseup",j.gripOnMouseUp),a.target.parentElement.style.cursor="default",g.digest(c),c.isColumnResizing=!1,!1},j.copy=function(){var b=new u(a,c,d,g,h,i);return b.isClone=!0,b.orig=j,b},j.setVars=function(a){j.orig=a,j.width=a.width,j.groupIndex=a.groupIndex,j.isGroupedBy=a.isGroupedBy,j.displayName=a.displayName,j.index=a.index,j.isAggCol=a.isAggCol,j.cellClass=a.cellClass,j.cellFilter=a.cellFilter,j.field=a.field,j.aggLabelFilter=a.aggLabelFilter,j.visible=a.visible,j.sortable=a.sortable,j.resizable=a.resizable,j.pinnable=a.pinnable,j.pinned=a.pinned,j.originalIndex=a.originalIndex,j.sortDirection=a.sortDirection,j.sortingAlgorithm=a.sortingAlgorithm,j.headerClass=a.headerClass,j.headerCellTemplate=a.headerCellTemplate,j.cellTemplate=a.cellTemplate,j.cellEditTemplate=a.cellEditTemplate}},v=function(a){this.outerHeight=null,this.outerWidth=null,b.extend(this,a)},w=function(a){this.previousColumn=null,this.grid=a};w.prototype.changeUserSelect=function(a,b){a.css({"-webkit-touch-callout":b,"-webkit-user-select":b,"-khtml-user-select":b,"-moz-user-select":"none"===b?"-moz-none":b,"-ms-user-select":b,"user-select":b})},w.prototype.focusCellElement=function(a,b){if(a.selectionProvider.lastClickedRow){var c=void 0!==b?b:this.previousColumn,d=a.selectionProvider.lastClickedRow.clone?a.selectionProvider.lastClickedRow.clone.elm:a.selectionProvider.lastClickedRow.elm;if(void 0!==c&&d){var e=angular.element(d[0].children).filter(function(){return 8!==this.nodeType}),f=Math.max(Math.min(a.renderedColumns.length-1,c),0);this.grid.config.showSelectionCheckbox&&angular.element(e[f]).scope()&&0===angular.element(e[f]).scope().col.index&&(f=1),e[f]&&e[f].children[1].children[0].focus(),this.previousColumn=c}}},w.prototype.selectionHandlers=function(a,b){function c(c){if(16===c.keyCode)return f.changeUserSelect(b,"none",c),!0;if(!e){e=!0;var d=s(a,b,c,f.grid);return e=!1,d}return!0}function d(a){return 16===a.keyCode&&f.changeUserSelect(b,"text",a),!0}var e=!1,f=this;b.bind("keydown",c),b.bind("keyup",d),b.on("$destroy",function(){b.off("keydown",c),b.off("keyup",d)})};var x=function(c,d,e,f){var g=this;g.colToMove=void 0,g.groupToMove=void 0,g.assignEvents=function(){c.config.jqueryUIDraggable&&!c.config.enablePinning?(c.$groupPanel.droppable({addClasses:!1,drop:function(a){g.onGroupDrop(a)}}),c.$groupPanel.on("$destroy",function(){c.$groupPanel=null})):(c.$groupPanel.on("mousedown",g.onGroupMouseDown).on("dragover",g.dragOver).on("drop",g.onGroupDrop),c.$topPanel.on("mousedown",".ngHeaderScroller",g.onHeaderMouseDown).on("dragover",".ngHeaderScroller",g.dragOver),c.$groupPanel.on("$destroy",function(){c.$groupPanel&&c.$groupPanel.off("mousedown"),c.$groupPanel=null}),c.config.enableColumnReordering&&c.$topPanel.on("drop",".ngHeaderScroller",g.onHeaderDrop),c.$topPanel.on("$destroy",function(){c.$topPanel&&c.$topPanel.off("mousedown"),c.config.enableColumnReordering&&c.$topPanel&&c.$topPanel.off("drop"),c.$topPanel=null})),d.$on("$destroy",d.$watch("renderedColumns",function(){f(g.setDraggables)}))},g.dragStart=function(a){a.dataTransfer.setData("text","")},g.dragOver=function(a){a.preventDefault()},g.setDraggables=function(){if(c.config.jqueryUIDraggable)c.$root&&c.$root.find(".ngHeaderSortColumn").draggable({helper:"clone",appendTo:"body",stack:"div",addClasses:!1,start:function(a){g.onHeaderMouseDown(a)}}).droppable({drop:function(a){g.onHeaderDrop(a)}});else{var a=c.$root.find(".ngHeaderSortColumn");if(angular.forEach(a,function(a){a.className&&-1!==a.className.indexOf("ngHeaderSortColumn")&&(a.setAttribute("draggable","true"),a.addEventListener&&(a.addEventListener("dragstart",g.dragStart),angular.element(a).on("$destroy",function(){angular.element(a).off("dragstart",g.dragStart),a.removeEventListener("dragstart",g.dragStart)})))}),-1!==navigator.userAgent.indexOf("MSIE")){var b=c.$root.find(".ngHeaderSortColumn");b.bind("selectstart",function(){return this.dragDrop(),!1}),angular.element(b).on("$destroy",function(){b.off("selectstart")})}}},g.onGroupMouseDown=function(a){var d=b(a.target);if("ngRemoveGroup"!==d[0].className){var e=angular.element(d).scope();e&&(c.config.jqueryUIDraggable||(d.attr("draggable","true"),this.addEventListener&&(this.addEventListener("dragstart",g.dragStart),angular.element(this).on("$destroy",function(){this.removeEventListener("dragstart",g.dragStart)})),-1!==navigator.userAgent.indexOf("MSIE")&&(d.bind("selectstart",function(){return this.dragDrop(),!1}),d.on("$destroy",function(){d.off("selectstart")}))),g.groupToMove={header:d,groupName:e.group,index:e.$index})}else g.groupToMove=void 0},g.onGroupDrop=function(a){a.stopPropagation();var e,f;g.groupToMove?(e=b(a.target).closest(".ngGroupElement"),"ngGroupPanel"===e.context.className?(d.configGroups.splice(g.groupToMove.index,1),d.configGroups.push(g.groupToMove.groupName)):(f=angular.element(e).scope(),f&&g.groupToMove.index!==f.$index&&(d.configGroups.splice(g.groupToMove.index,1),d.configGroups.splice(f.$index,0,g.groupToMove.groupName))),g.groupToMove=void 0,c.fixGroupIndexes()):g.colToMove&&(-1===d.configGroups.indexOf(g.colToMove.col)&&(e=b(a.target).closest(".ngGroupElement"),"ngGroupPanel"===e.context.className||"ngGroupPanelDescription ng-binding"===e.context.className?d.groupBy(g.colToMove.col):(f=angular.element(e).scope(),f&&d.removeGroup(f.$index))),g.colToMove=void 0),d.$$phase||d.$apply()},g.onHeaderMouseDown=function(a){var c=b(a.target).closest(".ngHeaderSortColumn"),d=angular.element(c).scope();d&&(g.colToMove={header:c,col:d.col})},g.onHeaderDrop=function(a){if(g.colToMove&&!g.colToMove.col.pinned){var f=b(a.target).closest(".ngHeaderSortColumn"),h=angular.element(f).scope();if(h){if(g.colToMove.col===h.col||h.col.pinned)return;d.columns.splice(g.colToMove.col.index,1),d.columns.splice(h.col.index,0,g.colToMove.col),c.fixColumnIndexes(),g.colToMove=void 0,e.digest(d)}}},g.assignGridEventHandlers=function(){-1===c.config.tabIndex?(c.$viewport.attr("tabIndex",e.numberOfGrids),e.numberOfGrids++):c.$viewport.attr("tabIndex",c.config.tabIndex);var f,g=function(){clearTimeout(f),f=setTimeout(function(){e.RebuildGrid(d,c)},100)};b(a).on("resize.nggrid",g);var h,i=function(){clearTimeout(h),h=setTimeout(function(){e.RebuildGrid(d,c)},100)};b(c.$root.parent()).on("resize.nggrid",i),d.$on("$destroy",function(){b(a).off("resize.nggrid",g)})},g.assignGridEventHandlers(),g.assignEvents()},y=function(a,b){a.maxRows=function(){var c=Math.max(a.totalServerItems,b.data.length);return c},a.$on("$destroy",a.$watch("totalServerItems",function(){a.currentMaxPages=a.maxPages()})),a.multiSelect=b.config.enableRowSelection&&b.config.multiSelect,a.selectedItemCount=b.selectedItemCount,a.maxPages=function(){return 0===a.maxRows()?1:Math.ceil(a.maxRows()/a.pagingOptions.pageSize)},a.pageForward=function(){var b=a.pagingOptions.currentPage;a.totalServerItems>0?a.pagingOptions.currentPage=Math.min(b+1,a.maxPages()):a.pagingOptions.currentPage++},a.pageBackward=function(){var b=a.pagingOptions.currentPage;a.pagingOptions.currentPage=Math.max(b-1,1)},a.pageToFirst=function(){a.pagingOptions.currentPage=1},a.pageToLast=function(){var b=a.maxPages();a.pagingOptions.currentPage=b},a.cantPageForward=function(){var c=a.pagingOptions.currentPage,d=a.maxPages();return a.totalServerItems>0?c>=d:1>b.data.length},a.cantPageToLast=function(){return a.totalServerItems>0?a.cantPageForward():!0},a.cantPageBackward=function(){var b=a.pagingOptions.currentPage;return 1>=b}},z=function(e,f,g,h,j,k,l,m,n,o,q){var r={aggregateTemplate:void 0,afterSelectionChange:function(){},beforeSelectionChange:function(){return!0},checkboxCellTemplate:void 0,checkboxHeaderTemplate:void 0,columnDefs:void 0,data:[],dataUpdated:function(){},enableCellEdit:!1,enableCellEditOnFocus:!1,enableCellSelection:!1,enableColumnResize:!1,enableColumnReordering:!1,enableColumnHeavyVirt:!1,enablePaging:!1,enablePinning:!1,enableRowSelection:!0,enableSorting:!0,enableHighlighting:!1,excludeProperties:[],filterOptions:{filterText:"",useExternalFilter:!1},footerRowHeight:55,footerTemplate:void 0,forceSyncScrolling:!0,groups:[],groupsCollapsedByDefault:!0,headerRowHeight:30,headerRowTemplate:void 0,jqueryUIDraggable:!1,jqueryUITheme:!1,keepLastSelected:!0,maintainColumnRatios:void 0,menuTemplate:void 0,multiSelect:!0,pagingOptions:{pageSizes:[250,500,1e3],pageSize:250,currentPage:1},pinSelectionCheckbox:!1,plugins:[],primaryKey:void 0,rowHeight:30,rowTemplate:void 0,selectedItems:[],selectionCheckboxColumnWidth:25,selectWithCheckboxOnly:!1,showColumnMenu:!1,showFilter:!1,showFooter:!1,showGroupPanel:!1,showSelectionCheckbox:!1,sortInfo:{fields:[],columns:[],directions:[]},tabIndex:-1,totalServerItems:0,useExternalSorting:!1,i18n:"en",virtualizationThreshold:50,noTabInterference:!1},s=this;s.maxCanvasHt=0,s.config=b.extend(r,a.ngGrid.config,f),s.config.showSelectionCheckbox=s.config.showSelectionCheckbox&&s.config.enableColumnHeavyVirt===!1,s.config.enablePinning=s.config.enablePinning&&s.config.enableColumnHeavyVirt===!1,s.config.selectWithCheckboxOnly=s.config.selectWithCheckboxOnly&&s.config.showSelectionCheckbox!==!1,s.config.pinSelectionCheckbox=s.config.enablePinning,"string"==typeof f.columnDefs&&(s.config.columnDefs=e.$eval(f.columnDefs)),s.rowCache=[],s.rowMap=[],s.gridId="ng"+l.newId(),s.$root=null,s.$groupPanel=null,s.$topPanel=null,s.$headerContainer=null,s.$headerScroller=null,s.$headers=null,s.$viewport=null,s.$canvas=null,s.rootDim=s.config.gridDim,s.data=[],s.lateBindColumns=!1,s.filteredRows=[],s.initTemplates=function(){var a=["rowTemplate","aggregateTemplate","headerRowTemplate","checkboxCellTemplate","checkboxHeaderTemplate","menuTemplate","footerTemplate"],b=[];return angular.forEach(a,function(a){b.push(s.getTemplate(a))}),q.all(b)},s.getTemplate=function(a){var b=s.config[a],c=s.gridId+a+".html",d=q.defer();if(b&&!p.test(b))o.get(b,{cache:k}).success(function(a){k.put(c,a),d.resolve()}).error(function(){d.reject("Could not load template: "+b)});else if(b)k.put(c,b),d.resolve();else{var e=a+".html";k.put(c,k.get(e)),d.resolve()}return d.promise},"object"==typeof s.config.data&&(s.data=s.config.data),s.calcMaxCanvasHeight=function(){var a;return a=s.config.groups.length>0?s.rowFactory.parsedData.filter(function(a){return!a[i]}).length*s.config.rowHeight:s.filteredRows.length*s.config.rowHeight},s.elementDims={scrollW:0,scrollH:0,rowIndexCellW:s.config.selectionCheckboxColumnWidth,rowSelectedCellW:s.config.selectionCheckboxColumnWidth,rootMaxW:0,rootMaxH:0},s.setRenderedRows=function(a){e.renderedRows.length=a.length;for(var b=0;a.length>b;b++)!e.renderedRows[b]||a[b].isAggRow||e.renderedRows[b].isAggRow?(e.renderedRows[b]=a[b].copy(),e.renderedRows[b].collapsed=a[b].collapsed,a[b].isAggRow||e.renderedRows[b].setVars(a[b])):e.renderedRows[b].setVars(a[b]),e.renderedRows[b].rowIndex=a[b].rowIndex,e.renderedRows[b].offsetTop=a[b].offsetTop,e.renderedRows[b].selected=a[b].selected,a[b].renderedRowIndex=b;s.refreshDomSizes(),e.$emit("ngGridEventRows",a)},s.minRowsToRender=function(){var a=e.viewportDimHeight()||1;return Math.floor(a/s.config.rowHeight)},s.refreshDomSizes=function(){var a=new v;a.outerWidth=s.elementDims.rootMaxW,a.outerHeight=s.elementDims.rootMaxH,s.rootDim=a,s.maxCanvasHt=s.calcMaxCanvasHeight()},s.buildColumnDefsFromData=function(){s.config.columnDefs=[];var a=s.data[0];return a?void l.forIn(a,function(a,b){-1===s.config.excludeProperties.indexOf(b)&&s.config.columnDefs.push({field:b})}):void(s.lateBoundColumns=!0)},s.buildColumns=function(){var a=s.config.columnDefs,b=[];if(a||(s.buildColumnDefsFromData(),a=s.config.columnDefs),s.config.showSelectionCheckbox&&b.push(new u({colDef:{field:"✔",width:s.elementDims.rowSelectedCellW,sortable:!1,resizable:!1,groupable:!1,headerCellTemplate:k.get(e.gridId+"checkboxHeaderTemplate.html"),cellTemplate:k.get(e.gridId+"checkboxCellTemplate.html"),pinned:s.config.pinSelectionCheckbox},index:0,headerRowHeight:s.config.headerRowHeight,sortCallback:s.sortData,resizeOnDataCallback:s.resizeOnData,enableResize:s.config.enableColumnResize,enableSort:s.config.enableSorting,enablePinning:s.config.enablePinning},e,s,h,k,l)),a.length>0){var c=s.config.showSelectionCheckbox?1:0,d=e.configGroups.length;e.configGroups.length=0,angular.forEach(a,function(a,f){f+=c;var g=new u({colDef:a,index:f+d,originalIndex:f,headerRowHeight:s.config.headerRowHeight,sortCallback:s.sortData,resizeOnDataCallback:s.resizeOnData,enableResize:s.config.enableColumnResize,enableSort:s.config.enableSorting,enablePinning:s.config.enablePinning,enableCellEdit:s.config.enableCellEdit||s.config.enableCellEditOnFocus,cellEditableCondition:s.config.cellEditableCondition},e,s,h,k,l),i=s.config.groups.indexOf(a.field);-1!==i&&(g.isGroupedBy=!0,e.configGroups.splice(i,0,g),g.groupIndex=e.configGroups.length),b.push(g)}),e.columns=b,s.config.groups.length>0&&s.rowFactory.getGrouping(s.config.groups)}},s.configureColumnWidths=function(){var a=[],b=[],c=0,d=0,f={};if(angular.forEach(e.columns,function(a,b){if(l.isNullOrUndefined(a.originalIndex))a.isAggCol&&a.visible&&(d+=25);else{var c=a.originalIndex;s.config.showSelectionCheckbox&&(0===a.originalIndex&&a.visible&&(d+=s.config.selectionCheckboxColumnWidth),c--),f[c]=b}}),angular.forEach(s.config.columnDefs,function(g,h){var i=e.columns[f[h]];g.index=h;var j,k=!1;if(l.isNullOrUndefined(g.width)?g.width="*":(k=isNaN(g.width)?l.endsWith(g.width,"%"):!1,j=k?g.width:parseInt(g.width,10)),isNaN(j)){if(j=g.width,"auto"===j){i.width=i.minWidth,d+=i.width;var m=i;return void e.$on("$destroy",e.$on("ngGridEventData",function(){s.resizeOnData(m)}))}if(-1!==j.indexOf("*"))return i.visible!==!1&&(c+=j.length),void a.push(g);if(k)return void b.push(g);throw'unable to parse column width, use percentage ("10%","20%", etc...) or "*" to use remaining width of grid'}i.visible!==!1&&(d+=i.width=parseInt(i.width,10))}),b.length>0){s.config.maintainColumnRatios=s.config.maintainColumnRatios!==!1;var g=0,i=0;angular.forEach(b,function(a){var b=e.columns[f[a.index]],c=parseFloat(a.width)/100;g+=c,b.visible||(i+=c)});var j=g-i;angular.forEach(b,function(a){var b=e.columns[f[a.index]],c=parseFloat(a.width)/100;c/=i>0?j:g;var h=s.rootDim.outerWidth*g;b.width=h*c,d+=b.width})}if(a.length>0){s.config.maintainColumnRatios=s.config.maintainColumnRatios!==!1;var k=s.rootDim.outerWidth-d;s.maxCanvasHt>e.viewportDimHeight()&&(k-=h.ScrollW);var m=Math.floor(k/c);angular.forEach(a,function(b,c){var g=e.columns[f[b.index]];g.width=m*b.width.length,g.width<g.minWidth&&(g.width=g.minWidth),g.visible!==!1&&(d+=g.width);var i=c===a.length-1;if(i&&s.rootDim.outerWidth>d){var j=s.rootDim.outerWidth-d;s.maxCanvasHt>e.viewportDimHeight()&&(j-=h.ScrollW),g.width+=j}})}},s.init=function(){return s.initTemplates().then(function(){e.selectionProvider=new E(s,e,n),e.domAccessProvider=new w(s),s.rowFactory=new C(s,e,h,k,l),s.searchProvider=new D(e,s,j,l),s.styleProvider=new F(e,s),e.$on("$destroy",e.$watch("configGroups",function(a){var b=[];angular.forEach(a,function(a){b.push(a.field||a)}),s.config.groups=b,s.rowFactory.filteredRowsChanged(),e.$emit("ngGridEventGroups",a)},!0)),e.$on("$destroy",e.$watch("columns",function(a){e.isColumnResizing||h.RebuildGrid(e,s),e.$emit("ngGridEventColumns",a)},!0)),e.$on("$destroy",e.$watch(function(){return f.i18n},function(a){l.seti18n(e,a)})),s.maxCanvasHt=s.calcMaxCanvasHeight(),s.config.sortInfo.fields&&s.config.sortInfo.fields.length>0&&e.$on("$destroy",e.$watch(function(){return s.config.sortInfo},function(){g.isSorting||(s.sortColumnsInit(),e.$emit("ngGridEventSorted",s.config.sortInfo))},!0))})},s.resizeOnData=function(a){var c=a.minWidth,d=l.getElementsByClassName("col"+a.index);angular.forEach(d,function(a,d){var e;if(0===d){var f=b(a).find(".ngHeaderText");e=l.visualLength(f)+10}else{var g=b(a).find(".ngCellText");e=l.visualLength(g)+10}e>c&&(c=e)}),a.width=a.longest=Math.min(a.maxWidth,c+7),h.BuildStyles(e,s,!0)},s.lastSortedColumns=[],s.sortData=function(a,c){if(c&&c.shiftKey&&s.config.sortInfo){var d=s.config.sortInfo.columns.indexOf(a);-1===d?(1===s.config.sortInfo.columns.length&&(s.config.sortInfo.columns[0].sortPriority=1),s.config.sortInfo.columns.push(a),a.sortPriority=s.config.sortInfo.columns.length,s.config.sortInfo.fields.push(a.field),s.config.sortInfo.directions.push(a.sortDirection),s.lastSortedColumns.push(a)):s.config.sortInfo.directions[d]=a.sortDirection,e.$emit("ngGridEventSorted",s.config.sortInfo)}else if(!s.config.useExternalSorting||s.config.useExternalSorting&&s.config.sortInfo){var f=b.isArray(a);s.config.sortInfo.columns.length=0,s.config.sortInfo.fields.length=0,s.config.sortInfo.directions.length=0;var g=function(a){s.config.sortInfo.columns.push(a),s.config.sortInfo.fields.push(a.field),s.config.sortInfo.directions.push(a.sortDirection),s.lastSortedColumns.push(a)};f?angular.forEach(a,function(a,b){a.sortPriority=b+1,g(a)}):(s.clearSortingData(a),a.sortPriority=void 0,g(a)),s.sortActual(),s.searchProvider.evalFilter(),e.$emit("ngGridEventSorted",s.config.sortInfo)}},s.sortColumnsInit=function(){s.config.sortInfo.columns?s.config.sortInfo.columns.length=0:s.config.sortInfo.columns=[];var a=[];angular.forEach(e.columns,function(b){var c=s.config.sortInfo.fields.indexOf(b.field);-1!==c&&(b.sortDirection=s.config.sortInfo.directions[c]||"asc",a[c]=b)}),s.sortData(1===a.length?a[0]:a)},s.sortActual=function(){if(!s.config.useExternalSorting){var a=s.data.slice(0);angular.forEach(a,function(a,b){var c=s.rowMap[b];if(void 0!==c){var d=s.rowCache[c];void 0!==d&&(a.preSortSelected=d.selected,a.preSortIndex=b)}}),g.Sort(s.config.sortInfo,a),angular.forEach(a,function(a,b){s.rowCache[b].entity=a,s.rowCache[b].selected=a.preSortSelected,s.rowMap[a.preSortIndex]=b,delete a.preSortSelected,delete a.preSortIndex})}},s.clearSortingData=function(a){a?(angular.forEach(s.lastSortedColumns,function(b){a.index!==b.index&&(b.sortDirection="",b.sortPriority=null)}),s.lastSortedColumns[0]=a,s.lastSortedColumns.length=1):(angular.forEach(s.lastSortedColumns,function(a){a.sortDirection="",a.sortPriority=null}),s.lastSortedColumns=[])},s.fixColumnIndexes=function(){for(var a=0;e.columns.length>a;a++)e.columns[a].index=a},s.fixGroupIndexes=function(){angular.forEach(e.configGroups,function(a,b){a.groupIndex=b+1})},e.elementsNeedMeasuring=!0,e.columns=[],e.renderedRows=[],e.renderedColumns=[],e.headerRow=null,e.rowHeight=s.config.rowHeight,e.jqueryUITheme=s.config.jqueryUITheme,e.showSelectionCheckbox=s.config.showSelectionCheckbox,e.enableCellSelection=s.config.enableCellSelection,e.enableCellEditOnFocus=s.config.enableCellEditOnFocus,e.footer=null,e.selectedItems=s.config.selectedItems,e.multiSelect=s.config.multiSelect,e.showFooter=s.config.showFooter,e.footerRowHeight=e.showFooter?s.config.footerRowHeight:0,e.showColumnMenu=s.config.showColumnMenu,e.forceSyncScrolling=s.config.forceSyncScrolling,e.showMenu=!1,e.configGroups=[],e.gridId=s.gridId,e.enablePaging=s.config.enablePaging,e.pagingOptions=s.config.pagingOptions,e.i18n={},l.seti18n(e,s.config.i18n),e.adjustScrollLeft=function(a){for(var b=0,c=0,d=e.columns.length,f=[],g=!s.config.enableColumnHeavyVirt,i=0,j=function(a){g?f.push(a):e.renderedColumns[i]?e.renderedColumns[i].setVars(a):e.renderedColumns[i]=a.copy(),i++},k=0;d>k;k++){var l=e.columns[k];if(l.visible!==!1){var m=l.width+b;if(l.pinned){j(l);var n=k>0?a+c:a;h.setColLeft(l,n,s),c+=l.width}else m>=a&&a+s.rootDim.outerWidth>=b&&j(l);b+=l.width}}g&&(e.renderedColumns=f)},s.prevScrollTop=0,s.prevScrollIndex=0,e.adjustScrollTop=function(a,b){if(s.prevScrollTop!==a||b){a>0&&s.$viewport[0].scrollHeight-a<=s.$viewport.outerHeight()&&e.$emit("ngGridEventScroll");var f,g=Math.floor(a/s.config.rowHeight);if(s.filteredRows.length>s.config.virtualizationThreshold){if(a>s.prevScrollTop&&s.prevScrollIndex+d>g)return;if(s.prevScrollTop>a&&g>s.prevScrollIndex-d)return;f=new A(Math.max(0,g-c),g+s.minRowsToRender()+c)}else{var h=e.configGroups.length>0?s.rowFactory.parsedData.length:s.filteredRows.length;f=new A(0,Math.max(h,s.minRowsToRender()+c))}s.prevScrollTop=a,s.rowFactory.UpdateViewableRange(f),s.prevScrollIndex=g}},e.toggleShowMenu=function(){e.showMenu=!e.showMenu},e.toggleSelectAll=function(a,b){e.selectionProvider.toggleSelectAll(a,!1,b)},e.totalFilteredItemsLength=function(){return s.filteredRows.length},e.showGroupPanel=function(){return s.config.showGroupPanel
},e.topPanelHeight=function(){return s.config.showGroupPanel===!0?s.config.headerRowHeight+32:s.config.headerRowHeight},e.viewportDimHeight=function(){return Math.max(0,s.rootDim.outerHeight-e.topPanelHeight()-e.footerRowHeight-2)},e.groupBy=function(a){if(!(1>s.data.length)&&a.groupable&&a.field){a.sortDirection||a.sort({shiftKey:e.configGroups.length>0?!0:!1});var b=e.configGroups.indexOf(a);-1===b?(a.isGroupedBy=!0,e.configGroups.push(a),a.groupIndex=e.configGroups.length):e.removeGroup(b),s.$viewport.scrollTop(0),h.digest(e)}},e.removeGroup=function(a){var b=e.columns.filter(function(b){return b.groupIndex===a+1})[0];b.isGroupedBy=!1,b.groupIndex=0,e.columns[a].isAggCol&&(e.columns.splice(a,1),e.configGroups.splice(a,1),s.fixGroupIndexes()),0===e.configGroups.length&&(s.fixColumnIndexes(),h.digest(e)),e.adjustScrollLeft(0)},e.togglePin=function(a){for(var b=a.index,c=0,d=0;e.columns.length>d&&e.columns[d].pinned;d++)c++;a.pinned&&(c=Math.max(a.originalIndex,c-1)),a.pinned=!a.pinned,e.columns.splice(b,1),e.columns.splice(c,0,a),s.fixColumnIndexes(),h.BuildStyles(e,s,!0),s.$viewport.scrollLeft(s.$viewport.scrollLeft()-a.width)},e.totalRowWidth=function(){for(var a=0,b=e.columns,c=0;b.length>c;c++)b[c].visible!==!1&&(a+=b[c].width);return a},e.headerScrollerDim=function(){var a=e.viewportDimHeight(),b=s.maxCanvasHt,c=b>a,d=new v;return d.autoFitHeight=!0,d.outerWidth=e.totalRowWidth(),c?d.outerWidth+=s.elementDims.scrollW:s.elementDims.scrollH>=b-a&&(d.outerWidth+=s.elementDims.scrollW),d}},A=function(a,b){this.topRow=a,this.bottomRow=b},B=function(a,b,c,d,e){this.entity=a,this.config=b,this.selectionProvider=c,this.rowIndex=d,this.utils=e,this.selected=c.getSelection(a),this.cursor=this.config.enableRowSelection&&!this.config.selectWithCheckboxOnly?"pointer":"default",this.beforeSelectionChange=b.beforeSelectionChangeCallback,this.afterSelectionChange=b.afterSelectionChangeCallback,this.offsetTop=this.rowIndex*b.rowHeight,this.rowDisplayIndex=0};B.prototype.setSelection=function(a){this.selectionProvider.setSelection(this,a),this.selectionProvider.lastClickedRow=this},B.prototype.continueSelection=function(a){this.selectionProvider.ChangeSelection(this,a)},B.prototype.ensureEntity=function(a){this.entity!==a&&(this.entity=a,this.selected=this.selectionProvider.getSelection(this.entity))},B.prototype.toggleSelected=function(a){if(!this.config.enableRowSelection&&!this.config.enableCellSelection)return!0;var b=a.target||a;return"checkbox"===b.type&&"ngSelectionCell ng-scope"!==b.parentElement.className?!0:this.config.selectWithCheckboxOnly&&"checkbox"!==b.type?(this.selectionProvider.lastClickedRow=this,!0):(this.beforeSelectionChange(this,a)&&this.continueSelection(a),!1)},B.prototype.alternatingRowClass=function(){var a=0===this.rowIndex%2,b={ngRow:!0,selected:this.selected,even:a,odd:!a,"ui-state-default":this.config.jqueryUITheme&&a,"ui-state-active":this.config.jqueryUITheme&&!a};return b},B.prototype.getProperty=function(a){return this.utils.evalProperty(this.entity,a)},B.prototype.copy=function(){return this.clone=new B(this.entity,this.config,this.selectionProvider,this.rowIndex,this.utils),this.clone.isClone=!0,this.clone.elm=this.elm,this.clone.orig=this,this.clone},B.prototype.setVars=function(a){a.clone=this,this.entity=a.entity,this.selected=a.selected,this.orig=a};var C=function(a,b,d,e,f){var k=this;k.aggCache={},k.parentCache=[],k.dataChanged=!0,k.parsedData=[],k.rowConfig={},k.selectionProvider=b.selectionProvider,k.rowHeight=30,k.numberOfAggregates=0,k.groupedData=void 0,k.rowHeight=a.config.rowHeight,k.rowConfig={enableRowSelection:a.config.enableRowSelection,rowClasses:a.config.rowClasses,selectedItems:b.selectedItems,selectWithCheckboxOnly:a.config.selectWithCheckboxOnly,beforeSelectionChangeCallback:a.config.beforeSelectionChange,afterSelectionChangeCallback:a.config.afterSelectionChange,jqueryUITheme:a.config.jqueryUITheme,enableCellSelection:a.config.enableCellSelection,rowHeight:a.config.rowHeight},k.renderedRange=new A(0,a.minRowsToRender()+c),k.buildEntityRow=function(a,b){return new B(a,k.rowConfig,k.selectionProvider,b,f)},k.buildAggregateRow=function(b,c){var d=k.aggCache[b.aggIndex];return d||(d=new t(b,k,k.rowConfig.rowHeight,a.config.groupsCollapsedByDefault),k.aggCache[b.aggIndex]=d),d.rowIndex=c,d.offsetTop=c*k.rowConfig.rowHeight,d},k.UpdateViewableRange=function(a){k.renderedRange=a,k.renderedChange()},k.filteredRowsChanged=function(){a.lateBoundColumns&&a.filteredRows.length>0&&(a.config.columnDefs=void 0,a.buildColumns(),a.lateBoundColumns=!1,b.$evalAsync(function(){b.adjustScrollLeft(0)})),k.dataChanged=!0,a.config.groups.length>0&&k.getGrouping(a.config.groups),k.UpdateViewableRange(k.renderedRange)},k.renderedChange=function(){if(!k.groupedData||1>a.config.groups.length)return k.renderedChangeNoGroups(),void a.refreshDomSizes();k.wasGrouped=!0,k.parentCache=[];var b=0,c=k.parsedData.filter(function(a){return a.isAggRow?a.parent&&a.parent.collapsed?!1:!0:(a[i]||(a.rowIndex=b++),!a[i])});k.totalRows=c.length;for(var d=[],e=k.renderedRange.topRow;k.renderedRange.bottomRow>e;e++)c[e]&&(c[e].offsetTop=e*a.config.rowHeight,d.push(c[e]));a.setRenderedRows(d)},k.renderedChangeNoGroups=function(){for(var b=[],c=k.renderedRange.topRow;k.renderedRange.bottomRow>c;c++)a.filteredRows[c]&&(a.filteredRows[c].rowIndex=c,a.filteredRows[c].offsetTop=c*a.config.rowHeight,b.push(a.filteredRows[c]));a.setRenderedRows(b)},k.fixRowCache=function(){var b=a.data.length,c=b-a.rowCache.length;if(0>c)a.rowCache.length=a.rowMap.length=b;else for(var d=a.rowCache.length;b>d;d++)a.rowCache[d]=a.rowFactory.buildEntityRow(a.data[d],d)},k.parseGroupData=function(a){if(a.values)for(var b=0;a.values.length>b;b++)k.parentCache[k.parentCache.length-1].children.push(a.values[b]),k.parsedData.push(a.values[b]);else for(var c in a)if(c!==g&&c!==h&&c!==j&&a.hasOwnProperty(c)){var d=k.buildAggregateRow({gField:a[g],gLabel:c,gDepth:a[h],isAggRow:!0,_ng_hidden_:!1,children:[],aggChildren:[],aggIndex:k.numberOfAggregates,aggLabelFilter:a[j].aggLabelFilter},0);k.numberOfAggregates++,d.parent=k.parentCache[d.depth-1],d.parent&&(d.parent.collapsed=!1,d.parent.aggChildren.push(d)),k.parsedData.push(d),k.parentCache[d.depth]=d,k.parseGroupData(a[c])}},k.getGrouping=function(c){function l(a,b){return a.filter(function(a){return a.field===b})}k.aggCache=[],k.numberOfAggregates=0,k.groupedData={};for(var m=a.filteredRows,n=c.length,o=b.columns,p=0;m.length>p;p++){var q=m[p].entity;if(!q)return;m[p][i]=a.config.groupsCollapsedByDefault;for(var r=k.groupedData,s=0;c.length>s;s++){var t=c[s],v=l(o,t)[0],w=f.evalProperty(q,t);w=""===w||null===w?"null":""+w,r[w]||(r[w]={}),r[g]||(r[g]=t),r[h]||(r[h]=s),r[j]||(r[j]=v),r=r[w]}r.values||(r.values=[]),r.values.push(m[p])}if(o.length>0)for(var x=0;c.length>x;x++)!o[x].isAggCol&&n>=x&&o.splice(0,0,new u({colDef:{field:"",width:25,sortable:!1,resizable:!1,headerCellTemplate:'<div class="ngAggHeader"></div>',pinned:a.config.pinSelectionCheckbox},enablePinning:a.config.enablePinning,isAggCol:!0,headerRowHeight:a.config.headerRowHeight},b,a,d,e,f));a.fixColumnIndexes(),b.adjustScrollLeft(0),k.parsedData.length=0,k.parseGroupData(k.groupedData),k.fixRowCache()},a.config.groups.length>0&&a.filteredRows.length>0&&k.getGrouping(a.config.groups)},D=function(a,c,d,e){var f=this,g=[];f.extFilter=c.config.filterOptions.useExternalFilter,a.showFilter=c.config.showFilter,a.filterText="",f.fieldMap={};var h=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c.toLowerCase()]=a[c]);return b},i=function(a){if("object"==typeof a){var b=[];for(var c in a)b=b.concat(i(a[c]));return b}return[a]},j=function(a,b,c){var e;for(var f in b)if(b.hasOwnProperty(f)){var g=c[f.toLowerCase()],i=b[f];if("object"!=typeof i||i instanceof Date){var k=null,l=null;if(g&&g.cellFilter&&(l=g.cellFilter.split(":"),k=d(l[0])),null!==i&&void 0!==i){if("function"==typeof k){var m=""+k(i,l[1]?l[1].slice(1,-1):"");e=a.regex.test(m)}else e=a.regex.test(""+i);if(e)return!0}}else{var n=h(g);if(e=j(a,i,n))return!0}}return!1},k=function(a,b){var c,g=f.fieldMap[a.columnDisplay];if(!g)return!1;var h=g.cellFilter.split(":"),j=g.cellFilter?d(h[0]):null,k=b[a.column]||b[g.field.split(".")[0]]||e.evalProperty(b,g.field);if(null===k||void 0===k)return!1;if("function"==typeof j){var l=""+j("object"==typeof k?m(k,g.field):k,h[1]);c=a.regex.test(l)}else{var n=i(m(k,g.field));for(var o in n)c|=a.regex.test(primValues[o])}return c?!0:!1},l=function(a){for(var b=0,c=g.length;c>b;b++){var d,e=g[b];if(d=e.column?k(e,a):j(e,a,f.fieldMap),!d)return!1}return!0};f.evalFilter=function(){c.filteredRows=0===g.length?c.rowCache:c.rowCache.filter(function(a){return l(a.entity)});for(var a=0;c.filteredRows.length>a;a++)c.filteredRows[a].rowIndex=a;c.rowFactory.filteredRowsChanged()};var m=function(a,b){if("object"!=typeof a||"string"!=typeof b)return a;var c=b.split("."),d=a;if(c.length>1){for(var e=1,f=c.length;f>e;e++)if(d=d[c[e]],!d)return a;return d}return a},n=function(a,b){try{return RegExp(a,b)}catch(c){return RegExp(a.replace(/(\^|\$|\(|\)|<|>|\[|\]|\{|\}|\\|\||\.|\*|\+|\?)/g,"\\$1"))}},o=function(a){g=[];var c;if(c=b.trim(a))for(var d=c.split(";"),e=0;d.length>e;e++){var f=d[e].split(":");if(f.length>1){var h=b.trim(f[0]),i=b.trim(f[1]);h&&i&&g.push({column:h,columnDisplay:h.replace(/\s+/g,"").toLowerCase(),regex:n(i,"i")})}else{var j=b.trim(f[0]);j&&g.push({column:"",regex:n(j,"i")})}}};f.extFilter||a.$on("$destroy",a.$watch("columns",function(a){for(var b=0;a.length>b;b++){var c=a[b];if(c.field)if(c.field.match(/\./g)){for(var d=c.field.split("."),e=f.fieldMap,g=0;d.length-1>g;g++)e[d[g]]=e[d[g]]||{},e=e[d[g]];e[d[d.length-1]]=c}else f.fieldMap[c.field.toLowerCase()]=c;c.displayName&&(f.fieldMap[c.displayName.toLowerCase().replace(/\s+/g,"")]=c)}})),a.$on("$destroy",a.$watch(function(){return c.config.filterOptions.filterText},function(b){a.filterText=b})),a.$on("$destroy",a.$watch("filterText",function(b){f.extFilter||(a.$emit("ngGridEventFilter",b),o(b),f.evalFilter())}))},E=function(a,b,c){var d=this;d.multi=a.config.multiSelect,d.selectedItems=a.config.selectedItems,d.selectedIndex=a.config.selectedIndex,d.lastClickedRow=void 0,d.ignoreSelectedItemChanges=!1,d.pKeyParser=c(a.config.primaryKey),d.ChangeSelection=function(c,e){var f=e.which||e.keyCode,g=40===f||38===f;if(e&&e.shiftKey&&!e.keyCode&&d.multi&&a.config.enableRowSelection){if(d.lastClickedRow){var h;h=b.configGroups.length>0?a.rowFactory.parsedData.filter(function(a){return!a.isAggRow}):a.filteredRows;var i=c.rowIndex,j=d.lastClickedRowIndex;if(i===j)return!1;j>i?(i^=j,j=i^j,i^=j,i--):j++;for(var k=[];i>=j;j++)k.push(h[j]);if(k[k.length-1].beforeSelectionChange(k,e)){for(var l=0;k.length>l;l++){var m=k[l],n=m.selected;m.selected=!n,m.clone&&(m.clone.selected=m.selected);var o=d.selectedItems.indexOf(m.entity);-1===o?d.selectedItems.push(m.entity):d.selectedItems.splice(o,1)}k[k.length-1].afterSelectionChange(k,e)}return d.lastClickedRow=c,d.lastClickedRowIndex=c.rowIndex,!0}}else d.multi?(!e.keyCode||g&&!a.config.selectWithCheckboxOnly)&&d.setSelection(c,!c.selected):d.lastClickedRow===c?d.setSelection(d.lastClickedRow,a.config.keepLastSelected?!0:!c.selected):(d.lastClickedRow&&d.setSelection(d.lastClickedRow,!1),d.setSelection(c,!c.selected));return d.lastClickedRow=c,d.lastClickedRowIndex=c.rowIndex,!0},d.getSelection=function(a){return-1!==d.getSelectionIndex(a)},d.getSelectionIndex=function(b){var c=-1;if(a.config.primaryKey){var e=d.pKeyParser(b);angular.forEach(d.selectedItems,function(a,b){e===d.pKeyParser(a)&&(c=b)})}else c=d.selectedItems.indexOf(b);return c},d.setSelection=function(b,c){if(a.config.enableRowSelection){if(c)-1===d.getSelectionIndex(b.entity)&&(!d.multi&&d.selectedItems.length>0&&d.toggleSelectAll(!1,!0),d.selectedItems.push(b.entity));else{var e=d.getSelectionIndex(b.entity);-1!==e&&d.selectedItems.splice(e,1)}b.selected=c,b.orig&&(b.orig.selected=c),b.clone&&(b.clone.selected=c),b.afterSelectionChange(b)}},d.toggleSelectAll=function(b,c,e){var f,g,h=e?a.filteredRows:a.rowCache;if(c||a.config.beforeSelectionChange(h,b)){!e&&d.selectedItems.length>0&&(d.selectedItems.length=0);for(var i=0;h.length>i;i++)f=h[i].selected,h[i].selected=b,h[i].clone&&(h[i].clone.selected=b),!f&&b?d.selectedItems.push(h[i].entity):f&&!b&&(g=d.selectedItems.indexOf(h[i].entity),g>-1&&d.selectedItems.splice(g,1));c||a.config.afterSelectionChange(h,b)}}},F=function(a,b){a.headerCellStyle=function(a){return{height:a.headerRowHeight+"px"}},a.rowStyle=function(b){var c={top:b.offsetTop+"px",height:a.rowHeight+"px"};return b.isAggRow&&(c.left=b.offsetLeft),c},a.canvasStyle=function(){return{height:b.maxCanvasHt+"px"}},a.headerScrollerStyle=function(){return{height:b.config.headerRowHeight+"px"}},a.topPanelStyle=function(){return{width:b.rootDim.outerWidth+"px",height:a.topPanelHeight()+"px"}},a.headerStyle=function(){return{width:b.rootDim.outerWidth+"px",height:b.config.headerRowHeight+"px"}},a.groupPanelStyle=function(){return{width:b.rootDim.outerWidth+"px",height:"32px"}},a.viewportStyle=function(){return{width:b.rootDim.outerWidth+"px",height:a.viewportDimHeight()+"px"}},a.footerStyle=function(){return{width:b.rootDim.outerWidth+"px",height:a.footerRowHeight+"px"}}};q.directive("ngCellHasFocus",["$domUtilityService",function(a){var b=function(b){b.isFocused=!0,a.digest(b),b.$broadcast("ngGridEventStartCellEdit"),b.$emit("ngGridEventStartCellEdit"),b.$on("$destroy",b.$on("ngGridEventEndCellEdit",function(){b.isFocused=!1,a.digest(b)}))};return function(a,c){function d(){return a.enableCellEditOnFocus?j=!0:c.focus(),!0}function e(d){a.enableCellEditOnFocus&&(d.preventDefault(),j=!1,b(a,c))}function f(){return i=!0,a.enableCellEditOnFocus&&!j&&b(a,c),!0}function g(){return i=!1,!0}function h(d){return a.enableCellEditOnFocus||(i&&37!==d.keyCode&&38!==d.keyCode&&39!==d.keyCode&&40!==d.keyCode&&9!==d.keyCode&&!d.shiftKey&&13!==d.keyCode&&b(a,c),i&&d.shiftKey&&d.keyCode>=65&&90>=d.keyCode&&b(a,c),27===d.keyCode&&c.focus()),!0}var i=!1,j=!1;a.editCell=function(){a.enableCellEditOnFocus||setTimeout(function(){b(a,c)},0)},c.bind("mousedown",d),c.bind("click",e),c.bind("focus",f),c.bind("blur",g),c.bind("keydown",h),c.on("$destroy",function(){c.off("mousedown",d),c.off("click",e),c.off("focus",f),c.off("blur",g),c.off("keydown",h)})}}]),q.directive("ngCellText",function(){return function(a,b){function c(a){a.preventDefault()}function d(a){a.preventDefault()}b.bind("mouseover",c),b.bind("mouseleave",d),b.on("$destroy",function(){b.off("mouseover",c),b.off("mouseleave",d)})}}),q.directive("ngCell",["$compile","$domUtilityService",function(a,c){var d={scope:!1,compile:function(){return{pre:function(c,d){var e,f=c.col.cellTemplate.replace(l,"row.entity."+c.col.field);c.col.enableCellEdit?(e=c.col.cellEditTemplate,e=e.replace(o,c.col.cellEditableCondition),e=e.replace(m,f),e=e.replace(n,c.col.editableCellTemplate.replace(l,"row.entity."+c.col.field))):e=f;var g=b(e);d.append(g),a(g)(c),c.enableCellSelection&&-1===g[0].className.indexOf("ngSelectionCell")&&(g[0].setAttribute("tabindex",0),g.addClass("ngCellElement"))},post:function(a,b){a.enableCellSelection&&a.domAccessProvider.selectionHandlers(a,b),a.$on("$destroy",a.$on("ngGridEventDigestCell",function(){c.digest(a)}))}}}};return d}]),q.directive("ngEditCellIf",[function(){return{transclude:"element",priority:1e3,terminal:!0,restrict:"A",compile:function(a,b,c){return function(a,b,d){var e,f;a.$on("$destroy",a.$watch(d.ngEditCellIf,function(d){e&&(e.remove(),e=void 0),f&&(f.$destroy(),f=void 0),d&&(f=a.$new(),c(f,function(a){e=a,b.after(a)}))}))}}}}]),q.directive("ngGridFooter",["$compile","$templateCache",function(a,b){var c={scope:!1,compile:function(){return{pre:function(c,d){0===d.children().length&&d.append(a(b.get(c.gridId+"footerTemplate.html"))(c))}}}};return c}]),q.directive("ngGridMenu",["$compile","$templateCache",function(a,b){var c={scope:!1,compile:function(){return{pre:function(c,d){0===d.children().length&&d.append(a(b.get(c.gridId+"menuTemplate.html"))(c))}}}};return c}]),q.directive("ngGrid",["$compile","$filter","$templateCache","$sortService","$domUtilityService","$utilityService","$timeout","$parse","$http","$q",function(a,c,d,e,f,g,h,i,j,k){var l={scope:!0,compile:function(){return{pre:function(l,m,n){var o=b(m),p=l.$eval(n.ngGrid);p.gridDim=new v({outerHeight:b(o).height(),outerWidth:b(o).width()});var q=new z(l,p,e,f,c,d,g,h,i,j,k);return l.$on("$destroy",function(){p.gridDim=null,p.selectRow=null,p.selectItem=null,p.selectAll=null,p.selectVisible=null,p.groupBy=null,p.sortBy=null,p.gridId=null,p.ngGrid=null,p.$gridScope=null,p.$gridServices=null,l.domAccessProvider.grid=null,angular.element(q.styleSheet).remove(),q.styleSheet=null}),q.init().then(function(){if("string"==typeof p.columnDefs?l.$on("$destroy",l.$parent.$watch(p.columnDefs,function(a){return a?(q.lateBoundColumns=!1,l.columns=[],q.config.columnDefs=a,q.buildColumns(),q.eventProvider.assignEvents(),void f.RebuildGrid(l,q)):(q.refreshDomSizes(),void q.buildColumns())},!0)):q.buildColumns(),"string"==typeof p.totalServerItems?l.$on("$destroy",l.$parent.$watch(p.totalServerItems,function(a){l.totalServerItems=angular.isDefined(a)?a:0})):l.totalServerItems=0,"string"==typeof p.data){var c=function(a){q.data=b.extend([],a),q.rowFactory.fixRowCache(),angular.forEach(q.data,function(a,b){var c=q.rowMap[b]||b;q.rowCache[c]&&q.rowCache[c].ensureEntity(a),q.rowMap[c]=b}),q.searchProvider.evalFilter(),q.configureColumnWidths(),q.refreshDomSizes(),q.config.sortInfo.fields.length>0&&(q.sortColumnsInit(),l.$emit("ngGridEventSorted",q.config.sortInfo)),l.$emit("ngGridEventData",q.gridId)};l.$on("$destroy",l.$parent.$watch(p.data,c)),l.$on("$destroy",l.$parent.$watch(p.data+".length",function(){c(l.$eval(p.data)),l.adjustScrollTop(q.$viewport.scrollTop(),!0)}))}return q.footerController=new y(l,q),m.addClass("ngGrid").addClass(""+q.gridId),p.enableHighlighting||m.addClass("unselectable"),p.jqueryUITheme&&m.addClass("ui-widget"),m.append(a(d.get("gridTemplate.html"))(l)),f.AssignGridContainers(l,m,q),q.eventProvider=new x(q,l,f,h),p.selectRow=function(a,b){q.rowCache[a]&&(q.rowCache[a].clone&&q.rowCache[a].clone.setSelection(b?!0:!1),q.rowCache[a].setSelection(b?!0:!1))},p.selectItem=function(a,b){p.selectRow(q.rowMap[a],b)},p.selectAll=function(a){l.toggleSelectAll(a)},p.selectVisible=function(a){l.toggleSelectAll(a,!0)},p.groupBy=function(a){if(a)l.groupBy(l.columns.filter(function(b){return b.field===a})[0]);else{var c=b.extend(!0,[],l.configGroups);angular.forEach(c,l.groupBy)}},p.sortBy=function(a){var b=l.columns.filter(function(b){return b.field===a})[0];b&&b.sort()},p.gridId=q.gridId,p.ngGrid=q,p.$gridScope=l,p.$gridServices={SortService:e,DomUtilityService:f,UtilityService:g},l.$on("$destroy",l.$on("ngGridEventDigestGrid",function(){f.digest(l.$parent)})),l.$on("$destroy",l.$on("ngGridEventDigestGridParent",function(){f.digest(l.$parent)})),l.$evalAsync(function(){l.adjustScrollLeft(0)}),angular.forEach(p.plugins,function(a){"function"==typeof a&&(a=new a);var b=l.$new();a.init(b,q,p.$gridServices),p.plugins[g.getInstanceType(a)]=a,l.$on("$destroy",function(){b.$destroy()})}),"function"==typeof p.init&&p.init(q,l),null})}}}};return l}]),q.directive("ngHeaderCell",["$compile",function(a){var b={scope:!1,compile:function(){return{pre:function(b,c){c.append(a(b.col.headerCellTemplate)(b))}}}};return b}]),q.directive("ngHeaderRow",["$compile","$templateCache",function(a,b){var c={scope:!1,compile:function(){return{pre:function(c,d){0===d.children().length&&d.append(a(b.get(c.gridId+"headerRowTemplate.html"))(c))}}}};return c}]),q.directive("ngInput",[function(){return{require:"ngModel",link:function(a,b,c,d){function e(c){switch(c.keyCode){case 37:case 38:case 39:case 40:c.stopPropagation();break;case 27:a.$$phase||a.$apply(function(){d.$setViewValue(h),b.blur()});break;case 13:(a.enableCellEditOnFocus&&a.totalFilteredItemsLength()-1>a.row.rowIndex&&a.row.rowIndex>0||a.col.enableCellEdit)&&b.blur()}return!0}function f(a){a.stopPropagation()}function g(a){a.stopPropagation()}var h,i=a.$watch("ngModel",function(){h=d.$modelValue,i()});b.bind("keydown",e),b.bind("click",f),b.bind("mousedown",g),b.on("$destroy",function(){b.off("keydown",e),b.off("click",f),b.off("mousedown",g)}),a.$on("$destroy",a.$on("ngGridEventStartCellEdit",function(){b.focus(),b.select()})),angular.element(b).bind("blur",function(){a.$emit("ngGridEventEndCellEdit")})}}}]),q.directive("ngRow",["$compile","$domUtilityService","$templateCache",function(a,b,c){var d={scope:!1,compile:function(){return{pre:function(d,e){if(d.row.elm=e,d.row.clone&&(d.row.clone.elm=e),d.row.isAggRow){var f=c.get(d.gridId+"aggregateTemplate.html");f=d.row.aggLabelFilter?f.replace(k,"| "+d.row.aggLabelFilter):f.replace(k,""),e.append(a(f)(d))}else e.append(a(c.get(d.gridId+"rowTemplate.html"))(d));d.$on("$destroy",d.$on("ngGridEventDigestRow",function(){b.digest(d)}))}}}};return d}]),q.directive("ngViewport",[function(){return function(a,b){function c(b){var c=b.target.scrollLeft,d=b.target.scrollTop;return a.$headerContainer&&a.$headerContainer.scrollLeft(c),a.adjustScrollLeft(c),a.adjustScrollTop(d),a.forceSyncScrolling?i():(clearTimeout(g),g=setTimeout(i,150)),f=c,h=d,e=!1,!0}function d(){return e=!0,b.focus&&b.focus(),!0}var e,f,g,h=0,i=function(){a.$root.$$phase||a.$digest()};b.bind("scroll",c),b.bind("mousewheel DOMMouseScroll",d),b.on("$destroy",function(){b.off("scroll",c),b.off("mousewheel DOMMouseScroll",d)}),a.enableCellSelection||a.domAccessProvider.selectionHandlers(a,b)}}]),a.ngGrid.i18n.da={ngAggregateLabel:"artikler",ngGroupPanelDescription:"Grupér rækker udfra en kolonne ved at trække dens overskift hertil.",ngSearchPlaceHolder:"Søg...",ngMenuText:"Vælg kolonner:",ngShowingItemsLabel:"Viste rækker:",ngTotalItemsLabel:"Rækker totalt:",ngSelectedItemsLabel:"Valgte rækker:",ngPageSizeLabel:"Side størrelse:",ngPagerFirstTitle:"Første side",ngPagerNextTitle:"Næste side",ngPagerPrevTitle:"Forrige side",ngPagerLastTitle:"Sidste side"},a.ngGrid.i18n.de={ngAggregateLabel:"eintrag",ngGroupPanelDescription:"Ziehen Sie eine Spaltenüberschrift hierhin um nach dieser Spalte zu gruppieren.",ngSearchPlaceHolder:"Suche...",ngMenuText:"Spalten auswählen:",ngShowingItemsLabel:"Zeige Einträge:",ngTotalItemsLabel:"Einträge gesamt:",ngSelectedItemsLabel:"Ausgewählte Einträge:",ngPageSizeLabel:"Einträge pro Seite:",ngPagerFirstTitle:"Erste Seite",ngPagerNextTitle:"Nächste Seite",ngPagerPrevTitle:"Vorherige Seite",ngPagerLastTitle:"Letzte Seite"},a.ngGrid.i18n.en={ngAggregateLabel:"items",ngGroupPanelDescription:"Drag a column header here and drop it to group by that column.",ngSearchPlaceHolder:"Search...",ngMenuText:"Choose Columns:",ngShowingItemsLabel:"Showing Items:",ngTotalItemsLabel:"Total Items:",ngSelectedItemsLabel:"Selected Items:",ngPageSizeLabel:"Page Size:",ngPagerFirstTitle:"First Page",ngPagerNextTitle:"Next Page",ngPagerPrevTitle:"Previous Page",ngPagerLastTitle:"Last Page"},a.ngGrid.i18n.es={ngAggregateLabel:"Artículos",ngGroupPanelDescription:"Arrastre un encabezado de columna aquí y soltarlo para agrupar por esa columna.",ngSearchPlaceHolder:"Buscar...",ngMenuText:"Elegir columnas:",ngShowingItemsLabel:"Artículos Mostrando:",ngTotalItemsLabel:"Artículos Totales:",ngSelectedItemsLabel:"Artículos Seleccionados:",ngPageSizeLabel:"Tamaño de Página:",ngPagerFirstTitle:"Primera Página",ngPagerNextTitle:"Página Siguiente",ngPagerPrevTitle:"Página Anterior",ngPagerLastTitle:"Última Página"},a.ngGrid.i18n.fa={ngAggregateLabel:"موردها",ngGroupPanelDescription:"یک عنوان ستون اینجا را بردار و به گروهی از آن ستون بیانداز.",ngSearchPlaceHolder:"جستجو...",ngMenuText:"انتخاب ستون‌ها:",ngShowingItemsLabel:"نمایش موردها:",ngTotalItemsLabel:"همهٔ موردها:",ngSelectedItemsLabel:"موردهای انتخاب‌شده:",ngPageSizeLabel:"اندازهٔ صفحه:",ngPagerFirstTitle:"صفحهٔ اول",ngPagerNextTitle:"صفحهٔ بعد",ngPagerPrevTitle:"صفحهٔ قبل",ngPagerLastTitle:"آخرین صفحه"},a.ngGrid.i18n.fr={ngAggregateLabel:"articles",ngGroupPanelDescription:"Faites glisser un en-tête de colonne ici et déposez-le vers un groupe par cette colonne.",ngSearchPlaceHolder:"Recherche...",ngMenuText:"Choisir des colonnes:",ngShowingItemsLabel:"Articles Affichage des:",ngTotalItemsLabel:"Nombre total d'articles:",ngSelectedItemsLabel:"Éléments Articles:",ngPageSizeLabel:"Taille de page:",ngPagerFirstTitle:"Première page",ngPagerNextTitle:"Page Suivante",ngPagerPrevTitle:"Page précédente",ngPagerLastTitle:"Dernière page"},a.ngGrid.i18n.nl={ngAggregateLabel:"items",ngGroupPanelDescription:"Sleep hier een kolomkop om op te groeperen.",ngSearchPlaceHolder:"Zoeken...",ngMenuText:"Kies kolommen:",ngShowingItemsLabel:"Toon items:",ngTotalItemsLabel:"Totaal items:",ngSelectedItemsLabel:"Geselecteerde items:",ngPageSizeLabel:"Pagina grootte:, ",ngPagerFirstTitle:"Eerste pagina",ngPagerNextTitle:"Volgende pagina",ngPagerPrevTitle:"Vorige pagina",ngPagerLastTitle:"Laatste pagina"},a.ngGrid.i18n["pt-br"]={ngAggregateLabel:"itens",ngGroupPanelDescription:"Arraste e solte uma coluna aqui para agrupar por essa coluna",ngSearchPlaceHolder:"Procurar...",ngMenuText:"Selecione as colunas:",ngShowingItemsLabel:"Mostrando os Itens:",ngTotalItemsLabel:"Total de Itens:",ngSelectedItemsLabel:"Items Selecionados:",ngPageSizeLabel:"Tamanho da Página:",ngPagerFirstTitle:"Primeira Página",ngPagerNextTitle:"Próxima Página",ngPagerPrevTitle:"Página Anterior",ngPagerLastTitle:"Última Página"},a.ngGrid.i18n.ru={ngAggregateLabel:"записи",ngGroupPanelDescription:"Перетащите сюда заголовок колонки для группировки по этой колонке.",ngSearchPlaceHolder:"Искать...",ngMenuText:"Выберите столбцы:",ngShowingItemsLabel:"Показаны записи:",ngTotalItemsLabel:"Всего записей:",ngSelectedItemsLabel:"Выбранные записи:",ngPageSizeLabel:"Строк на странице:",ngPagerFirstTitle:"Первая страница",ngPagerNextTitle:"Следующая страница",ngPagerPrevTitle:"Предыдущая страница",ngPagerLastTitle:"Последняя страница"},a.ngGrid.i18n["zh-cn"]={ngAggregateLabel:"条目",ngGroupPanelDescription:"拖曳表头到此处以进行分组",ngSearchPlaceHolder:"搜索...",ngMenuText:"数据分组与选择列：",ngShowingItemsLabel:"当前显示条目：",ngTotalItemsLabel:"条目总数：",ngSelectedItemsLabel:"选中条目：",ngPageSizeLabel:"每页显示数：",ngPagerFirstTitle:"回到首页",ngPagerNextTitle:"下一页",ngPagerPrevTitle:"上一页",ngPagerLastTitle:"前往尾页"},a.ngGrid.i18n["zh-tw"]={ngAggregateLabel:"筆",ngGroupPanelDescription:"拖拉表頭到此處以進行分組",ngSearchPlaceHolder:"搜尋...",ngMenuText:"選擇欄位：",ngShowingItemsLabel:"目前顯示筆數：",ngTotalItemsLabel:"總筆數：",ngSelectedItemsLabel:"選取筆數：",ngPageSizeLabel:"每頁顯示：",ngPagerFirstTitle:"第一頁",ngPagerNextTitle:"下一頁",ngPagerPrevTitle:"上一頁",ngPagerLastTitle:"最後頁"},angular.module("ngGrid").run(["$templateCache",function(a){a.put("aggregateTemplate.html",'<div ng-click="row.toggleExpand()" ng-style="rowStyle(row)" class="ngAggregate">\r\n    <span class="ngAggregateText">{{row.label CUSTOM_FILTERS}} ({{row.totalChildren()}} {{AggItemsLabel}})</span>\r\n    <div class="{{row.aggClass()}}"></div>\r\n</div>\r\n'),a.put("cellEditTemplate.html",'<div ng-cell-has-focus ng-dblclick="CELL_EDITABLE_CONDITION && editCell()">\r\n	<div ng-edit-cell-if="!(isFocused && CELL_EDITABLE_CONDITION)">	\r\n		DISPLAY_CELL_TEMPLATE\r\n	</div>\r\n	<div ng-edit-cell-if="isFocused && CELL_EDITABLE_CONDITION">\r\n		EDITABLE_CELL_TEMPLATE\r\n	</div>\r\n</div>\r\n'),a.put("cellTemplate.html",'<div class="ngCellText" ng-class="col.colIndex()"><span ng-cell-text>{{COL_FIELD CUSTOM_FILTERS}}</span></div>'),a.put("checkboxCellTemplate.html",'<div class="ngSelectionCell"><input tabindex="-1" class="ngSelectionCheckbox" type="checkbox" ng-checked="row.selected" /></div>'),a.put("checkboxHeaderTemplate.html",'<input class="ngSelectionHeader" type="checkbox" ng-show="multiSelect" ng-model="allSelected" ng-change="toggleSelectAll(allSelected, true)"/>'),a.put("editableCellTemplate.html",'<input ng-class="\'colt\' + col.index" ng-input="COL_FIELD" ng-model="COL_FIELD" />'),a.put("footerTemplate.html",'<div ng-show="showFooter" class="ngFooterPanel" ng-class="{\'ui-widget-content\': jqueryUITheme, \'ui-corner-bottom\': jqueryUITheme}" ng-style="footerStyle()">\r\n    <div class="ngTotalSelectContainer" >\r\n        <div class="ngFooterTotalItems" ng-class="{\'ngNoMultiSelect\': !multiSelect}" >\r\n            <span class="ngLabel">{{i18n.ngTotalItemsLabel}} {{maxRows()}}</span><span ng-show="filterText.length > 0" class="ngLabel">({{i18n.ngShowingItemsLabel}} {{totalFilteredItemsLength()}})</span>\r\n        </div>\r\n        <div class="ngFooterSelectedItems" ng-show="multiSelect">\r\n            <span class="ngLabel">{{i18n.ngSelectedItemsLabel}} {{selectedItems.length}}</span>\r\n        </div>\r\n    </div>\r\n    <div class="ngPagerContainer" style="float: right; margin-top: 10px;" ng-show="enablePaging" ng-class="{\'ngNoMultiSelect\': !multiSelect}">\r\n        <div style="float:left; margin-right: 10px;" class="ngRowCountPicker">\r\n            <span style="float: left; margin-top: 3px;" class="ngLabel">{{i18n.ngPageSizeLabel}}</span>\r\n            <select style="float: left;height: 27px; width: 100px" ng-model="pagingOptions.pageSize" >\r\n                <option ng-repeat="size in pagingOptions.pageSizes">{{size}}</option>\r\n            </select>\r\n        </div>\r\n        <div style="float:left; margin-right: 10px; line-height:25px;" class="ngPagerControl" style="float: left; min-width: 135px;">\r\n            <button type="button" class="ngPagerButton" ng-click="pageToFirst()" ng-disabled="cantPageBackward()" title="{{i18n.ngPagerFirstTitle}}"><div class="ngPagerFirstTriangle"><div class="ngPagerFirstBar"></div></div></button>\r\n            <button type="button" class="ngPagerButton" ng-click="pageBackward()" ng-disabled="cantPageBackward()" title="{{i18n.ngPagerPrevTitle}}"><div class="ngPagerFirstTriangle ngPagerPrevTriangle"></div></button>\r\n            <input class="ngPagerCurrent" min="1" max="{{currentMaxPages}}" type="number" style="width:50px; height: 24px; margin-top: 1px; padding: 0 4px;" ng-model="pagingOptions.currentPage"/>\r\n            <span class="ngGridMaxPagesNumber" ng-show="maxPages() > 0">/ {{maxPages()}}</span>\r\n            <button type="button" class="ngPagerButton" ng-click="pageForward()" ng-disabled="cantPageForward()" title="{{i18n.ngPagerNextTitle}}"><div class="ngPagerLastTriangle ngPagerNextTriangle"></div></button>\r\n            <button type="button" class="ngPagerButton" ng-click="pageToLast()" ng-disabled="cantPageToLast()" title="{{i18n.ngPagerLastTitle}}"><div class="ngPagerLastTriangle"><div class="ngPagerLastBar"></div></div></button>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),a.put("gridTemplate.html",'<div class="ngTopPanel" ng-class="{\'ui-widget-header\':jqueryUITheme, \'ui-corner-top\': jqueryUITheme}" ng-style="topPanelStyle()">\r\n    <div class="ngGroupPanel" ng-show="showGroupPanel()" ng-style="groupPanelStyle()">\r\n        <div class="ngGroupPanelDescription" ng-show="configGroups.length == 0">{{i18n.ngGroupPanelDescription}}</div>\r\n        <ul ng-show="configGroups.length > 0" class="ngGroupList">\r\n            <li class="ngGroupItem" ng-repeat="group in configGroups">\r\n                <span class="ngGroupElement">\r\n                    <span class="ngGroupName">{{group.displayName}}\r\n                        <span ng-click="removeGroup($index)" class="ngRemoveGroup">x</span>\r\n                    </span>\r\n                    <span ng-hide="$last" class="ngGroupArrow"></span>\r\n                </span>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="ngHeaderContainer" ng-style="headerStyle()">\r\n        <div ng-header-row class="ngHeaderScroller" ng-style="headerScrollerStyle()"></div>\r\n    </div>\r\n    <div ng-grid-menu></div>\r\n</div>\r\n<div class="ngViewport" unselectable="on" ng-viewport ng-class="{\'ui-widget-content\': jqueryUITheme}" ng-style="viewportStyle()">\r\n    <div class="ngCanvas" ng-style="canvasStyle()">\r\n        <div ng-style="rowStyle(row)" ng-repeat="row in renderedRows" ng-click="row.toggleSelected($event)" ng-class="row.alternatingRowClass()" ng-row></div>\r\n    </div>\r\n</div>\r\n<div ng-grid-footer></div>\r\n'),a.put("headerCellTemplate.html",'<div class="ngHeaderSortColumn {{col.headerClass}}" ng-style="{\'cursor\': col.cursor}" ng-class="{ \'ngSorted\': !col.noSortVisible() }">\r\n    <div ng-click="col.sort($event)" ng-class="\'colt\' + col.index" class="ngHeaderText">{{col.displayName}}</div>\r\n    <div class="ngSortButtonDown" ng-click="col.sort($event)" ng-show="col.showSortButtonDown()"></div>\r\n    <div class="ngSortButtonUp" ng-click="col.sort($event)" ng-show="col.showSortButtonUp()"></div>\r\n    <div class="ngSortPriority">{{col.sortPriority}}</div>\r\n    <div ng-class="{ ngPinnedIcon: col.pinned, ngUnPinnedIcon: !col.pinned }" ng-click="togglePin(col)" ng-show="col.pinnable"></div>\r\n</div>\r\n<div ng-show="col.resizable" class="ngHeaderGrip" ng-click="col.gripClick($event)" ng-mousedown="col.gripOnMouseDown($event)"></div>\r\n'),a.put("headerRowTemplate.html",'<div ng-style="{ height: col.headerRowHeight }" ng-repeat="col in renderedColumns" ng-class="col.colIndex()" class="ngHeaderCell">\r\n	<div class="ngVerticalBar" ng-style="{height: col.headerRowHeight}" ng-class="{ ngVerticalBarVisible: !$last }">&nbsp;</div>\r\n	<div ng-header-cell></div>\r\n</div>'),a.put("menuTemplate.html",'<div ng-show="showColumnMenu || showFilter"  class="ngHeaderButton" ng-click="toggleShowMenu()">\r\n    <div class="ngHeaderButtonArrow"></div>\r\n</div>\r\n<div ng-show="showMenu" class="ngColMenu">\r\n    <div ng-show="showFilter">\r\n        <input placeholder="{{i18n.ngSearchPlaceHolder}}" type="text" ng-model="filterText"/>\r\n    </div>\r\n    <div ng-show="showColumnMenu">\r\n        <span class="ngMenuText">{{i18n.ngMenuText}}</span>\r\n        <ul class="ngColList">\r\n            <li class="ngColListItem" ng-repeat="col in columns | ngColumns">\r\n                <label><input ng-disabled="col.pinned" type="checkbox" class="ngColListCheckbox" ng-model="col.visible"/>{{col.displayName}}</label>\r\n				<a title="Group By" ng-class="col.groupedByClass()" ng-show="col.groupable && col.visible" ng-click="groupBy(col)"></a>\r\n				<span class="ngGroupingNumber" ng-show="col.groupIndex > 0">{{col.groupIndex}}</span>          \r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>'),a.put("rowTemplate.html",'<div ng-style="{ \'cursor\': row.cursor }" ng-repeat="col in renderedColumns" ng-class="col.colIndex()" class="ngCell {{col.cellClass}}">\r\n	<div class="ngVerticalBar" ng-style="{height: rowHeight}" ng-class="{ ngVerticalBarVisible: !$last }">&nbsp;</div>\r\n	<div ng-cell></div>\r\n</div>')
}])}(window,jQuery),angular.module("features",[]),angular.module("kyc.controllers",[]),angular.module("kyc.resources",[]),angular.module("kyc.charts",[]),angular.module("kyc.services",[]),angular.module("kyc.directives",[]),angular.module("kyc.reports",[]),angular.module("kyc",["ngRoute","ngResource","ngSanitize","kyc.directives","kyc.resources","kyc.services","kyc.charts","kyc.controllers","kyc.resources","kyc.filters","kyc.reports","loaders","notification","mm.foundation","ui.select2"]).run(["$rootScope","ACCOUNT_ID","$http",function(a,b,c){a.requests=0,c.get("/api/accounts/"+b+"/features").then(function(a){var b=!1;a&&a.data&&angular.forEach(a.data,function(a){4!==a.featureId||"INSTALLED"!==a.status&&"TRIAL"!==a.status&&"UNINSTALLED"!==a.status||(b=!0)}),b||window.location.replace("/shop#/feature/4")})}]).config(["$routeProvider",function(a){a.when("/dashboard",{templateUrl:"/code/kyc/partials/dashboard.php",controller:"DashboardCtrl",resolve:{load:["$route","AllCharts","$AjaxInterceptor",function(a,b,c){return c.start(),b.promise}]}}),a.when("/stock",{templateUrl:"/code/kyc/partials/stock.php",controller:"StockCtrl",resolve:{load:["$route","OrderService","$AjaxInterceptor",function(a,b,c){return c.start(),b.load()}]}}),a.when("/customers",{templateUrl:"/code/kyc/partials/customers.php",controller:"CustomersCtrl",resolve:{load:["$route","OrderService","$AjaxInterceptor",function(a,b,c){return c.start(),b.load()}]}}),a.when("/reports",{templateUrl:"/code/kyc/partials/reports.php",controller:"ReportsCtrl",resolve:{load:["$route","AllReports","$AjaxInterceptor",function(a,b,c){return c.start(),b.init()}]}}),a.when("/stream",{templateUrl:"/code/kyc/partials/stream.php",controller:"StreamCtrl",resolve:{load:["$route","OrderService","$AjaxInterceptor",function(a,b,c){return c.start(),b.load()}]}}),a.otherwise({redirectTo:"/dashboard"})}]),angular.module("notification",["ngSanitize"]).controller("confirmModalController",["$scope","$modalInstance","data","deffered","$http","$templateCache","$compile","$sce","$timeout",function(a,b,c,d,e,f,g,h,i){var j="/code/notification/templates/";if(a.title=c.title||"",c.hasOwnProperty("templateFullUrl")&&c.templateFullUrl)angular.extend(a,c.scope);else if(c.hasOwnProperty("templateUrl")&&c.templateUrl){a.templateUrl=c.templateUrl;var k=function(b){var d=a.$new();angular.extend(d,c.scope),i(function(){angular.element("#contentPartial").html(g(b)(d))})},l=f.get(j+c.templateUrl);l?k(l):e.get(j+c.templateUrl).then(function(a){f.put(j+c.templateUrl,a.data),k(a.data)})}else a.content=c.content||"";c.hasOwnProperty("scope")&&c.scope&&(a=angular.extend(a,c.scope)),a.toTrusted=function(a){return h.trustAsHtml(a||"")},a.showTerm=c.showTerm||!1,a.acceptTerm=!1,a.btnOk=c.btnOk===!1?!1:c.btnOk||_tr("OK"),c.btnCancel===!1?c.btnCancel=!1:a.btnCancel=c.btnCancel||_tr("CANCEL"),a.changeTerm=function(b){a.acceptTerm=b},a.send=function(){b.close(),d.resolve({acceptTerm:a.acceptTerm})},a.cancel=function(){b.close(),d.reject({acceptTerm:a.acceptTerm})}}]).service("$notification",["$modal","$q","$sce",function(a,b){var c="/code/notification/templates/",d=function(d){var e=b.defer();d=d||{},d.hasOwnProperty("templateFullUrl")&&d.templateFullUrl&&(d.templateFullUrl=c+d.templateFullUrl);var f=a.open({templateUrl:d.templateFullUrl||"/code/notification/notification.php",windowClass:"modal-preoday "+(d.windowClass||""),controller:"confirmModalController",resolve:{data:function(){return d},deffered:function(){return e}}});return f.opened.then(function(){setTimeout(function(){var a=0;$(".notificationButtons button").each(function(){a=a>$(this).width()?a:$(this).width()}).width(a),$(".modal-preoday").addClass("active")},400)}),e.promise};return{confirm:d}}]),angular.module("kyc.services",[]).service("$chartService",["ChartType","$filter","TickInterval",function(a,b,c){var d=function(a){return{options:{chart:{type:"areaspline",height:"250"},exporting:{enabled:!1},plotOptions:{line:{marker:{enabled:!1}},areaspline:{lineWidth:0,fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#523E8A"],[1,"#1AA1DB"]]},marker:{enabled:!1}}}},credits:{enabled:!1},title:{text:""},xAxis:{type:"datetime",minTickInterval:864e5,labels:{enabled:!1}},yAxis:{gridLineWidth:0,minorGridLineWidth:0,title:{text:""},labels:{enabled:!1}},series:[{showInLegend:!1,enableMouseTracking:!1,name:"",data:a.data}]}},e=function(a){var d=a.data.length;return{options:{chart:{type:"areaspline",height:"250"},exporting:{enabled:!1},plotOptions:{line:{marker:{enabled:!1}},series:{marker:{fillColor:"#126FB2",lineColor:"#126FB2",lineWidth:2}},areaspline:{color:"#E7F1F7",lineColor:"#126FB2",lineWidth:3,marker:{fillColor:"#126FB2",enabled:d>1?!1:!0}}},tooltip:{borderWidth:0,backgroundColor:"transparent",shadow:!1,useHTML:!0,positioner:function(a,b,c){var d=a/2;return d-=this.chart.plotLeft,{x:c.plotX-d,y:c.plotY-b}},formatter:function(){var d;d=this.series.xAxis.tickInterval===c.MONTH?b("date")(new Date(this.x),"MMM yyyy"):this.series.xAxis.tickInterval===c.WEEK||this.series.xAxis.tickInterval===c.WEEK_THREE?moment.utc(this.x).startOf("week").format("DD MMM YYYY")+" <br /> - <br />"+moment.utc(this.x).endOf("week").format("DD MMM YYYY"):b("date")(new Date(this.x),"dd MMM yyyy");var e='<div style="position:relative;"><div style="background-color: #1576B7; border-radius: 5px; color:#fff;font-family:\'Co Text W01 Light\'; text-align:center; padding:18px 8px;">'+d,f=1==this.y&&"s"===a.tooltipText[a.tooltipText.length-1].toLowerCase()?a.tooltipText.slice(0,-1):a.tooltipText;return e+="<b style=\"color:#fff;font-size:160%;font-weight:bold;font-family:'Co Text W01 Bold';text-align:center;display:block;margin-top:8px;\">",e+=a.currency?f+""+this.y.toFixed(2)+"</b></div>":this.y+""+f+"</b></div>",e+='<span style="position: absolute; left: 42%; bottom: -8px; background:url(/img/arrowBlue.png) left top no-repeat; width: 15px; height: 8px; display: block;" "></span></div>'}}},credits:{enabled:!1},title:{text:""},xAxis:{type:"datetime",tickInterval:a.tickInterval,min:a.minTimestamp,max:a.maxTimestamp,labels:{style:{color:"#b3b6b8",fontSize:"15px"},formatter:function(){var a;return a=this.axis.tickInterval===c.MONTH?b("date")(new Date(moment.utc(this.value).startOf("month")),"MMM"):this.axis.tickInterval===c.WEEK||this.axis.tickInterval===c.WEEK_THREE?b("date")(new Date(moment.utc(this.value).startOf("week").add("days",3)),"dd.MMM"):b("date")(new Date(this.value),"dd.MMM")}}},yAxis:{gridLineWidth:1,gridLineColor:"#C0C0C0",gridLineDashStyle:"dot",minorGridLineWidth:0,title:{text:""},labels:{style:{color:"#b3b6b8",fontSize:"15px"}},min:0,minRange:1},series:[{showInLegend:!1,name:"",data:a.data,marker:{symbol:"url(/img/marker.png)"}}]}},f=function(a){return{options:{chart:{type:"pie",height:"250",events:{load:function(){setTimeout(function(){$(".highcharts-legend-item rect").attr("rx","20").attr("ry","20").attr("width","16").attr("height","16").css({cursor:"pointer"})},100)}}},tooltip:{hideDelay:0,borderWidth:0,backgroundColor:"#DBDBD9",shadow:!1,useHTML:!0,positioner:function(a,b,c){return{x:c.plotX-a/2+10,y:c.plotY-b-5}},formatter:function(){return'<div style="position:relative;"><div class="tooltipPie" style="font-size: 14px; font-weight: 600; padding: 5px 7px">'+Highcharts.numberFormat(this.y,this.y%1===0?0:1)+'</div> <span style="position: absolute; left: 33%; bottom: -15px; background:url(/img/arrowPie.png) left top no-repeat; width: 15px; height: 9px; display: block;" "></span> </div>'}},exporting:{enabled:!1},plotOptions:{pie:{center:["20%","55%"],borderWidth:0}},legend:{width:50,enabled:!0,layout:"vertical",verticalAlign:"middle",align:"center",borderWidth:0,itemMarginTop:5,itemMarginBottom:5,itemStyle:{width:210,lineHeight:20,fontSize:13},useHTML:!1,labelFormatter:function(){var a="font-family:Co Text W01 Light;";return a+="color:#46545d;",'<div style="'+a+'">'+this.name+"</div>"}}},title:{text:""},yAxis:{title:{text:""}},series:[{data:a.data,size:"80%",innerSize:"65%",showInLegend:!0,dataLabels:{enabled:!1}}]}},g=function(a){return{options:{chart:{height:"250",type:"column"},exporting:{enabled:!1},plotOptions:{column:{borderRadius:5},series:{borderWidth:0,dataLabels:{enabled:!1,format:"{point.y:.1f}"}}},tooltip:{hideDelay:.1,crosshairs:!1,shared:!0,followPointer:!0,borderWidth:0,backgroundColor:"#DBDBD9",shadow:!1,useHTML:!0,positioner:function(a,b,c){return{x:c.plotX-a/2+10,y:c.plotY-b-5}},formatter:function(){return'<div style="position:relative;"><div class="tooltipPie" style="font-size: 14px; font-weight: 600; padding: 5px 7px">'+Highcharts.numberFormat(this.y,this.y%1===0?0:1)+'</div> <span style="position: absolute; left: 33%; bottom: -15px; background:url(/img/arrowPie.png) left top no-repeat; width: 15px; height: 9px; display: block;" "></span> </div>'}}},title:{text:""},xAxis:{type:"category",lineWidth:0,tickWidth:0},yAxis:{gridLineWidth:0,minorGridLineWidth:0,title:{text:""},labels:{enabled:!1}},series:[{pointWidth:200,name:"Customers",showInLegend:!1,colorByPoint:!1,color:{linearGradient:{x1:1,y1:1,x2:0,y2:1},stops:[[0,"#523E8A"],[1,"#1AA1DB"]]},data:a.data}]}},h=function(b,c){switch(b){case a.AREA:return d(c);case a.AREA_MODAL:return e(c);case a.PIE:return f(c);case a.COLUMN:return g(c)}};return{area:d,areaModal:e,pie:f,column:g,getChart:h}}]),angular.module("kyc.services").service("$grid",["ChartType",function(a){var b=function(b){var c=[],d=1,e=8,f=1,g=1,h=window.sessionStorage.getItem("widgets");return h&&(h=angular.fromJson(h)),angular.forEach(b,function(b){var i={};i.display=!0,i.title=b.title,i.num=d,b.type===a.NUMBER?(i.showChart=!1,i.size_x=2,i.size_y=1,i.value=b.data,i.currency=b.currency):(i.showChart=!0,i.size_x=4,i.size_y=2,i.value=b,i.currency=b.currency),h&&(i.order=h[d].order,i.display=h[d].display),i.row=g,i.col=f,f+i.size_x>e?(f=1,++g):f+=i.size_x,++d,c.push(i)}),h&&c.sort(function(a,b){return a.order<b.order?-1:a.order>b.order?1:0}),c};return{populateItems:b}}]),angular.module("loaders",[]).service("$AjaxInterceptor",["$rootScope","$timeout",function(a,b){function c(){var a=document.getElementsByClassName(".loading-content");if(a.length>0){(new Spinner).spin(a[0])}}return{start:function(){++a.requests,c()},complete:function(){b(function(){a.requests>0&&--a.requests},100)},isRequesting:function(){return a.requests>0}}}]),angular.module("kyc.services").service("OutletService",["ACCOUNT_ID","VENUE_ID","Outlet",function(a,b,c){var d=[];this.init=function(e){d=c.query({accountId:a,venueId:b},function(a){e(a)})},this.getOutlets=function(){return d},this.getOutletName=function(a){var b=!1;return angular.forEach(d,function(c){c.id==a&&(b=c.name)}),b}}]),angular.module("kyc.services").factory("pusher",["PUSHER_KEY",function(a){Pusher.log=function(a){window.console&&window.console.log&&window.console.log(a)};var b,c;return{bind:function(a,d,e){d.length>0?angular.forEach(d,function(a){c=b.subscribe("preoday.order.outlet."+a),c.bind("update",e)}):(c=b.subscribe("preoday.order.venue."+a),c.bind("update",e))},reset:function(){if(b){var c=b.allChannels();angular.forEach(c,function(a){a.unbind(),b.unsubscribe(a.name)})}else b=new Pusher(a)},bindConnection:function(a,c){b.connection.bind(a,c)}}}]),angular.module("kyc.services").service("OrderService",["ACCOUNT_ID","Order","INITIAL_DATES","VENUE_ID",function(a,b,c,d){function e(){return i}function f(a){return void 0===a||a.valueOf()>moment.utc().subtract("year",2).valueOf()?moment.utc().subtract("year",2).valueOf():a.startOf("day").valueOf()}function g(c,e,g){return c=f(c),g&&g.length&&(g=g.join(",")),e=moment.utc().valueOf(),b.query({accountId:a,venueId:d,maxPaid:e,minPaid:c,outletIds:g},function(a){i=a}).$promise}function h(c,e){return e&&e.length&&(e=e.join(",")),b.query({accountId:a,since:c,venueId:d,outletIds:e,orderBy:"updated"},function(a){i=a}).$promise}var i;return{load:g,loadSince:h,getOrders:e}}]),angular.module("kyc.services").service("VenueService",["ACCOUNT_ID","Venue","$q",function(a,b,c){function d(){{var d=c.defer();new b.query({accountId:a},function(a){a&&a.length>0&&(f=a[0]),d.resolve(f)})}return d.promise}function e(){return f?g[f.ccy]:g.GBP}var f,g={GBP:{symbol:"%C2%A3",name:"Pound Sterling",symbol_native:"£",decimal_digits:2,rounding:0,code:"GBP",name_plural:"British pounds sterling"},EUR:{symbol:"%E2%82%AC",name:"Euro",symbol_native:"€",decimal_digits:2,rounding:0,code:"EUR",name_plural:"euros"},USD:{symbol:"$",name:"US Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"USD",name_plural:"US dollars"}};return{getCurrency:e,init:d}}]),angular.module("kyc.services").service("UtilsService",[function(){var a=[],b=function(a,b,c){var d=0,e={},f=Object.keys(a);f.length<c&&(c=f.length);for(var d=b;c>d;d++){var g=f[d];e[g]=a[g]}return e},c=function(b){a=b},d=function(){return a},e=function(a){for(var b=$(a).children().find(".flip-container"),c={},d=b.length-1;d>=0;d--){var e=$(b[d]),f=b.index(e),g=e.scope();c[g.value.num]={order:f,display:g.value.display},g.value.order=f}window.sessionStorage.setItem("widgets",angular.toJson(c))},f=function(a,b){var c=1;return b&&(c=-1),function(b,d){var e=b[a]<d[a]?-1:b[a]>d[a]?1:0;return e*c}},g=function(a,b,c){var d=1;c&&(d=-1);var e=[];return angular.forEach(a,function(a){e.push(a)}),e.sort(function(a,c){var e=a[b]<c[b]?-1:a[b]>c[b]?1:0;return e*d}),e},h=function(a,b){for(var c=b.map(function(a){return a.id}),d=a.length-1;d>=0;d--){var e=a[d],f=c.indexOf(e.id);-1!==f&&(b.splice(f,1),c.splice(f,1))}return a.concat(b)};return{sliceObject:b,reOrderWidgets:e,dynamicSort:f,dynamicSortObject:g,mergeArraysUnique:h,setItems:c,getItems:d}}]),angular.module("kyc.controllers").controller("DashboardCtrl",["$scope","$http","$compile","ChartType","$grid","AllCharts","$AjaxInterceptor","$timeout","$notification","UtilsService",function(a,b,c,d,e,f,g,h,i,j){function k(){a.values=e.populateItems(l),h(function(){var a="1"===window.sessionStorage.getItem("firsttime_feature_4");a&&(window.sessionStorage.setItem("firsttime_feature_4",0),i.confirm({title:_tr("Welcome to Know Your Customer"),content:_tr("From here you can view detailed reports and analytics about your customers and the transactions they make."),showTerm:!1,btnOk:!1,btnCancel:_tr("GET STARTED"),windowClass:"medium"})),$(window).trigger("resize"),angular.element("#sscontainer").trigger("ss-rearrange"),g.complete()},1e3)}a.setLocation("dashboard"),a.$parent.showDateFilter=!0;var l=f.getPreparedCharts();a.$on("KYC_RELOAD",function(){l=f.getPreparedCharts(),a.values=e.populateItems(l),k()}),a.changeVisibility=function(a){a.display?(angular.element("#removable_"+a.num).closest(".flip-container").parent().show(),j.reOrderWidgets(angular.element("#sscontainer"))):setTimeout(function(){angular.element("#removable_"+a.num).triggerHandler("click")},0),angular.element("#sscontainer").trigger("ss-rearrange")},a.shapeshifterConfig={gutterX:20,gutterY:20,paddingX:0,paddingY:0,minColumns:2},k()}]),angular.module("kyc.controllers").controller("CustomersCtrl",["$scope","OrderService","$AjaxInterceptor","Export","ACCOUNT_ID","UtilsService",function(a,b,c,d,e,f){function g(){var b=[[a.getExportDate()],[j]];return angular.forEach(a.customers,function(c){("1"===a.exportAll||c.selected===!0)&&b.push([c.name,c.totalSpent.toFixed(2),c.emailAddress,c.loyalty,c.offers,c.other])}),{data:b}}function h(){var b={Name:[],"Total Spent":[],"Email Address":[],Loyalty:[],Offers:[],Other:[]};return angular.forEach(a.customers,function(c){("1"===a.exportAll||c.selected===!0)&&(console.log("exporting",c),b.Name.push(c.name),b["Total Spent"].push(c.totalSpent.toFixed(2)),b["Email Address"].push(c.emailAddress),b.Loyalty.push(c.loyalty),b.Offers.push(c.offers),b.Other.push(c.other))}),{title:"Customers",startDate:a.form.start_date.valueOf(),endDate:a.form.end_date.valueOf(),dataJson:JSON.stringify(b)}}function i(){if(a.customers={},k){var b=moment.utc(a.$parent.form.start_date),d=moment.utc(a.$parent.form.end_date);angular.forEach(k,function(c){var e=moment.utc(c.paid);if((0===a.$parent.getSelectedOutlets().length||a.$parent.findOutlet(c.outletId).length>=1)&&e>=b&&d>=e){var f=c.userId;void 0===a.customers[f]?a.customers[f]={name:c.user.firstName+" "+c.user.lastName,totalSpent:Number(c.total.toFixed(2)),emailAddress:c.user.username,loyalty:c.user.optinLoyalty,offers:c.user.optinOffers,other:c.user.optinOther}:a.customers[f].totalSpent=Number((a.customers[f].totalSpent+c.total).toFixed(2))}})}a.customers=f.dynamicSortObject(a.customers,a.orderBy,a.direction),a.customersList=a.customers,a.totalItems=Object.keys(a.customers).length,a.numPerPage=20,a.currentPage=1,a.setOrderBy("totalSpent",!0),c.complete()}a.setLocation("customers"),a.$parent.showDateFilter=!0;var j=_tr("Customers"),k=b.getOrders();a.exportAll="1",a.$on("KYC_RELOAD",function(){k=b.getOrders(),i()}),a.selectAll=function(){angular.forEach(a.customers,function(b){b.selected=a.all_options})},a.exportPdf=function(){a.pdfData=h()},a.exportCsv=function(){a.csvData=g()},a.setOrderBy=function(b,c){console.log("parent setting order by",b,c),a.direction=void 0!==c?c:!a.direction,a.customers=f.dynamicSortObject(a.customers,b,a.direction),l()};var l=function(){var b=(a.currentPage-1)*a.numPerPage,c=b+a.numPerPage;a.customersList=a.customers.slice(b,c)};i(),a.$watch("currentPage + numPerPage",function(){l()}),a.showOptions=function(){angular.element(".flip-container").addClass("active"),setTimeout(function(){$(".invisibleBack").addClass("visible")},200)},a.hideOptions=function(){angular.element(".flip-container").removeClass("active"),setTimeout(function(){$(".invisibleBack").removeClass("visible")},200)}}]),angular.module("kyc.controllers").controller("ReportsCtrl",["$scope","$AjaxInterceptor","OrderService","Export","ACCOUNT_ID","AllReports","UtilsService","$filter",function(a,b,c,d,e,f,g,h){function i(){a.reports=f.getReportsList(),a.selectReport(a.reports[0]),a.selectedReport&&a.selectedReport.data?(a.reportsList=a.selectedReport.data,a.totalItems=Object.keys(a.selectedReport.data).length):(a.reportsList=[],a.totalItems=0),a.selectedReport.data=g.dynamicSortObject(a.selectedReport.data,a.orderBy,a.direction),a.numPerPage=20,a.currentPage=1,b.complete(),m=!0}function j(){var b={};return angular.forEach(a.selectedReport.data,function(c){("1"===a.exportAll||c.$selected===!0)&&angular.forEach(c,function(c,d){if("$"!==d[0]){var e=a.getTitle(d);void 0===b[e]&&(b[e]=[]),b[e].push(l(c,d))}})}),console.log("returning:",{title:a.selectedReport.title,startDate:a.form.start_date.valueOf(),endDate:a.form.end_date.valueOf(),dataJson:angular.toJson(b)}),{title:a.selectedReport.title,startDate:a.$parent.form.start_date.valueOf(),endDate:a.$parent.form.end_date.valueOf(),dataJson:angular.toJson(b)}}function k(){var b=[[a.getExportDate()],[a.selectedReport.title],a.selectedReport.titles];return angular.forEach(a.selectedReport.data,function(c){if("1"===a.exportAll||c.$selected===!0){var d=[];angular.forEach(c,function(a,b){"$"!==b[0]&&d.push(l(a,b))}),b.push(d)}}),{data:b}}function l(a,b){switch(b){case"day":case"lastOrder":case"dateJoined":case"dateOfOrder":case"date":return h("date")(a,"dd/MM/yyyy");case"valueSold":case"totalSpent":case"percentDecrease":case"percentIncrease":return a.toFixed(2);default:return a}}_tr("Reports");a.setLocation("reports"),a.exportAll="1",a.direction=!0;var m=!1;a.selectAll=function(){for(var b=a.selectedReport.data.length;b--;)a.selectedReport.data[b].$selected=a.all_options},a.isMarketingTitle=function(a){var b="loyalty"===a||"offers"===a||"other"===a;return b?a:b},a.$watch("currentPage + numPerPage",function(){n()});var n=function(){var b=(a.currentPage-1)*a.numPerPage,c=b+a.numPerPage;a.selectedReport&&a.selectedReport.data&&(a.reportsList=a.selectedReport.data.slice(b,c))};a.setOrderBy=function(b,c){a.direction=void 0!==c?c:!a.direction,console.log("set order by",b,a.direction),a.orderBy=b,a.selectedReport.data=g.dynamicSortObject(a.selectedReport.data,b,a.direction),n()},a.selectReport=function(b){if(b)var c=b;else{var c=a.reports.filter(function(a){return a.selected===!0});c.length&&(c=c[0])}a.selectedReport={data:c.getData(),title:c.getTitle(),titles:c.getTitles(),description:c.description},a.totalItems=Object.keys(a.selectedReport.data).length,a.reportsList=g.sliceObject(a.selectedReport.data,0,a.numPerPage),a.currentPage=1,a.direction=void 0!==c.direction?c.direction:a.direction;var d=void 0!==c.orderBy?c.orderBy:a.selectedReport.titles[0];a.setOrderBy(d)},a.getTitle=function(a){return f.getTitle(a)},a.exportPdf=function(){a.pdfData=j()},a.exportCsv=function(){a.csvData=k()},a.showOptions=function(){angular.element(".flip-container").addClass("active"),setTimeout(function(){$(".invisibleBack").addClass("visible")},200)},a.hideOptions=function(){angular.element(".flip-container").removeClass("active"),setTimeout(function(){$(".invisibleBack").removeClass("visible")},200)},m||i()}]),angular.module("kyc.controllers").controller("StockCtrl",["$scope","$AjaxInterceptor","OrderService","Export","ACCOUNT_ID","UtilsService",function(a,b,c,d,e,f){function g(){var b=[[a.getExportDate()],[j]];return angular.forEach(a.stock,function(c){("1"===a.exportAll||c.selected===!0)&&b.push([c.name,c.quantity])}),{data:b}}function h(){var b={Item:[],"Quantity Ordered":[]};return angular.forEach(a.stock,function(c){("1"===a.exportAll||c.selected===!0)&&(b.Item.push(c.name),b["Quantity Ordered"].push(c.quantity))}),{title:"Stock",startDate:a.form.start_date.valueOf(),endDate:a.form.end_date.valueOf(),dataJson:JSON.stringify(b)}}function i(){if(a.stock={},k){var c=a.$parent.form.start_date,d=a.$parent.form.end_date;angular.forEach(k,function(b){var e=moment.utc(b.paid);(0===a.$parent.getSelectedOutlets().length||a.$parent.findOutlet(b.outletId).length>=1)&&e>=c&&d>=e&&angular.forEach(b.items,function(b){var c=b.menuItemId;void 0===a.stock[c]?a.stock[c]={name:b.name,quantity:b.qty}:a.stock[c].quantity+=b.qty})})}a.stock=f.dynamicSortObject(a.stock,a.orderBy,a.direction),a.stocks=a.stock,a.totalItems=Object.keys(a.stock).length,a.currentPage=1,a.setOrderBy("quantity",!0),b.complete()}var j=_tr("Stock");a.setLocation("stock"),a.$parent.showDateFilter=!0,a.exportAll="1",a.numPerPage=20,a.$on("KYC_RELOAD",function(){k=c.getOrders(),i()});var k=c.getOrders();a.selectAll=function(){angular.forEach(a.stock,function(b){b.selected=a.all_options})},a.exportPdf=function(){a.pdfData=h()},a.exportCsv=function(){a.csvData=g()},a.setOrderBy=function(b,c){void 0!==c&&(a.direction=c),a.stock=f.dynamicSortObject(a.stock,b,a.direction),l()};var l=function(){var b=(a.currentPage-1)*a.numPerPage,c=b+a.numPerPage;a.stocks=a.stock.slice(b,c)};a.$watch("currentPage + numPerPage",function(){l()}),i(),a.setPage=function(b){a.currentPage=b},a.showOptions=function(){angular.element(".flip-container").addClass("active"),setTimeout(function(){$(".invisibleBack").addClass("visible")},200)},a.hideOptions=function(){angular.element(".flip-container").removeClass("active"),setTimeout(function(){$(".invisibleBack").removeClass("visible")},100)}}]),angular.module("kyc.controllers").controller("StreamCtrl",["$scope","OrderService","pusher","$AjaxInterceptor","$interval","VENUE_ID","UtilsService",function(a,b,c,d,e,f,g){a.$parent.showDateFilter=!1,a.setLocation("stream"),a.orders=b.getOrders();var h=moment().valueOf();a.orders.$promise.then(function(){a.orders=a.orders.sort(g.dynamicSort("updated",!0)),a.orders.length&&(h=moment(a.orders[0].updated).valueOf())});var i=!1,j=0,k=function(){++j,i||(i=!0,j=0,b.loadSince(h,n).then(function(b){b.length&&(h=moment(b[0].updated).valueOf(),a.orders=g.mergeArraysUnique(b,angular.copy(a.orders))),i=!1,j&&k()}))};a.$on("KYC_RELOAD",function(){o(),d.complete()});var l=f,m=null,n=[],o=function(){n=[],c.reset(),m=a.getSelectedOutlets(),angular.forEach(m,function(a){n.push(a.id)}),c.bind(l,n,k)};o(),a.getStatusName=function(a){var b={PAYMENT_FAILED:"FAILED",NOSHOW:"NO SHOW"};return b[a]?b[a]:a},a.getStatusColor=function(a){switch(a){case"PENDING":case"ACCEPTED":case"PREPARING":case"READY":case"DELIVERING":case"COMPLETED":return"good";case"NOSHOW":case"REJECTED":case"CANCELLED":case"PAYMENT_FAILED":default:return"bad"}},a.outletFilter=function(a){return n&&0===n.length||-1!==n.indexOf(a.outletId)},a.showOptions=function(){angular.element(".flip-container").addClass("active")},a.hideOptions=function(){angular.element(".flip-container").removeClass("active")},a.activeStream=function(b){var c=a.orders.filter(function(a){return a.active===!0});c&&c[0]&&c[0].code!=b.code&&(c[0].active=!1),b.active=!b.active},a.getOrderItems=function(a){var b=[];return angular.forEach(a.items,function(a){b.push(a.qty+" x "+a.name)}),b},d.complete()}]),angular.module("kyc.controllers").controller("MenuCtrl",["$scope","OutletService","OrderService","AllCharts","$route","VenueService","$AjaxInterceptor","$location","INITIAL_DATES","UtilsService","Venue","VENUE_ID",function(a,b,c,d,e,f,g,h,i,j,k,l){a.currencySymbol="%C2%A3",a.outlets=[],a.form={start_date:moment.utc(i.start).startOf("day"),end_date:moment.utc(i.end).endOf("day")},a.getCurrency=function(){return decodeURI(a.currencySymbol)},k.getItems({id:l}).$promise.then(function(a){j.setItems(a)}),f.init().then(function(c){a.venue=c,a.currencySymbol=f.getCurrency().symbol,b.init(function(){a.outlets=b.getOutlets(),d.init(a.form.start_date,a.form.end_date,a.currencySymbol)})}),a.update=function(){g.start(),setTimeout(function(){d.reloadCharts(a.form.start_date,a.form.end_date,a.currencySymbol,a.getSelectedOutlets()).then(function(){a.$broadcast("KYC_RELOAD")})},500)},a.setLocation=function(b){a.currentLocation=b,h.path()!=="/"+b&&h.path(b)},a.getSelectedOutlets=function(){return a.outlets.filter(function(a){return a.selected===!0})},a.findOutlet=function(b){return a.outlets.filter(function(a){return a.selected===!0&&a.id===b})},a.getExportDate=function(){return a.form.start_date.format("DD-MMM-YYYY")+" - "+a.form.end_date.format("DD-MMM-YYYY")}}]),angular.module("kyc.resources").factory("Export",["$resource",function(a){var b=a("/api/accounts/:accountId/exports/pdf",{accountId:"@accountId"},{table:{method:"POST",url:"/api/accounts/:accountId/exports/pdf/table"},chart:{method:"POST",url:"/api/accounts/:accountId/exports/pdf/table"}}),c=a("/api/accounts/:accountId/exports/csv",{accountId:"@accountId"},{}),d=a("/api/accounts/:accountId/exports/table/pdf",{accountId:"@accountId"},{});return{Pdf:b,Csv:c,TablePdf:d}}]),angular.module("kyc.resources").factory("Outlet",["$resource",function(a){var b=a("/api/outlets",{},{});return b}]),angular.module("kyc.resources").factory("Order",["$resource",function(a){var b=a("/api/orders",{},{});return b}]),angular.module("kyc.resources").factory("Venue",["$resource",function(a){var b=a("/api/venues/:id",{},{query:{method:"GET",isArray:!0},getItems:{method:"GET",url:"/api/venues/:id/items",isArray:!0}});return b}]),angular.module("kyc.resources").factory("VenueCustomers",["$resource",function(a){var b=a("/api/venues/:id/customers",{id:"@id"},{});return b}]),angular.module("kyc.resources").factory("Report",["$resource",function(a){var b=a("/api/reports/:venueId",{venueId:"@venueId"},{items:{method:"GET",isArray:!0,url:"/api/reports/:venueId/items"},orders:{method:"GET",isArray:!0,url:"/api/reports/:venueId/orders"},customerOrders:{method:"GET",isArray:!0,url:"/api/reports/:venueId/customerOrders"}});return b}]),angular.module("kyc").constant("ChartType",{NUMBER:"NUMBER",COLUMN:"COLUMN",PIE:"PIE",AREA:"AREA",AREA_MODAL:"AREA_MODAL"}),angular.module("kyc").constant("Colors",["#18a4dd","#1576b7","#543b87","#392654","#f5b23e","#8bbf4f","#c0392b","#46545d","#b4b6b8","#dcdddf"]),angular.module("kyc").constant("TickInterval",{DAY:864e5,WEEK:6048e5,WEEK_THREE:18144e5,MONTH:2592e6}),angular.module("kyc.directives").directive("chart",["$modal","ChartType","$chartService","Export","ACCOUNT_ID","UtilsService","ChartHelper","$timeout",function(a,b,c,d,e,f,g,h){return{templateUrl:"/code/kyc/js/directives/chart/chart.php",restrict:"E",replace:!0,scope:{chart:"=element"},link:function(d,i){function j(){if(d.chart.showChart)switch(d.chart.value.type){case b.PIE:case b.COLUMN:if(0===d.chart.value.data.length)d.noData=!0;else{var a=!0;angular.forEach(d.chart.value.data,function(b){b.y>0&&(a=!1)}),d.noData=a}break;case b.AREA:d.chart.value.data.length<1&&(d.noData=!0)}else(0===d.chart.value||"NaN"===d.chart.value||0/0==d.chart.value)&&(d.noData=!0)}function k(){if(d.chart.value.modal){var b=Math.max(document.documentElement.clientWidth,window.innerWidth||0),f=b>1300?"large":"xlarge",i=a.open({templateUrl:modal_url("chart"),windowClass:f+" modal-preoday modal-chart",controller:["$scope",function(a){if(a.optionHasData=function(a){return a.data.length>1?1:0},a.noData=!1,a.displayChart=!1,a.ACCOUNT_ID=e,a.chart=angular.copy(d.chart),d.chart.value.modal.highcharts){var b=d.chart.value.modal.options[0];d.chart.value.tickInterval=b.tickInterval,d.chart.value.minTimestamp=moment.utc(b.minTimestamp).valueOf(),d.chart.value.maxTimestamp=moment.utc(b.maxTimestamp).valueOf();var f=angular.copy(d.chart.value);f.data=b.data,a.selectedData=f,a.chart.highcharts=c.getChart(d.chart.value.modal.highcharts.type,f),h(function(){a.chart.highcharts.options.chart.width=$("#highchartsContent").width()-20,a.displayChart=!0},100)}a.exportPdf=function(){var b=d.chart.value.getPdf();b.startDate=a.selectedData.minTimestamp,b.endDate=a.selectedData.maxTimestamp,b.dataJson=JSON.stringify(a.selectedData.data),a.pdfData=b},a.exportCsv=function(){var b=a.selectedData.data,c=[[moment.utc(a.selectedData.minTimestamp).format("DD-MMM-YYYY")+" - "+moment.utc(a.selectedData.maxTimestamp).format("DD-MMM-YYYY")],["Revenue"]];angular.forEach(b,function(a){c.push([g.formatDate(a[0]),a[1]])}),a.csvData={data:c}},a.showOptions=function(){$(".modal-chart .flip-container").addClass("active"),setTimeout(function(){$(".modal-chart .invisibleBack").addClass("visible")},200)},a.hideOptions=function(){$(".modal-chart .flip-container").removeClass("active"),setTimeout(function(){$(".modal-chart .invisibleBack").removeClass("visible")},200)},a.cancel=function(){i.close()},a.title=d.chart.title,a.selectOption=function(b){a.noData=!1;var e=a.chart.value.modal.options.filter(function(a){return 1==a.active});e&&(e[0].active=!1),b.active=!0,a.selectedData=angular.copy(b),a.selectedData.minTimestamp=moment.utc(b.minTimestamp).valueOf(),a.selectedData.maxTimestamp=moment.utc(b.maxTimestamp).valueOf(),a.chart.highcharts=c.getChart(d.chart.value.modal.highcharts.type,{tooltipText:d.chart.value.tooltipText,data:b.data,tickInterval:b.tickInterval,minTimestamp:moment.utc(b.minTimestamp).valueOf(),maxTimestamp:moment.utc(b.maxTimestamp).valueOf()})},a.setNoData=function(b){a.noData=!0;var c=a.chart.value.modal.options.filter(function(a){return 1==a.active});c&&(c[0].active=!1),b.active=!0}}]});i.opened.then(function(){setTimeout(function(){$(".modal-preoday").addClass("active")},1)})}}function l(){var a=c.getChart(d.chart.value.type,d.chart.value);d.chart.value.items&&(a.options.chart.height=205,i.parent().addClass("highchartsItem")),d.chart.value.type===b.AREA&&(a.options.chart.events={click:k}),d.chart.highcharts=a}d.chart.display||i.parent().hide(),d.ACCOUNT_ID=e,d.noData=!1,j(),d.ChartType=b;var m=(i.find(".actions-chart"),i.find(".chart"),i.closest(".flip-container"));l(),d.showOptions=function(){m.addClass("active"),setTimeout(function(){i.find(".invisibleBack").addClass("visible")},200)},d.hideOptions=function(){m.removeClass("active"),setTimeout(function(){i.find(".invisibleBack").removeClass("visible")},100)},d.removeGrid=function(a){a.display=!1,i.parent().hide(),f.reOrderWidgets(i.closest(".sscontainer"))},d.changeItem=function(){d.selectedItem=d.chart.value.items[d.chart.value.selectedItem],d.chart.value.selectItem(d.selectedItem.id,function(a){d.chart.value=a,l()})},d.exportPdf=function(){d.pdfData=d.chart.value.getPdf()},d.exportCsv=function(){d.csvData=d.chart.value.getCsv()},d.getText=function(a){if("object"==typeof a.value)var b=a.value.numberLeft;else var b=a.value.toLocaleString();
return a.currency?decodeURI(a.currency)+b:b}}}}]),angular.module("kyc.directives").factory("highchartsNGUtils",function(){return{indexOf:function(a,b,c){void 0===c&&(c=0),0>c&&(c+=a.length),0>c&&(c=0);for(var d=a.length;d>c;c++)if(c in a&&a[c]===b)return c;return-1},prependMethod:function(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);return c.apply(this,a),d?d.apply(this,a):void 0}},deepExtend:function a(b,c){if(angular.isArray(c)){b=angular.isArray(b)?b:[];for(var d=0;d<c.length;d++)b[d]=a(b[d]||{},c[d])}else if(angular.isObject(c))for(var e in c)b[e]=a(b[e]||{},c[e]);else b=c;return b}}}).directive("highchart",["highchartsNGUtils",function(a){var b=0,c=function(a){var c=!1;return angular.forEach(a,function(a){angular.isDefined(a.id)||(a.id="series-"+b++,c=!0)}),c},d=["xAxis","yAxis"],e=function(b,c,e){var f={},g={chart:{events:{}},title:{},subtitle:{},series:[],credits:{},plotOptions:{},navigator:{enabled:!1}};return f=e.options?a.deepExtend(g,e.options):g,f.chart.renderTo=c[0],angular.forEach(d,function(c){angular.isDefined(e[c])&&(f[c]=angular.copy(e[c]),(angular.isDefined(e[c].currentMin)||angular.isDefined(e[c].currentMax))&&(a.prependMethod(f.chart.events,"selection",function(a){var d=this;b.$apply(a[c]?function(){b.config[c].currentMin=a[c][0].min,b.config[c].currentMax=a[c][0].max}:function(){b.config[c].currentMin=d[c][0].dataMin,b.config[c].currentMax=d[c][0].dataMax})}),a.prependMethod(f.chart.events,"addSeries",function(){b.config[c].currentMin=this[c][0].min||b.config[c].currentMin,b.config[c].currentMax=this[c][0].max||b.config[c].currentMax})))}),e.title&&(f.title=e.title),e.subtitle&&(f.subtitle=e.subtitle),e.credits&&(f.credits=e.credits),e.size&&(e.size.width&&(f.chart.width=e.size.width),e.size.height&&(f.chart.height=e.size.height)),f},f=function(a,b){var c=a.getExtremes();(b.currentMin!==c.dataMin||b.currentMax!==c.dataMax)&&a.setExtremes(b.currentMin,b.currentMax,!1)},g=function(a,b,c){(b.currentMin||b.currentMax)&&a[c][0].setExtremes(b.currentMin,b.currentMax,!0)},h=function(a){return angular.extend({},a,{data:null,visible:null})};return{restrict:"EAC",replace:!0,template:"<div></div>",scope:{config:"="},link:function(b,i){var j={},k=function(d){var e,f=[];if(d){var g=c(d);if(g)return!1;if(angular.forEach(d,function(a){f.push(a.id);var b=l.get(a.id);b?angular.equals(j[a.id],h(a))?(void 0!==a.visible&&b.visible!==a.visible&&b.setVisible(a.visible,!1),b.setData(angular.copy(a.data),!1)):b.update(angular.copy(a),!1):l.addSeries(angular.copy(a),!1),j[a.id]=h(a)}),b.config.noData){var i=!1;for(e=0;e<d.length;e++)if(d[e].data&&d[e].data.length>0){i=!0;break}i?l.hideLoading():l.showLoading(b.config.noData)}}for(e=l.series.length-1;e>=0;e--){var k=l.series[e];a.indexOf(f,k.options.id)<0&&k.remove(!1)}return!0},l=!1,m=function(){l&&l.destroy(),j={};var a=b.config||{},c=e(b,i,a);l=a.useHighStocks?new Highcharts.StockChart(c):new Highcharts.Chart(c);for(var f=0;f<d.length;f++)a[d[f]]&&g(l,a[d[f]],d[f]);a.loading&&l.showLoading()};m(),b.$watch("config.series",function(a){var b=k(a);b&&l.redraw()},!0),b.$watch("config.title",function(a){l.setTitle(a,!0)},!0),b.$watch("config.subtitle",function(a){l.setTitle(!0,a)},!0),b.$watch("config.loading",function(a){a?l.showLoading():l.hideLoading()}),b.$watch("config.credits.enabled",function(a){a?l.credits.show():l.credits&&l.credits.hide()}),b.$watch("config.useHighStocks",function(a,b){a!==b&&m()}),angular.forEach(d,function(a){b.$watch("config."+a,function(b,c){b!==c&&b&&(l[a][0].update(b,!1),f(l[a][0],angular.copy(b)),l.redraw())},!0)}),b.$watch("config.options",function(a,b,c){a!==b&&(m(),k(c.config.series),l.redraw())},!0),b.$watch("config.size",function(a,b){a!==b&&a&&l.setSize(a.width||void 0,a.height||void 0)},!0),b.$on("highchartsng.reflow",function(){l.reflow()}),b.$on("$destroy",function(){l&&l.destroy(),i.remove()})}}}]),angular.module("kyc.directives").directive("datepicker",["$parse","$filter",function(){return{restrict:"A",require:"ngModel",scope:{compareStart:"=start",compareEnd:"=end"},link:function(a,b,c,d){b.fdatepicker({format:"dd/mm/yyyy",onRender:function(b){if(a.compareStart){var c=b.valueOf()<a.compareStart.valueOf()||b.valueOf()>=moment.utc().endOf("day").valueOf();return c?"disabled":""}if(a.compareEnd){var d=b.valueOf()>moment.utc(a.compareEnd).endOf("day").valueOf();return d?"disabled":""}}}).on("changeDate",function(c){a.$apply(function(){d.$setViewValue(c.date),b.fdatepicker("setDate",c.date)})}),d.$parsers.push(function(a){var b;if("string"==typeof a){var d=a.split("/");b=moment.utc([d[2],+d[1]-1,+d[0]])}else b=moment.utc(a);return void 0!==c.start?b.endOf("day"):b.startOf("day")}),d.$formatters.push(function(a){return a.format("DD/MM/YYYY")})}}}]),angular.module("kyc.directives").directive("multiSelect",["$sce","$filter",function(a){return{restrict:"AE",replace:!0,scope:{inputModel:"=",outputModel:"=",buttonLabel:"@",selectionMode:"@",itemLabel:"@",tickProperty:"@",disableProperty:"@",orientation:"@",defaultLabel:"@",maxLabels:"@",isDisabled:"=",directiveId:"@",helperElements:"@",onOpen:"&",onClose:"&",onBlur:"&",onFocus:"&",onChange:"&"},templateUrl:directive_url("multiselect/multiselect.htm"),link:function(b,c,d){b.selectedItems=[],b.backUp=[],b.varButtonLabel="",b.currentButton=null,b.scrolled=!1,b.displayHelper=function(a){if("undefined"==typeof d.helperElements)return!0;switch(a.toUpperCase()){case"ALL":if(d.selectionMode&&"SINGLE"===b.selectionMode.toUpperCase())return!1;if(d.helperElements&&b.helperElements.toUpperCase().indexOf("ALL")>=0)return!0;break;case"NONE":if(d.selectionMode&&"SINGLE"===b.selectionMode.toUpperCase())return!1;if(d.helperElements&&b.helperElements.toUpperCase().indexOf("NONE")>=0)return!0;break;case"RESET":if(d.helperElements&&b.helperElements.toUpperCase().indexOf("RESET")>=0)return!0;break;case"FILTER":if(d.helperElements&&b.helperElements.toUpperCase().indexOf("FILTER")>=0)return!0}},b.syncItems=function(a,c){var e=b.inputModel.indexOf(a);if(b.inputModel[e][b.tickProperty]=!b.inputModel[e][b.tickProperty],d.selectionMode&&"SINGLE"===b.selectionMode.toUpperCase()){b.inputModel[e][b.tickProperty]=!0;for(var f=0;f<b.inputModel.length;f++)f!==e&&(b.inputModel[f][b.tickProperty]=!1);b.toggleCheckboxes(c)}b.refreshSelectedItems(),b.onChange()},b.refreshSelectedItems=function(){b.varButtonLabel="",b.selectedItems=[];var a=0;if(angular.forEach(b.inputModel,function(a){"undefined"!=typeof a&&(a[b.tickProperty]===!0||"true"===a[b.tickProperty])&&b.selectedItems.push(a)}),"undefined"!=typeof d.outputModel&&(b.outputModel=angular.copy(b.selectedItems)),0===b.selectedItems.length)b.varButtonLabel=b.defaultLabel?b.defaultLabel:"None selected";else{var c=b.selectedItems.length;"undefined"!=typeof b.maxLabels&&""!==b.maxLabels&&(c=b.maxLabels),b.more=b.selectedItems.length>c?!0:!1,angular.forEach(b.selectedItems,function(d){"undefined"!=typeof d&&(c>a&&(b.varButtonLabel+=(b.varButtonLabel.length>0?", ":"")+b.writeLabel(d,"buttonLabel")),a++)}),b.more===!0&&(c>0&&(b.varButtonLabel+=", ... "),b.varButtonLabel+="(Total: "+b.selectedItems.length+")")}},b.itemIsDisabled=function(a){return a[b.disableProperty]===!0?!0:b.isDisabled===!0?!0:!1},b.writeLabel=function(c,d){var e="",f=b[d].split(" ");return angular.forEach(f,function(a){"undefined"!=typeof a&&angular.forEach(c,function(b,c){c==a&&(e+=" "+b)})}),a.trustAsHtml(e)},b.toggleCheckboxes=function(a){a.target&&("BUTTON"!==a.target.tagName.toUpperCase()&&a.target.className.indexOf("multiSelectButton")<0?d.selectionMode&&"SINGLE"===b.selectionMode.toUpperCase()?"INPUT"===a.target.tagName.toUpperCase()&&(a=b.findUpTag(a.target,"div","checkboxLayer"),a=a.previousSibling.previousSibling):a=b.findUpTag(a.target,"button","multiSelectButton"):a=a.target),b.labelFilter="";for(var c=-1,e=document.querySelectorAll(".checkboxLayer"),f=document.querySelectorAll(".multiSelectButton"),g=0;g<f.length;g++)if(a===f[g]){c=g;break}if(c>-1){for(var g=0;g<e.length;g++)g!=c&&(e[g].className="multiSelect checkboxLayer hide");"multiSelect checkboxLayer hide"==e[c].className?(b.currentButton=f[c],e[c].className="multiSelect checkboxLayer dropdown pdDropdown show",b.onOpen()):"multiSelect checkboxLayer dropdown pdDropdown show"==e[c].className&&(e[c].className="multiSelect checkboxLayer hide",b.onClose())}},b.findUpTag=function(a,b,c){for(;a.parentNode;)if(a=a.parentNode,"undefined"!=typeof a.tagName&&a.tagName.toUpperCase()===b.toUpperCase()&&a.className.indexOf(c)>-1)return a;return null},b.select=function(a){switch(a.toUpperCase()){case"ALL":angular.forEach(b.inputModel,function(a){"undefined"!=typeof a&&a[b.disableProperty]!==!0&&(a[b.tickProperty]=!0)});break;case"NONE":angular.forEach(b.inputModel,function(a){"undefined"!=typeof a&&a[b.disableProperty]!==!0&&(a[b.tickProperty]=!1)});break;case"RESET":b.inputModel=angular.copy(b.backUp)}b.refreshSelectedItems()};var e=function(){"inputModel"in d||console.log("Multi-select error: input-model is not defined! (ID: "+b.directiveId+")"),"buttonLabel"in d||console.log("Multi-select error: button-label is not defined! (ID: "+b.directiveId+")"),"itemLabel"in d||console.log("Multi-select error: item-label is not defined! (ID: "+b.directiveId+")"),"tickProperty"in d||console.log("Multi-select error: tick-property is not defined! (ID: "+b.directiveId+")")},f=function(a,b){var c=!1;angular.forEach(a,function(a){if("undefined"!=typeof a){var d=!0;angular.forEach(b,function(b){if("undefined"!=typeof b&&d&&!(a in b)){c=!0,d=!1}})}})};e(),b.refreshSelectedItems(),b.$watch("inputModel",function(){"undefined"!==b.newVal&&(f(b.itemLabel.split(" "),b.inputModel),f(new Array(b.tickProperty),b.inputModel)),b.refreshSelectedItems()},!0),b.$watch("inputModel",function(){"undefined"!==b.newVal&&(f(b.itemLabel.split(" "),b.inputModel),f(new Array(b.tickProperty),b.inputModel)),b.backUp=angular.copy(b.inputModel),b.refreshSelectedItems()}),b.$watch("isDisabled",function(a){b.isDisabled=a}),angular.element(document).bind("touchstart",function(){b.$apply(function(){b.scrolled=!1})}),angular.element(document).bind("touchmove",function(){b.$apply(function(){b.scrolled=!0})}),angular.element(document).bind("click touchend",function(a){if("click"===a.type||"touchend"===a.type&&b.scrolled===!1){var c=document.querySelectorAll(".checkboxLayer");if(void 0===a.target.className.indexOf||a.target.className.indexOf("multiSelect")){for(var d=0;d<c.length;d++)c[d].className="multiSelect checkboxLayer hide";a.stopPropagation()}}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;c>b;){if(this[b]===a)return b;++b}return-1})}}}]),angular.module("kyc.directives").directive("shapeshift",["UtilsService","$timeout",function(a,b){return{restrict:"A",link:function(c,d,e){b(function(){var b=$(d).shapeshift(c.$eval(e.shapeshift));b.on("ss-rearranged",function(){a.reOrderWidgets(d)})})}}}]),angular.module("kyc.directives").directive("marketing",["MarketingResources",function(a){return{restrict:"A",replace:"true",templateUrl:"/code/kyc/js/directives/marketing/header.php",scope:{chart:"=element"},link:function(b,c,d){var e=c[0].tagName.toLowerCase();b.which=d.marketing,b.marketing=a[b.which],"th"===e&&(b.setOrderBy=function(a){b.$parent.setOrderBy(a)})}}}]),angular.module("kyc.charts").factory("AllCharts",["$q","OrderService","UtilsService","Venue","VENUE_ID","PayingCustomers","OrdersPerCustomer","AverageOrderValue","ItemsOrdered","OrdersByOutlet","MostPopularItems","TimeOfOrdersPlaced","CustomersPie","CustomersBar","Revenue","NumberOfOrders","MenuItemPopularity","AverageOrderValueArea",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(a,c,d,e){x=d,b.load(a,c).then(function(b){v(b,a,c,e)})}function t(f,g,h,i){var j=a.defer();x=h;var k=[];return i.length&&(k=i.map(function(a){return a.id})),d.getItems({id:e,outletIds:k.join(",")}).$promise.then(function(a){c.setItems(a)}),b.load(f,g,k).then(function(a){v(a,f,g,i),j.resolve(z)}),j.promise}function u(a,b){var c=!1;return angular.forEach(a,function(a){c||a.id!=b||(c=a)}),c}function v(a,b,c,d){b=moment.utc(b),c=moment.utc(c),d||(d=[]),angular.forEach(z,function(a){a.clearData()}),angular.forEach(a,function(a){(0===d.length||u(d,a.outletId))&&angular.forEach(z,function(d){d.setData(a,b,c)})}),angular.forEach(z,function(a){a.onSetDataComplete&&a.onSetDataComplete(b,c,x)}),y.resolve(z)}function w(){var a=[];return angular.forEach(z,function(b){a.push(b.getHighChart?b.getHighChart():b)}),a}var x,y=a.defer(),z={payingCustomers:f,ordersPerCustomer:g,averageOrderValue:h,itemsOrdered:i,revenue:o,numberOfOrders:p,mostPopularItems:k,menuItemPopularity:q,averageOrderValueArea:r,customersBar:n,timeOfOrdersPlaced:l,ordersByOutlet:j};return{init:s,promise:y.promise,getPreparedCharts:w,prepareCharts:v,reloadCharts:t}}]),angular.module("kyc.charts").factory("ChartHelper",["$filter","TickInterval",function(a,b){function c(b){var c=new Date(b);return a("date")(c,"dd-MMM-yyyy")}function d(a,b){var c=e(a),d=e(b),f=100*c/d;return 1/0===f?"":f.toFixed(2)}function e(a){var b=0;return angular.forEach(a,function(a){b+=a[1]}),b.toFixed(0)}function f(a,b,c,d){d=d?d:!1;var e=moment.utc(b-(c-b)),f=moment.utc().startOf("day").subtract("week",1),g=moment.utc().subtract("week",2),j=moment.utc().subtract("month",1),n=moment.utc().subtract("month",2),o=moment.utc().subtract("month",3),p=moment.utc().subtract("month",6),q=moment.utc().subtract("month",6),r=moment.utc().subtract("month",12),s=moment.utc().subtract("year",1),t=moment.utc().subtract("year",2),u=[],v=[],w=[],x=[],y=[],z=[],A=[],B=[],C=[],D=[],E=[],F=[],G=0,H=[],I=h({maxTimestamp:c,minTimestamp:b}),J=null;switch(I){case"day":J=m.day;break;case"week":J=m.week;break;case"month":J=m.month}return angular.forEach(a,function(a,d){var h=Number(d),i=[Number(d),Number(a.toFixed(2))];h>=b&&c>=h?(J(v,i),u.push(i),G+=a):b>h&&h>=e&&w.push(i),h>=f&&m.day(x,i),h>=g&&f>h&&y.push(i),h>=j&&m.day(z,i),h>=n&&j>h&&A.push(i),h>=o&&m.week(B,i),h>=p&&o>h&&C.push(i),h>=q&&m.week(D,i),h>=r&&q>h&&E.push(i),h>=s&&m.month(H,i),h>=t&&s>h&&F.push(i)}),u.sort(k),v.sort(k),x.sort(k),y.sort(k),z.sort(k),A.sort(k),B.sort(k),C.sort(k),D.sort(k),E.sort(k),H.sort(k),F.sort(k),d&&(G=G.toFixed(2)),{data:i({max:moment.utc(c).startOf("day"),min:moment.utc(b).startOf("day").valueOf(),value:v,dateType:h({maxTimestamp:c,minTimestamp:b}),filterData:function(a,b){switch(this.dateType){case"day":return l.day(a,b);case"week":return l.week(a,b);case"month":return l.month(a,b)}}}),dataModal:v,previousSpecifiedData:w,weekData:x,previousWeekData:y,monthData:z,previousMonthData:A,threeMonthsData:B,previousThreeMonthsData:C,sixMonthsData:D,previousSixMonthsData:E,yearData:H,previousYearData:F,total:G,minTimestamp:b,maxTimestamp:c}}function g(a){var c=moment.utc(a.maxTimestamp,"X").diff(moment.utc(a.minTimestamp,"X"),"days");switch(!0){case 32>c:return b.DAY;case 92>c:return b.WEEK;case 183>c:return b.WEEK_THREE;default:return b.MONTH}}function h(a){var b=moment.utc(a.maxTimestamp,"X").diff(moment.utc(a.minTimestamp,"X"),"days");switch(!0){case 32>b:return"day";case 183>b:return"week";default:return"month"}}function i(a){for(var b=a.max,c=a.min,d=angular.copy(a.value);;){var e=b.valueOf();if(c>e)break;var f=a.filterData(d,e);if(!f.length){var g=[e,0];d.push(g)}b=b.subtract(a.dateType,1)}return d.sort(k),d}function j(a){return[{name:_tr("Date Range"),value:e(a.data),percent:d(a.data,a.previousSpecifiedData),active:!0,data:i({max:moment.utc(a.maxTimestamp).startOf("day"),min:moment.utc(a.minTimestamp).startOf("day").valueOf(),value:a.dataModal,dateType:h(a),filterData:function(a,b){switch(this.dateType){case"day":return l.day(a,b);case"week":return l.week(a,b);case"month":return l.month(a,b)}}}),tickInterval:g(a),minTimestamp:a.minTimestamp,maxTimestamp:a.maxTimestamp},{name:_tr("Week"),value:e(a.weekData),percent:d(a.weekData,a.previousWeekData),data:i({max:moment.utc().startOf("day"),min:moment.utc().startOf("day").subtract("week",1).valueOf(),value:a.weekData,dateType:"day",filterData:l.day}),tickInterval:b.DAY,minTimestamp:moment.utc().subtract("week",1),maxTimestamp:moment.utc()},{name:_tr("Month"),value:e(a.monthData),percent:d(a.monthData,a.previousMonthData),data:i({max:moment.utc().startOf("day"),min:moment.utc().startOf("day").subtract("month",1).valueOf(),value:a.monthData,dateType:"day",filterData:l.day}),tickInterval:b.DAY,minTimestamp:moment.utc().subtract("month",1),maxTimestamp:moment.utc()},{name:_tr("3 Months"),value:e(a.threeMonthsData),percent:d(a.threeMonthsData,a.previousThreeMonthsData),data:i({max:moment.utc().startOf("day"),min:moment.utc().startOf("day").subtract("month",3).valueOf(),value:a.threeMonthsData,dateType:"week",filterData:l.week}),tickInterval:b.WEEK,minTimestamp:moment.utc().subtract("month",3),maxTimestamp:moment.utc()},{name:_tr("6 Months"),value:e(a.sixMonthsData),percent:d(a.sixMonthsData,a.previousSixMonthsData),data:i({max:moment.utc().startOf("day"),min:moment.utc().startOf("day").subtract("month",6).valueOf(),value:a.sixMonthsData,dateType:"week",filterData:l.week}),tickInterval:b.WEEK_THREE,minTimestamp:moment.utc().subtract("month",6),maxTimestamp:moment.utc()},{name:_tr("Year"),value:e(a.yearData),percent:d(a.yearData,a.previousYearData),data:i({max:moment.utc().startOf("month"),min:moment.utc().startOf("month").subtract("year",1).valueOf(),value:a.yearData,dateType:"month",filterData:l.month}),tickInterval:b.MONTH,minTimestamp:moment.utc().subtract("year",1),maxTimestamp:moment.utc()}]}function k(a,b){return a[0]-b[0]}var l={day:function(a,b){return a.filter(function(a){return moment.utc(a[0]).valueOf()===moment.utc(b).valueOf()})},week:function(a,b){return a.filter(function(a){return moment.utc(a[0]).week()===moment.utc(b).week()})},month:function(a,b){return a.filter(function(a){return moment.utc(a[0]).month()==moment.utc(b).month()})}},m={day:function(a,b){var c=l.day(a,b[0]),d=angular.copy(b);c.length?c[1]+=+d[1]:(d[0]=moment.utc(d[0]).startOf("day").valueOf(),a.push(d))},week:function(a,b){var c=l.week(a,b[0]),d=angular.copy(b);c.length?a[a.indexOf(c[0])][1]+=+d[1]:(d[0]=moment.utc(d[0]).startOf("week").valueOf(),a.push(d))},month:function(a,b){var c=l.month(a,b[0]),d=angular.copy(b);c.length?a[a.indexOf(c[0])][1]+=d[1]:(d[0]=moment.utc(d[0]).startOf("month").valueOf(),a.push(d))}};return{formatDate:c,getPercentage:d,getPeriodTotal:e,getPreparedAreaData:f,getModalOptions:j}}]),angular.module("kyc.charts").factory("PayingCustomers",["ChartType",function(a){function b(){h=[],i=[]}function c(a,b,c){var d=moment.utc(a.paid).valueOf();if(d>=b.valueOf()&&d<=c.valueOf()){var e=a.userId;-1===h.indexOf(e)?h.push(e):-1===i.indexOf(e)&&i.push(e)}}function d(){return h.length}function e(){return g}function f(){return{type:g,title:j,data:d()}}var g=a.NUMBER,h=[],i=[],j=_tr("Total Customers");return{getData:d,getType:e,setData:c,getHighChart:f,clearData:b}}]),angular.module("kyc.charts").factory("OrdersPerCustomer",["ChartType",function(a){function b(){h=[],i=[],j=0}function c(a,b,c){var d=moment.utc(a.paid);if(d>=b&&c>=d){j++;var e=a.userId;-1===h.indexOf(e)?h.push(e):-1===i.indexOf(e)&&i.push(e)}}function d(){return(j/h.length).toFixed(2)}function e(){return g}function f(){return{type:g,title:k,data:d()}}var g=a.NUMBER,h=[],i=[],j=0,k=_tr("Orders per Customer");return{getData:d,getType:e,setData:c,getHighChart:f,clearData:b}}]),angular.module("kyc.charts").factory("AverageOrderValue",["ChartType",function(a){function b(a,b,c){var d=moment.utc(a.paid);d>=b&&c>=d&&(i++,h+=a.total)}function c(){h=0,i=0}function d(){return(h/i).toFixed(2)}function e(){return g}function f(){return{type:g,title:j,data:d(),currency:"£"}}var g=a.NUMBER,h=0,i=0,j=_tr("Average Order Value");return{getData:d,getType:e,setData:b,getHighChart:f,clearData:c}}]),angular.module("kyc.charts").factory("ItemsOrdered",["ChartType",function(a){function b(a,b,c){var d=moment.utc(a.paid);d>=b&&c>=d&&angular.forEach(a.items,function(a){h+=a.qty})}function c(){return h}function d(){return g}function e(){return{type:g,title:i,data:c()}}function f(){h=0}var g=a.NUMBER,h=0,i=_tr("Items Ordered");return{getData:c,getType:d,setData:b,getHighChart:e,clearData:f}}]),angular.module("kyc.charts").factory("OrdersByOutlet",["ChartType","Colors","OutletService","ChartHelper",function(a,b,c){function d(){n=0,m={}}function e(a,b,c){p=b.valueOf(),q=c.valueOf();var d=moment.utc(a.paid);if(d>=b&&c>=d){var e=a.outletId;void 0===m[e]&&(m[e]={y:0}),m[e].y+=1}}function f(){n=0;var a=[];return angular.forEach(m,function(d,e){a.push({name:c.getOutletName(e),color:b[n],y:d.y}),n++}),a}function g(){return l}function h(){return{type:l,title:o,data:f(),getPdf:j,getCsv:i}}function i(){var a=f(),b=[[moment.utc(p).format("DD-MMM-YYYY")+" - "+moment.utc(q).format("DD-MMM-YYYY")],[o]];return angular.forEach(a,function(a){b.push([a.name,a.y])}),{data:b}}function j(){return{type:l,title:o,startDate:p,endDate:q,dataJson:JSON.stringify(f()),categories:k()}}function k(){var a=[];return angular.forEach(m,function(b,d){a.push(c.getOutletName(d))}),a}var l=a.PIE,m={},n=0,o=_tr("Orders By Outlet"),p=0,q=0;return{getData:f,getType:g,setData:e,getHighChart:h,clearData:d}}]),angular.module("kyc.charts").factory("MostPopularItems",["ChartType","Colors","ChartHelper",function(a,b){function c(){m={},q=[{y:0,color:b[0]},{y:0,color:b[1]},{y:0,color:b[2]},{y:0,color:b[3]},{y:0,color:b[4]}]}function d(a,b,c){o=b.valueOf(),p=c.valueOf();var d=moment.utc(a.paid);d>=b&&c>=d&&angular.forEach(a.items,function(a){void 0!==m[a.menuItemId]?m[a.menuItemId].quantity+=a.qty:m[a.menuItemId]={name:a.name,quantity:a.qty}})}function e(){for(var a in m)for(var b in q)if(m[a].quantity>q[b].y){for(var c=q.length-1;c>b;c--)q[c].y=q[c-1].y,q[c].name=q[c-1].name;q[b].y=m[a].quantity,q[b].name=m[a].name;break}q=_.filter(q,function(a){return void 0!==a.name})}function f(){return q}function g(){return l}function h(){return{type:l,title:n,data:f(),getPdf:j,getCsv:i}}function i(){var a=f(),b=[[moment.utc(o).format("DD-MMM-YYYY")+" - "+moment.utc(p).format("DD-MMM-YYYY")],[n]];return angular.forEach(a,function(a){b.push([a.name,a.y])}),{data:b}}function j(){return{type:l,title:n,startDate:o,endDate:p,dataJson:angular.toJson(f()),categories:k()}}function k(){var a=[];return angular.forEach(q,function(b){a.push(b.name)}),a}var l=a.PIE,m={},n=_tr("Most Popular Items"),o=0,p=0,q=[{y:0,color:b[0]},{y:0,color:b[1]},{y:0,color:b[2]},{y:0,color:b[3]},{y:0,color:b[4]}];return{getData:f,getType:g,setData:d,onSetDataComplete:e,getHighChart:h,clearData:c}}]),angular.module("kyc.charts").factory("TimeOfOrdersPlaced",["ChartType","Colors","ChartHelper",function(a,b){function c(){k=[{name:_tr("On the day"),y:0,color:b[0]},{name:_tr("In advance"),y:0,color:b[1]}],m=0}function d(a,b,c){o=b.valueOf(),p=c.valueOf();var d=moment.utc(a.paid);if(d>=b&&c>=d&&void 0!==a.paid&&void 0!==a.pickupTime){var e=moment.utc(a.paid).startOf("day").valueOf(),f=moment.utc(a.pickupTime).startOf("day").valueOf();e===f?k[0].y++:k[1].y++}}function e(){}function f(){return k}function g(){return l}function h(){return{type:l,title:n,data:f(),getPdf:j,getCsv:i}}function i(){var a=f(),b=[[moment.utc(o).format("DD-MMM-YYYY")+" - "+moment.utc(p).format("DD-MMM-YYYY")],[n]];return angular.forEach(a,function(a){b.push([a.name,a.y])}),{data:b}}function j(){return{type:l,title:n,startDate:o,endDate:p,dataJson:JSON.stringify(k),categories:[_tr("On the day"),_tr("In advance")]}}var k,l=a.PIE,m=0,n=_tr("Time of Orders Placed"),o=0,p=0;return{getData:f,getType:g,setData:d,onSetDataComplete:e,getHighChart:h,clearData:c}}]),angular.module("kyc.charts").factory("AverageOrderValueArea",["ChartType","ChartHelper",function(a,b){function c(a){var b=moment.utc(a.paid).endOf("day").valueOf();o[b]?(o[b]+=a.total,++p[b]):(o[b]=a.total,p[b]=1)}function d(a,c,d){m=d,u=a.valueOf(),v=c.valueOf(),r=b.getPreparedAreaData(o,a,c,!0),s=b.getPreparedAreaData(p,a,c,!0),t=e(r,s,a,c)}function e(a,b,c,d){var e={};return angular.forEach(a,function(a,c){if(a instanceof Array){for(var d=[],f=0,g=a.length;g>f;f++){var h=a[f],i=0,j=b[c][f][1];h[1]>0&&j>0&&(i=h[1]/j),d.push([h[0],i])}e[c]=d}else e[c]=a/b[c]}),{data:e.data,dataModal:e.dataModal,previousSpecifiedData:e.previousSpecifiedData,weekData:e.weekData,previousWeekData:e.previousWeekData,monthData:e.monthData,previousMonthData:e.previousMonthData,threeMonthsData:e.threeMonthsData,previousThreeMonthsData:e.previousThreeMonthsData,sixMonthsData:e.sixMonthsData,previousSixMonthsData:e.previousSixMonthsData,yearData:e.yearData,previousYearData:e.previousYearData,total:e.total.toFixed(2),minTimestamp:c,maxTimestamp:d}}function f(){return t.data}function g(){return n}function h(){return{type:n,title:q,data:f(),currency:m,numberLeft:t.total,modal:l(),getPdf:k,getCsv:i,tooltipText:decodeURI(m)}}function i(){var a=f(),c=[[moment.utc(u).format("DD-MMM-YYYY")+" - "+moment.utc(v).format("DD-MMM-YYYY")],[q]];return angular.forEach(a,function(a){c.push([b.formatDate(a[0]),a[1]])}),{data:c}}function j(){o={},p={},r={},s={},t={}}function k(){return{type:n,title:q,startDate:u,endDate:v,total:t.total,currency:m,percentage:b.getPercentage(t.data,t.previousSpecifiedData),dataJson:JSON.stringify(f())}}function l(){return{highcharts:{type:a.AREA_MODAL},options:b.getModalOptions(t)}}var m,n=a.AREA,o={},p={},q=_tr("Average order value (area)"),r={},s={},t={},u=0,v=0;return{getData:f,getType:g,clearData:j,setData:c,onSetDataComplete:d,getHighChart:h}}]),angular.module("kyc.charts").factory("CustomersPie",["ChartType","Colors","ChartHelper",function(a,b){function c(){k=0,m=[{name:_tr("New"),y:0,color:b[0]},{name:_tr("Returning"),y:0,color:b[1]}],n=[],o=[]}function d(a,b,c){p=b.valueOf(),q=c.valueOf();var d=moment.utc(a.paid);if(d>=b&&c>=d){var e=a.userId;-1===n.indexOf(e)?(n.push(e),m[0].y++):-1===o.indexOf(e)&&(o.push(e),m[1].y++)}}function e(){return m}function f(){return j}function g(){return{type:j,title:l,data:e(),getPdf:i,getCsv:h}}function h(){var a=e(),b=[[moment.utc(p).format("DD-MMM-YYYY")+" - "+moment.utc(q).format("DD-MMM-YYYY")],[l]];return angular.forEach(a,function(a){b.push([a.name,a.y])}),{data:b}}function i(){return{type:j,title:l,startDate:p,endDate:q,dataJson:JSON.stringify(m),categories:[m[0].name,m[1].name]}}var j=a.PIE,k=0,l=_tr("Customers (Pie)"),m=[{name:_tr("New"),y:0,color:b[0]},{name:_tr("Returning"),y:0,color:b[1]}],n=[],o=[],p=0,q=0;return{getData:e,getType:f,setData:d,getHighChart:g,clearData:c}}]),angular.module("kyc.charts").factory("CustomersBar",["ChartType","ChartHelper",function(a){function b(a,b,c){n=b.valueOf(),o=c.valueOf();var d=moment.utc(a.paid);if(d>=b&&c>=d){var e=a.userId;-1===l.indexOf(e)?(l.push(e),k[0].y++):-1===m.indexOf(e)&&(m.push(e),k[1].y++)}}function c(){k=[{name:_tr("Total"),y:0},{name:_tr("Returning"),y:0}],l=[],m=[]}function d(){return k}function e(){return i}function f(){return{type:i,title:j,data:d(),getPdf:h,getCsv:g}}function g(){var a=d(),b=[[moment.utc(n).format("DD-MMM-YYYY")+" - "+moment.utc(o).format("DD-MMM-YYYY")],[j]];return angular.forEach(a,function(a){b.push([a.name,a.y])}),{data:b}}function h(){return{type:i,title:j,startDate:n,endDate:o,dataJson:JSON.stringify([k[0].y,k[1].y]),categories:[k[0].name,k[1].name]}}var i=a.COLUMN,j=_tr("Customers (Bar)"),k=[{name:_tr("Total"),y:0},{name:_tr("Returning"),y:0}],l=[],m=[],n=0,o=0;return{getData:d,getType:e,setData:b,getHighChart:f,clearData:c}}]),angular.module("kyc.charts").factory("NumberOfOrders",["ChartType","ChartHelper",function(a,b){function c(a){var b=moment.utc(a.paid).startOf("day").valueOf();m[b]?m[b]++:m[b]=1}function d(a,c){o=a.valueOf(),p=c.valueOf(),q=b.getPreparedAreaData(m,a,c)}function e(){return q.data}function f(){return l}function g(){return{type:l,title:n,data:e(),numberLeft:q.total,numberRight:b.getPercentage(e(),q.previousSpecifiedData),modal:k(),getPdf:h,getCsv:j,tooltipText:_tr(" orders")}}function h(){return{type:l,title:n,startDate:o,endDate:p,total:q.total,currency:"",percentage:b.getPercentage(q.data,q.previousSpecifiedData),dataJson:JSON.stringify(e())}}function i(){q={},m={}}function j(){var a=e(),c=[[moment.utc(o).format("DD-MMM-YYYY")+" - "+moment.utc(p).format("DD-MMM-YYYY")],[n]];return angular.forEach(a,function(a){c.push([b.formatDate(a[0]),a[1]])}),{data:c}}function k(){return{highcharts:{type:a.AREA_MODAL},options:b.getModalOptions(q)}}var l=a.AREA,m={},n=_tr("Number of Orders"),o=0,p=0,q={};return{getData:e,getType:f,clearData:i,setData:c,onSetDataComplete:d,getHighChart:g}}]),angular.module("kyc.charts").factory("MenuItemPopularity",["ChartType","ChartHelper","UtilsService",function(a,b,c){function d(a){var b=moment.utc(a.paid).startOf("day").valueOf();angular.forEach(a.items,function(a){void 0===t[a.menuItemId]&&(u=null===u?a.menuItemId:Number(u),t[a.menuItemId]={}),void 0===t[a.menuItemId][b]&&(t[a.menuItemId][b]=0),t[a.menuItemId][b]+=a.qty})}function e(a,b){u=a,window.sessionStorage.setItem("KYC_SELECTED_ITEM",a),f(p,q),b(i())}function f(a,c){p=a,q=c,v=b.getPreparedAreaData(t[u],p,q,!1)}function g(){return v.data}function h(){return r}function i(){return{type:r,title:s,selectedItem:n(u),selectItem:e,data:g(),numberLeft:v.total,modal:o(),items:c.getItems(),getPdf:k,getCsv:j,tooltipText:_tr(" orders")}}function j(){var a=g(),c=[[p.format("DD-MMM-YYYY")+" - "+q.format("DD-MMM-YYYY")],[m(u)]];return angular.forEach(a,function(a){c.push([b.formatDate(a[0]),a[1]])}),{data:c}}function k(){return{type:r,title:s+" - "+m(u),startDate:p.valueOf(),endDate:q.valueOf(),total:v.total,percentage:b.getPercentage(v.data,v.previousSpecifiedData),dataJson:JSON.stringify(g())}}function l(){v={},w=[],t={}}function m(a){console.log("getting name for ",a,c.getItems());var b=!1;return angular.forEach(c.getItems(),function(c){c.id==a&&(b=c.name)}),b}function n(a){var b=!1;return angular.forEach(c.getItems(),function(c,d){c.id==a&&(b=d)}),b}function o(){return{highcharts:{type:a.AREA_MODAL},options:b.getModalOptions(v)}}var p,q,r=a.AREA,s=_tr("Menu Item Popularity"),t={},u=window.sessionStorage.getItem("KYC_SELECTED_ITEM"),v={},w=[];return w=c.getItems(),{getData:g,getType:h,clearData:l,setData:d,onSetDataComplete:f,getHighChart:i}}]),angular.module("kyc.charts").factory("Revenue",["ChartType","ChartHelper",function(a,b){function c(a){var b=moment.utc(a.paid).endOf("day").valueOf();n[b]?n[b]+=a.total:n[b]=a.total}function d(a,c,d){l=d,q=a.valueOf(),r=c.valueOf(),p=b.getPreparedAreaData(n,a,c,!0)}function e(){return p.data}function f(){return m}function g(){return{type:m,title:o,data:e(),currency:l,numberLeft:p.total,numberRight:b.getPercentage(p.data,p.previousSpecifiedData),modal:k(),getPdf:j,getCsv:h,tooltipText:decodeURI(l)}}function h(){var a=e(),c=[[moment.utc(q).format("DD-MMM-YYYY")+" - "+moment.utc(r).format("DD-MMM-YYYY")],[o]];return angular.forEach(a,function(a){c.push([b.formatDate(a[0]),a[1]])}),{data:c}}function i(){n={},p={}}function j(){return{type:m,title:o,startDate:q,endDate:r,total:p.total,currency:l,percentage:b.getPercentage(p.data,p.previousSpecifiedData),dataJson:JSON.stringify(e())}}function k(){return{highcharts:{type:a.AREA_MODAL},options:b.getModalOptions(p)}}var l,m=a.AREA,n={},o=_tr("Revenue"),p={},q=0,r=0;return{getData:e,getType:f,clearData:i,setData:c,onSetDataComplete:d,getHighChart:g}}]),angular.module("kyc.reports").factory("AllReports",["$q","Report","NewCustomers","ZeroOrdersCustomers","OneTimeBuyers","MostFrequentBuyers","HighestSpendingCustomers","CustomersIncreasingOrders","CustomersIncreasingSpend","CustomersDecreasingOrders","CustomersDecreasingSpend","SleepingCustomers","MostPopularItemsReport","ItemPopularityIncrease","ItemPopularityDecrease","HighestGrossingDays","LowestGrossingDays","HighestOrderDays","LowestOrderDays","HighestOrderHours","HighestGrossingHours","VENUE_ID",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(a){var b=[],c=a.getData();for(var d in c){angular.forEach(c[d],function(a,c){"$"!=String(c[0])&&b.push(c)}),a.setTitles(b);break}}function x(){var c=moment.utc().valueOf(),d=moment.utc().subtract("month",1).valueOf(),e=moment.utc().subtract("month",2).valueOf();
return a.all([b.items({venueId:v}).$promise,b.orders({venueId:v}).$promise,b.customerOrders({venueId:v}).$promise,b.customerOrders({venueId:v,maxDate:c,minDate:d}).$promise,b.customerOrders({venueId:v,maxDate:d,minDate:e}).$promise])}function y(b){console.log("data",b),B.data={items:b[0],orders:z(b[1]),customerOrders:A(b[2],b[3],b[4])};var c=[];return angular.forEach(C,function(a){a.init&&c.push(a.init())}),a.all(c)}function z(a){return angular.forEach(a,function(a){a.day=moment.utc(a.paid).startOf("day").valueOf(),a.hour=moment.utc(a.paid).hour()}),a}function A(a,b,c){return console.log(a.length,b.length,c.length),angular.forEach(a,function(a){var d,e;for(var f in b)if(b[f].id===a.id){d=b[f];break}for(var f in c)if(c[f].id===a.id){e=c[f];break}d&&d.orders&&e&&e.orders&&(a.orderPercentage=100*d.orders/e.orders,a.orderPercentage=d.orders>e.orders?a.orderPercentage:-a.orderPercentage,a.totalPercentage=100*d.total/e.total,a.totalPercentage=d.total>e.total?a.totalPercentage:-a.totalPercentage)}),a}var B=function(){},C=[c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u],D={dateJoined:_tr("Date Joined"),name:_tr("Name"),email:_tr("Email Address"),marketing:_tr("Marketing"),dateOfOrder:_tr("Date of Order"),numberOfOrders:_tr("Number of Orders"),totalSpent:_tr("Total Spent"),percentIncrease:_tr("% Increase"),percentDecrease:_tr("% Decrease"),lastOrder:_tr("Last Order"),itemName:_tr("Item Name"),quantitySold:_tr("Quantity Sold"),day:_tr("Day"),date:_tr("Date"),loyalty:_tr("Loyalty"),other:_tr("Other"),offers:_tr("Offers"),valueSold:_tr("Value Sold")};return B.init=function(){var b=a.defer();return x().then(y).then(function(){angular.forEach(C,function(a){a.setData(B.data)}),angular.forEach(C,function(a){a.onSetDataComplete&&a.onSetDataComplete(),w(a),a.title=a.getTitle()}),b.resolve()}),b.promise},B.getTitle=function(a){return D[a]?D[a]:a},B.getReportsList=function(){return C},B}]),angular.module("kyc.reports").factory("NewCustomers",[function(){var a=_tr("New Customers"),b={},c={},d=[],e=moment.utc().subtract("week",2);return b.setData=function(a){c={},angular.forEach(a.customerOrders,function(a){var b=moment.utc(a.created);(b>e||a.firstOrder>e)&&void 0===c[a.id]&&(c[a.id]={dateJoined:a.created,name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})})},b.orderBy="dateJoined",b.direction=!1,b.description=_tr("Displays all new customers who have signed up, or had their first order, in the past two weeks."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("ZeroOrdersCustomers",["VenueCustomers","VENUE_ID",function(){var a=_tr("Customers with zero orders"),b=[],c={},d={};return d.setData=function(a){c={},angular.forEach(a.customerOrders,function(a){0===a.orders&&(c[a.id]={dateJoined:a.created,name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})})},d.orderBy="dateJoined",d.direction=!1,d.description=_tr("Displays all customers who have signed up but have not yet placed any orders."),d.onSetDataComplete=function(){},d.getData=function(){return c},d.setTitles=function(a){b=a},d.getTitles=function(){return b},d.getTitle=function(){return a},d}]),angular.module("kyc.reports").factory("OneTimeBuyers",[function(){var a=_tr("One Time Buyers"),b={},c={},d=[];return b.setData=function(a){c={},angular.forEach(a.customerOrders,function(a){void 0===c[a.id]&&1===a.orders&&(c[a.id]={dateJoined:a.created,dateOfOrder:a.firstOrder,name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})})},b.orderBy="dateOfOrder",b.direction=!1,b.description=_tr("Displays all customers who have placed only one order."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("MostFrequentBuyers",[function(){var a=_tr("Most Frequent Buyers"),b={},c={},d=[];return b.setData=function(a){c={},a.customerOrders.sort(function(a,b){return a.orders-b.orders}),angular.forEach(a.customerOrders,function(a){void 0===c[a.id]&&(c[a.id]={numberOfOrders:a.orders,name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})})},b.orderBy="numberOfOrders",b.direction=!1,b.description=_tr("Displays top 50 customers who have placed the most number of orders."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("HighestSpendingCustomers",[function(){var a=_tr("Highest Spending Customers"),b={},c={},d=[];return b.setData=function(a){c={},angular.forEach(a.customerOrders,function(a){moment.utc(a.paid);void 0===c[a.id]&&(c[a.id]={totalSpent:null===a.total?0:a.total,name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})})},b.orderBy="totalSpent",b.direction=!1,b.description=_tr("Displays top 50 customers who have the highest transactional spend."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("CustomersIncreasingOrders",[function(){var a=_tr("Customers Increasing Orders"),b={},c={},d=[];return b.setData=function(a){c={},angular.forEach(a.customerOrders,function(a){void 0===c[a.id]&&!isNaN(a.orderPercentage)&&a.orderPercentage>0&&(c[a.id]={percentIncrease:a.orderPercentage,name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})}),console.log("set data",c)},b.orderby="percentIncrease",b.direction=!1,b.description=_tr("Displays all customers who placed more orders this month than the previous month."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("CustomersDecreasingOrders",[function(){var a=_tr("Customers Decreasing Orders"),b={},c={},d=[];return b.setData=function(a){c={},angular.forEach(a.customerOrders,function(a){void 0===c[a.id]&&!isNaN(a.orderPercentage)&&a.orderPercentage<0&&(c[a.id]={percentDecrease:Math.abs(a.orderPercentage),name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})})},b.orderby="percentDecrease",b.direction=!1,b.description=_tr("Displays all customers who placed less orders this month than the previous month."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("CustomersIncreasingSpend",[function(){var a=_tr("Customers Increasing Spend"),b={},c={},d=[];return b.setData=function(a){c={},angular.forEach(a.customerOrders,function(a){void 0===c[a.id]&&!isNaN(a.totalPercentage)&&a.totalPercentage>0&&(c[a.id]={percentIncrease:a.totalPercentage,name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})}),console.log("set data",c)},b.orderby="percentIncrease",b.direction=!1,b.description=_tr("Displays all customers who spent more this month than the previous month."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("CustomersDecreasingSpend",[function(){var a=_tr("Customers Decreasing Spend"),b={},c={},d=[];return b.setData=function(a){c={},angular.forEach(a.customerOrders,function(a){void 0===c[a.id]&&!isNaN(a.totalPercentage)&&a.totalPercentage<0&&(c[a.id]={percentDecrease:Math.abs(a.totalPercentage),name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})})},b.orderby="percentDecrease",b.direction=!1,b.description=_tr("Displays all customers who spent less this month than the previous month."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("SleepingCustomers",[function(){var a=_tr("Sleeping Customers"),b={},c={},d=[],e=moment.utc().subtract("month",3);return b.setData=function(a){c={},angular.forEach(a.customerOrders,function(a){void 0===c[a.id]&&moment.utc(a.lastOrder).valueOf()<e.valueOf()&&(c[a.id]={lastOrder:a.lastOrder,name:a.firstName+" "+a.lastName,email:a.username,loyalty:a.optinLoyalty,offers:a.optinOffers,other:a.optinOther})})},b.orderby="lastOrder",b.direction=!0,b.description=_tr("Displays all customers who have previously made at least one order, but haven’t ordered for 3 months."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("MostPopularItemsReport",[function(){var a=_tr("Most Popular Items"),b={},c={},d=[];return b.setData=function(a){c={},angular.forEach(a.items,function(a){void 0===c[a.menuItemId]?c[a.menuItemId]={itemName:a.name,quantitySold:a.qty}:c[a.menuItemId].quantitySold+=a.qty})},b.orderBy="quantitySold",b.direction=!1,b.description=_tr("Displays top 10 most popular items."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("ItemPopularityIncrease",[function(){var a=_tr("Item Popularity Increase"),b={},c={},d={},e=[];return b.setData=function(a){c={},d={};var b=moment.utc().subtract("month",1).valueOf(),e=moment.utc().subtract("month",2).valueOf();angular.forEach(a.items,function(a){void 0===d[a.menuItemId]&&(d[a.menuItemId]={name:a.name,$thisMonthQuantitySold:0,$lastMonthQuantitySold:0});var c=moment.utc(a.paid).valueOf();c>=b?d[a.menuItemId].$thisMonthQuantitySold+=a.qty:c>e&&(d[a.menuItemId].$lastMonthQuantitySold+=a.qty)})},b.onSetDataComplete=function(){angular.forEach(d,function(a,b){if(a.$thisMonthQuantitySold>a.$lastMonthQuantitySold){var d=100*a.$thisMonthQuantitySold/a.$lastMonthQuantitySold;1/0===d&&(d=100),c[b]={itemName:a.name,quantitySold:a.$thisMonthQuantitySold,percentIncrease:d}}})},b.orderBy="percentIncrease",b.direction=!1,b.description=_tr("Displays all items that sold more this month than last month."),b.getData=function(){return c},b.setTitles=function(a){e=a},b.getTitles=function(){return e},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("ItemPopularityDecrease",[function(){var a=_tr("Item Popularity Decrease"),b={},c={},d={},e=[];return b.setData=function(a){c={},d={};var b=moment.utc().subtract("month",1).valueOf(),e=moment.utc().subtract("month",2).valueOf();angular.forEach(a.items,function(a){void 0===d[a.menuItemId]&&(d[a.menuItemId]={name:a.name,$thisMonthQuantitySold:0,$lastMonthQuantitySold:0});var c=moment.utc(a.paid).valueOf();c>=b?d[a.menuItemId].$thisMonthQuantitySold+=a.qty:c>e&&(d[a.menuItemId].$lastMonthQuantitySold+=a.qty)})},b.onSetDataComplete=function(){angular.forEach(d,function(a,b){if(a.$thisMonthQuantitySold<a.$lastMonthQuantitySold){var d=100*a.$thisMonthQuantitySold/a.$lastMonthQuantitySold;c[b]={itemName:a.name,quantitySold:a.$thisMonthQuantitySold,percentDecrease:100-d}}})},b.orderBy="percentDecrease",b.direction=!1,b.description=_tr("Displays all items that sold less this month than last month"),b.getData=function(){return c},b.setTitles=function(a){e=a},b.getTitles=function(){return e},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("HighestGrossingDays",[function(){var a=_tr("Highest Grossing Days"),b={},c=[],d=[],e=moment.utc().subtract("month",1),f=10;return b.setData=function(a){var b={},d=_.groupBy(a.orders,"day");angular.forEach(d,function(a,c){c>e.valueOf()&&angular.forEach(a,function(a){void 0===b[c]?b[c]={day:a.paid,date:a.paid,valueSold:a.total}:b[c].valueSold+=a.total})}),c=_.sortBy(b,function(a){return-a.valueSold}).slice(0,f)},b.orderBy="valueSold",b.direction=!1,b.description=_tr("Display top 10 highest grossing days."),b.getData=function(){return console.log("getting h data",c),c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("LowestGrossingDays",[function(){var a=_tr("Lowest Grossing Days"),b={},c=[],d=[],e=moment.utc().subtract("month",1),f=10;return b.setData=function(a){var b={};c=[];var d=_.groupBy(a.orders,"day");angular.forEach(d,function(a,c){c>e.valueOf()&&angular.forEach(a,function(a){void 0===b[c]?b[c]={day:a.paid,date:a.paid,valueSold:a.total}:b[c].valueSold+=a.total})}),c=_.sortBy(b,function(a){return a.valueSold}).slice(0,f)},b.orderBy="valueSold",b.direction=!0,b.description=_tr("Display top 10 lowest grossing days."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports"),angular.module("kyc.reports").factory("HighestOrderDays",[function(){var a=_tr("Highest Order Days"),b={},c=[],d=[],e=moment.utc().subtract("month",1),f=10;return b.setData=function(a){var b={};c=[];var d=_.groupBy(a.orders,"day");angular.forEach(d,function(a,c){c>e.valueOf()&&angular.forEach(a,function(a){void 0===b[c]?b[c]={day:a.paid,date:a.paid,numberOfOrders:1}:b[c].numberOfOrders++})}),c=_.sortBy(b,function(a){return-a.numberOfOrders}).slice(0,f)},b.orderBy="numberOfOrders",b.direction=!1,b.description=_tr("Display top 10 highest order days."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("LowestOrderDays",[function(){var a=_tr("Lowest Order Days"),b={},c=[],d=[],e=moment.utc().subtract("month",1),f=10;return b.setData=function(a){var b={};c=[];var d=_.groupBy(a.orders,"day");angular.forEach(d,function(a,c){c>e.valueOf()&&angular.forEach(a,function(a){void 0===b[c]?b[c]={day:a.paid,date:a.paid,numberOfOrders:1}:b[c].numberOfOrders++})}),c=_.sortBy(b,function(a){return a.numberOfOrders}).slice(0,f)},b.orderBy="numberOfOrders",b.direction=!0,b.description=_tr("Display top 10 lowest order days."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("HighestGrossingHours",[function(){var a=_tr("Highest Grossing Hours"),b={},c=[],d=[],e=10;return b.setData=function(a){c=[],angular.forEach(a.orders,function(a){var b=moment.utc(a.paid).hour();void 0===c[b]&&(c[b]={timeSlot:moment.utc(a.paid).format("HH:00")+" - "+moment.utc(a.paid).format("HH:59"),valueSold:0}),c[b].valueSold+=a.total}),c=_.sortBy(c,function(a){return-a.valueSold}).slice(0,e)},b.orderBy="valueSold",b.direction=!1,b.description=_tr("Displays the accumulative total spent, broken down by 24 x 1 hour time slots."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.reports").factory("HighestOrderHours",[function(){var a=_tr("Highest Order Hours"),b={},c=[],d=[],e=10;return b.setData=function(a){c=[],angular.forEach(a.orders,function(a){var b=moment.utc(a.paid).hour();void 0===c[b]&&(c[b]={timeSlot:moment.utc(a.paid).format("HH:00")+" - "+moment.utc(a.paid).format("HH:59"),numberOfOrders:0}),c[b].numberOfOrders++}),c=_.sortBy(c,function(a){return-a.numberOfOrders}).slice(0,e)},b.orderBy="numberOfOrders",b.direction=!1,b.description=_tr("Displays the accumulative number of orders, broken down by 24 x 1 hour time slots."),b.getData=function(){return c},b.setTitles=function(a){d=a},b.getTitles=function(){return d},b.getTitle=function(){return a},b}]),angular.module("kyc.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/gm,a)}}]).filter("orderObjectBy",function(){return function(a,b,c){var d=[];return angular.forEach(a,function(a){d.push(a)}),d.sort(function(a,c){return a[b]>c[b]?1:-1}),c&&d.reverse(),d}}).filter("marketing",function(){return function(a){return 1===a?"/img/marketing-in.png":"/img/marketing-out.png"}}).filter("timeAgo",function(){return function(a){"object"!=typeof a&&(a=moment.utc(a));var b,c=Math.floor((moment.utc()-a).valueOf()/1e3),d=Math.floor(c/31536e3);return d>=1?b=_tr(d>1?"years ago":"year ago"):(d=Math.floor(c/2592e3),d>=1?b=_tr(d>1?"months ago":"month ago"):(d=Math.floor(c/86400),d>=1?d>1?b=_tr("days ago"):(d="",b=_tr("yesterday")):(d=Math.floor(c/3600),d>=1?b=_tr(d>1?"hours ago":"hour ago"):(d=Math.floor(c/60),d>=1?b=_tr(d>1?"minutes ago":"minute ago"):(d=c,b=_tr(d>1?"seconds ago":"second ago")))))),d+" "+b}}).filter("characters",function(){return function(a,b,c){if(isNaN(b))return a;if(0>=b)return"";if(a&&a.length>b){if(a=a.substring(0,b),c)for(;" "===a.charAt(a.length-1);)a=a.substr(0,a.length-1);else{var d=a.lastIndexOf(" ");-1!==d&&(a=a.substr(0,d))}return a+"..."}return a}}).filter("words",function(){return function(a,b){if(isNaN(b))return a;if(0>=b)return"";if(a){var c=a.split(/\s+/);c.length>b&&(a=c.slice(0,b).join(" ")+"...")}return a}}),angular.module("kyc").constant("MarketingResources",{loyalty:{img:"/img/marketing-loyalty.png",description:_tr("Contact this customer regarding loyalty programmes")},offers:{img:"/img/marketing-discount.png",description:_tr("Contact this customer with discounts and special offers")},other:{img:"/img/marketing-newsletter.png",description:_tr("Contact this customer with newsletters, research and marketing emails")}});